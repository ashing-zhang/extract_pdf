Go driven rpc code generation tool for right now.
• 100% Go
• Describe services with Go interfaces (with structs, methods, comments, etc.)
• Generate server and client code
• Production ready templates (or copy and modify)
Who’s using Oto?
• Grafana Labs, IRM tool
• Pace.dev
• Firesearch.dev
Templates
These templates are already being used in production.
• There are some official Oto templates
• The Pace CLI tool is generated from an open‑source CLI template
1

Learn
• VIDEO: Mat Ryer gives an overview of Oto at the Belfast Gophers meetup
• BLOG: How code generation wrote our API and CLI
Tutorial
Install the project:
1 go install github.com/pacedotdev/oto@latest
Create a project folder, and write your service definition as a Go interface:
1 // definitions/definitons.go
2 package definitions
3
4 // GreeterService makes nice greetings.
5 type GreeterService interface {
6 // Greet makes a greeting.
7 Greet(GreetRequest) GreetResponse
8 }
9
10 // GreetRequest is the request object for GreeterService.Greet.
11 type GreetRequest struct {
12 // Name is the person to greet.
13 // example: "Mat Ryer"
14 Name string
2

| 1 // definitions/definitons.go                                     |
|:-------------------------------------------------------------------|
| 2 package definitions                                              |
| 3                                                                  |
| 4 // GreeterService makes nice greetings.                          |
| 5 type GreeterService interface {                                  |
| 6 // Greet makes a greeting.                                       |
| 7 Greet(GreetRequest) GreetResponse                                |
| 8 }                                                                |
| 9                                                                  |
| 10 // GreetRequest is the request object for GreeterService.Greet. |
| 11 type GreetRequest struct {                                      |
| 12 // Name is the person to greet.                                 |
| 13 // example: "Mat Ryer"                                          |
| 14 Name string                                                     |

15 }
16
17 // GreetResponse is the response object containing a
18 // person's greeting.
19 type GreetResponse struct {
20 // Greeting is the greeting that was generated.
21 // example: "Hello Mat Ryer"
22 Greeting string
23 }
Download templates from otohttp
1 mkdir templates \
2 && wget https://raw.githubusercontent.com/pacedotdev/oto/master/
otohttp/templates/server.go.plush -q -O ./templates/server.go.
plush \
3 && wget https://raw.githubusercontent.com/pacedotdev/oto/master/
otohttp/templates/client.js.plush -q -O ./templates/client.js.
plush
Use the oto tool to generate a client and server:
1 mkdir generated
2 oto -template ./templates/server.go.plush \
3 -out ./generated/oto.gen.go \
4 -ignore Ignorer \
5 -pkg generated \
6 ./definitions
7 gofmt -w ./generated/oto.gen.go ./generated/oto.gen.go
8 oto -template ./templates/client.js.plush \
9 -out ./generated/oto.gen.js \
10 -ignore Ignorer \
11 ./definitions
• Run oto -help for more information about these flags
Implement the service in Go:
1 // greeter_service.go
2 package main
3
4 // GreeterService makes nice greetings.
5 type GreeterService struct{}
6
7 // Greet makes a greeting.
8 func (GreeterService) Greet(ctx context.Context, r GreetRequest) (*
GreetResponse, error) {
9 resp := &GreetResponse{
10 Greeting: "Hello " + r.Name,
11 }
12 return resp, nil
3

| 15 }                                                    |
|:--------------------------------------------------------|
| 16                                                      |
| 17 // GreetResponse is the response object containing a |
| 18 // person's greeting.                                |
| 19 type GreetResponse struct {                          |
| 20 // Greeting is the greeting that was generated.      |
| 21 // example: "Hello Mat Ryer"                         |
| 22 Greeting string                                      |
| 23 }                                                    |

| 1 mkdir templates \                                                |
|:-------------------------------------------------------------------|
| 2 && wget https://raw.githubusercontent.com/pacedotdev/oto/master/ |
| otohttp/templates/server.go.plush -q -O ./templates/server.go.     |
| plush \                                                            |
| 3 && wget https://raw.githubusercontent.com/pacedotdev/oto/master/ |
| otohttp/templates/client.js.plush -q -O ./templates/client.js.     |
| plush                                                              |

| 1 mkdir generated                                        |
|:---------------------------------------------------------|
| 2 oto -template ./templates/server.go.plush \            |
| 3 -out ./generated/oto.gen.go \                          |
| 4 -ignore Ignorer \                                      |
| 5 -pkg generated \                                       |
| 6 ./definitions                                          |
| 7 gofmt -w ./generated/oto.gen.go ./generated/oto.gen.go |
| 8 oto -template ./templates/client.js.plush \            |
| 9 -out ./generated/oto.gen.js \                          |
| 10 -ignore Ignorer \                                     |
| 11 ./definitions                                         |

| 1 // greeter_service.go                                               |
|:----------------------------------------------------------------------|
| 2 package main                                                        |
| 3                                                                     |
| 4 // GreeterService makes nice greetings.                             |
| 5 type GreeterService struct{}                                        |
| 6                                                                     |
| 7 // Greet makes a greeting.                                          |
| 8 func (GreeterService) Greet(ctx context.Context, r GreetRequest) (* |
| GreetResponse, error) {                                               |
| 9 resp := &GreetResponse{                                             |
| 10 Greeting: "Hello " + r.Name,                                       |
| 11 }                                                                  |
| 12 return resp, nil                                                   |

13 }
Use the generated Go code to write a main.go that exposes the server:
1 // main.go
2 package main
3
4 func main() {
5 g := GreeterService{}
6 server := otohttp.NewServer()
7 server.Basepath = "/oto/"
8 generated.RegisterGreeterService(server, g)
9 http.Handle(server.Basepath, server)
10 log.Fatal(http.ListenAndServe(":8080", nil))
11 }
• The otohttp.Server performs its own routing and so has a Basepath field which you
should use when you route the handler.
Use the generated client to access the service in JavaScript:
1 import { GreeterService } from "oto.gen.js";
2
3 const greeterService = new GreeterService();
4
5 greeterService
6 .greet({
7 name: "Mat",
8 })
9 .then((response) => alert(response.greeting))
10 .catch((e) => alert(e));
Use json tags to control the front‑end facing name
You can control the name of the field in JSON and in front‑end code using json tags:
1 // Thing does something.
2 type Thing struct {
3 SomeField string `json:"some_field"
4 }
• The SomeField field will appear as some_field in json and front‑end code
• The name must be a valid JavaScript field name
4

| 1 // main.go                                    |
|:------------------------------------------------|
| 2 package main                                  |
| 3                                               |
| 4 func main() {                                 |
| 5 g := GreeterService{}                         |
| 6 server := otohttp.NewServer()                 |
| 7 server.Basepath = "/oto/"                     |
| 8 generated.RegisterGreeterService(server, g)   |
| 9 http.Handle(server.Basepath, server)          |
| 10 log.Fatal(http.ListenAndServe(":8080", nil)) |
| 11 }                                            |

| 1 import { GreeterService } from "oto.gen.js";   |
|:-------------------------------------------------|
| 2                                                |
| 3 const greeterService = new GreeterService();   |
| 4                                                |
| 5 greeterService                                 |
| 6 .greet({                                       |
| 7 name: "Mat",                                   |
| 8 })                                             |
| 9 .then((response) => alert(response.greeting))  |
| 10 .catch((e) => alert(e));                      |

| 1 // Thing does something.            |
|:--------------------------------------|
| 2 type Thing struct {                 |
| 3 SomeField string `json:"some_field" |
| 4 }                                   |

Specifying additional template data
You can provide strings to your templates via the -params flag:
1 oto \
2 -template ./templates/server.go.plush \
3 -out ./oto.gen.go \
4 -params "key1:value1,key2:value2" \
5 ./path/to/definition
Within your templates, you may access these strings with <%= params["key1"] %>.
Comment metadata
It’s possible to include additional metadata for services, methods, objects, and fields in the com‑
ments.
1 // Thing does something.
2 // field: "value"
3 type Thing struct {
4 //...
5 }
The Metadata["field"] value will be the string value.
• The value must be valid JSON (for strings, use quotes)
Examples are officially supported, but all data is available via the Metadata map fields.
Examples
To provide an example value for a field, you may use the example: prefix line in a comment.
1 // GreetRequest is the request object for GreeterService.Greet.
2 type GreetRequest struct {
3 // Name is the person to greet.
4 // example: "Mat Ryer"
5 Name string
6 }
• The example must be valid JSON
The example is extracted and made available via the Field.Example field.
5

| 1 oto \                                   |
|:------------------------------------------|
| 2 -template ./templates/server.go.plush \ |
| 3 -out ./oto.gen.go \                     |
| 4 -params "key1:value1,key2:value2" \     |
| 5 ./path/to/definition                    |

| 1 // Thing does something.   |
|:-----------------------------|
| 2 // field: "value"          |
| 3 type Thing struct {        |
| 4 //...                      |
| 5 }                          |

| 1 // GreetRequest is the request object for GreeterService.Greet.   |
|:--------------------------------------------------------------------|
| 2 type GreetRequest struct {                                        |
| 3 // Name is the person to greet.                                   |
| 4 // example: "Mat Ryer"                                            |
| 5 Name string                                                       |
| 6 }                                                                 |

Open API
To work on the Open API spec, you might find this command helpful:
1 oto -template ./otohttp/templates/openapi.yaml.plush -out openapi.yaml
-v -ignore Ignorer ./parser/testdata/services/pleasantries
Contributions
Special thank you to:
• @mgutz ‑ for struct tag support
• @sethcenterbar ‑ for comment metadata support
6

| 1 oto -template ./otohttp/templates/openapi.yaml.plush -out openapi.yaml   |
|:---------------------------------------------------------------------------|
| -v -ignore Ignorer ./parser/testdata/services/pleasantries                 |