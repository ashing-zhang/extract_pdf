1
Online Optimization of Wireless Powered
Mobile-Edge Computing for Heterogeneous
Industrial Internet of Things
Hao Wu1, Xinchen Lyu2, and Hui Tian1
1State Key Laboratory of Networking and Switching Technology, Beijing University of Posts and
Telecommunications, Beijing, China, Email: wh9405@bupt.edu.cn and tianhui@bupt.edu.cn.
9102 peS 4  ]PS.ssee[  1v54420.9091:viXra 2National Engineering Laboratory for Mobile Network Technologies, Beijing University of Posts and
Telecommunications, Beijing, China, Email: lvxinchen@bupt.edu.cn.
Abstract—A spurt of progress in wireless power trans- practicality but pays less attention to latency. Different from
fer (WPT) and mobile edge computing (MEC) provides a promis- conventional MEC networks which focus on radio/computing
ing approach for Industrial Internet of Things (IIoT) to enhance
resources optimization of homogeneous devices with real-time
the quality and productivity of manufacturing. Scheduling in
network state information (NSI), scheduling in the considered
such a scenario is challenging due to congested wireless channels,
IIoT scenario faces several technical challenges:
time-dependent energy constraints, complicated device hetero-
geneity, and prohibitive signaling overheads. In this paper, we 1) Sustainability: The IIoT devices are increasingly empow-
first propose an online algorithm, called energy-aware resource ered with wireless power transfer (WPT) capability, so as to
scheduling (ERS), to maximize the system utility comprising
harvest energy from wireless signals, recharge their limited
throughput and fairness, with consideration on both system
battery, and prolong the lifetimes of the devices. This is critical
sustainability and stability. Based on Lyapunov optimization
to guarantee the sustainability with WPT capability since
and convex optimization techniques, the proposed algorithm
achieves asymptotic optimality for heterogeneous IIoT systems frequent replacement of batteries for a massive number of
without prior knowledge of network state information (NSI). devices would incur prohibitive operational/maintenance cost
Subsequently, we extend the ERS algorithm to a more realistic
in IIoT. However, the transmission of wireless power consumes
scenario where the overhead and delay of NSI feedbacks are non-
spectrum resources and needs to be jointly optimized with the
negligible. The optimal scheduling decisions of the scenario are
decisions of data offloading and processing in the AP.
provided, and the optimality loss on system utilityunder outdated
NSI is analyzed. Simulations verify our theoretical claims and 2) Heterogeneity: The IIoT devices (such as industrial
demonstrate the gains of our proposed ERS algorithm over sensors, actuators, and controllers) have heterogeneous com-
alternative benchmark schemes.
puting/storage/battery capabilities. Such inhomogeneity would
Index Terms—Wireless power transfer, mobile edge computing, necessitate specific and meticulous algorithms for different
heterogeneous Industrial Internet of Things, outdated informa-
types of devices.
tion, Lyapunov optimization.
3) Scalability: Given the stochastic and time-varying fea-
tures of the IIoT environment, real-time NSI is vital for the
I. INTRODUCTION
effectiveness of resource allocation. However, due to limited
I
NDUSTRIAL Internet of Things (IIoT) is regarded as a signaling resources, it may not be practical for the AP to
revolutionary approach to optimize industrial production acquire real-time NSI from a wide range of IIoT devices.
processes and improve economic benefits [1]–[3]. Ubiquitous The aforementioned joint design under heterogeneous IIoT
wireless devices (WDs) in IIoT work as the sources to collect environment is required to be scaled to operate in the presence
an enormous amount of data from the ambient environment. of outdated NSI.
Analysis and extraction of those data can add value to the
production cycle, thus improving the efficiency and accuracy
A. Related Work
of manufacturing [4]. Generally, the data will be transmitted to
and processed at a nearby radio access point (AP) to facilitate These challenges have yet to be addressed in the liter-
network model training and intelligent decisions, e.g., machine ature, especially in heterogeneous IIoT. Although there are
learning for feature extraction [5] and fuzzy Q-learning for extensive works about resource scheduling in MEC [10]–
load balancing [6]. To this end, endowing APs with powerful [12], the joint optimization for bandwidth, computing, and
mobile edge computing (MEC) functionalities will be a major energy intake/output is of insufficient study. Offline algorithm
form of IIoT scenarios [7]–[9]. for the joint optimization would require complete non-causal
A typical use case enabled by MEC in IIoT is warehouse en- information of networks and may suffer from the curse of
vironmental monitoring. In such an application, different types dimensionality when the system is in large scale. To address
of WDs are deployed around the storehouse, responsible for these issues, a perturbed Lyapunov technique was employed
collecting and transmitting data from surroundings to APs in to decouple the spatial- and time-dependency of multiple
order to maintain a favorable storage environment. Therefore, resources in [13] and [14]. However, these analyses may not
the system would prefer high throughput with reliability and be suitable for IIoT, since their energy harvesting processes

2
were modeled as stochastic energy packet arrivals. The highly fairness, and enable the optimization to be tolerant to partial
variable of energy supplies was unfavorable for system control outdated NSI. The key contributions of this paper are as
and manual management. follows:
Recent years have witnessed the possibility of integrating
WPT with MEC. WPT, especially in the form of wireless We develop an energy-aware resource scheduling (ERS)
•
powered communicationnetwork (WPCN) [15]–[20], has been algorithm to tackle time coupling among data collection,
envisioned as an promising paradigm to provide adaptive and energy transmission, and data offloading in IIoT by
sustainable energy supply for battery-powered devices. In [21], leveragingLyapunovtechnique. A stochastic optimization
a computation rate maximization problem was formulated in problem is formulated and then transformed into a series
wireless powered MEC with binary offloading, and solved by of convex issues with the aid of the data backlog analysis
developing two algorithms based on coordinate descent and from both the AP and WDs. Moreover, we theoretically
alternating direction method of multipliers. Reference [22] prove that the proposed algorithm achieves close-to-
explored the benefits of user cooperation in minimizing WPT- optimal performance with a known deviation, presenting
MEC system energy by solving a min-max problem through a an [O(V ),O(1/V )]-tradeoff between utility and stability.
two-phase method. For the scenario with multi-antenna AP, a The proposed ERS algorithm is favorable for multiple
•
semiclosed solution for AP’s energy consumption minimiza- resource scheduling in IIoT by exploiting the diversity
tion was derived under a computation latency constraint [23]. of heterogeneous devices. The objective functions of
However, these algorithms implicitly assumed that the AP has scheduling Type-I and Type-II devices are meticulously
sufficient computing capability. In contrast, the optimal design formulated into a similar form and are jointly optimized
for resource-limited AP, which is widespread in IIoT due to subject to data stability and energy sustainability.
stringent production cost consideration, and its sustainability We extend the proposed algorithm to a more practical sce-
•
analysis are lack of study. nario where only outdated NSI is available for scheduling
There have been separate studies over the optimization optimization due to partial feedback and transmission
of WPT/MEC for the devices with limited [15], [23], [24] delay. Besides, we derive the optimal decisions for the
(referred to as Type-I hereafter) or sufficient [16]–[18], [22] scheduling process and analyze its optimality loss in the
(referred to as Type-II in the sequel) battery sizes. Type-I de- presence of stale NSI.
vices, with high self-discharge rate, consume all the harvested
energy for data offloading in each time slot. Therefore, its Extensive simulations verify the theoretical analyses of the
resource scheduling usually works in a myopic manner. On proposed online algorithm for heterogeneous IIoT. It is shown
the contrary, so long as the battery capacity allows, Type-II that the proposed approach, with only partial outdated NSI,
devices can store the unused energy harvested in the current can increase the system throughput while maintaining fairness
slot for future use. Some papers noticed the heterogeneity and among Type-I/II devices. Simulations also reveal the impact
proposed separate scheduling approaches for the two types of of feedback overhead and interval on throughput, thereby
WDs [19], [20]. However, none of the existing works can be providing guidelines for the design of compulsory feedback
extended to the considered heterogeneous IIoT system, since interval in practical implementation.
the joint optimization for Type-I/II devices is highly coupled
Note that the selection of Lyapunov optimization techniques
and dependent on each other.
in this paper is to design asymptotically optimal and low-
The aforementioned works all optimize their objectives
complexity resource scheduling approach, which is of practical
under the assumption of real-time NSI. It is generally im-
importance since IIoT requires efficient resource utilization
practical due to systems’ stochasticity and unpredictability,
and quick response. Apart from Lyapunov optimization, the
partial feedback, and non-negligible transmission delay. In
heuristic, game-theoretic, submodular as well as reinforce-
[13] and [25], new analytic frameworks were proposed and
ment learning-based approaches can also be applied to solve
applied to accommodate outdated NSI, which were able to
the stochastic optimization problem. However, all these ap-
diminish the optimality loss asymptotically. Chenshan et al
proaches can result in optimality loss due to myopic schedule
in [26] later extended those frameworks to the scenario of
(e.g., heuristic method) or high complexity and learning time
Internet of Things with finite device buffers. Furthermore,
(e.g., Q-learning). As a result, in the proposed algorithm, we
a multi-timescale online algorithm was developed in [27],
first leverage Lyapunov optimization to decouple the time- and
where the future queue backlogs were approximated by the
space- couplings in scheduling decisions, and then efficiently
current backlogs. However, all these works did not quantize
solve the decoupled sub-problems by applying convex opti-
the tradeoff between feedback signaling and performance loss.
mization techniques.
The rest of this paper is organized as follows. The next
B. Contributions
section introduces the system model of the considered IIoT
Distinctively different from the existing approaches, this and the problem formulation. Section III proposes the online
paper designs an asymptotically optimal scheduling method scheduling algorithm and analyzes its performance theoreti-
for heterogeneous IIoT, where WDs with different battery cally. Section IV provides the extension of the online algorithm
capabilities are powered by WPT. Our objective is to maximize for a more practical scenario. Simulation results are presented
a time-average system utility considering both throughput and in Section V, followed by the conclusion in Section VI.

3
TABLE I
WD 1 SUMMARYOF NOTATIONS
h (t) Q (t) Type-I
1 . . 1
. Notation Description
AP
h (t) 11
n WD n N(N1,N2) Set of all (Type-I, Type-II) wireless devices
Energy  ξi Energy harvesting efficiency of device i
transfer  Q (t)
h n+1(t) n P0 Transmit power of AP
circuit
Pi(t) Offloading transmit power of device i at slot t
Edge  WD n+1
hi(t) Channel power gain between AP and device i at slot t
computing  h (t)
circuit N . . Q n+1(t) Type-II T Interval of a time block
.
W System bandwidth
22
WD N
WPT flow µ0(t) Time portion for wireless power transfer at slot t
Q (t)
Offloading data flow N µi(t) Time portion for device i to offload at slot t
ci(t) Achievable offloading data size of device i at slot t
(a) System scenario
Ei(t) Available energy of device i at slot t
m 0(t)T1(t)TT m m 2(t)T m N(t)T ei(t) Offloading transmit energy of device i at slot t
...
H
e (t) Energy harvested by device i at slot t
AP(cid:279)WDs WD 1(cid:279)AP WD 2(cid:279)AP WD N(cid:279)AP i
WPT Offload Offload ... Offload Ai(t) Data that can be collected by device i within slot t
ai(t) Data collected at device i within slot t
Qi(t) Data queue backlog of device i at slot t
(b) Time frame structure Si(t) Data queue backlog of AP at slot t
ri(t) Available data processing speed of AP at slot t
Fig. 1. Considered system model of wireless powered MEC for warehouse
X Time-average of any stochastic process X
environmental monitoring in IIoT
Ui(·) Utility of device i
II. SYSTEM MODEL AND PROBLEM FORMULATION
A. System Overview Without loss of generality, we assume eH(t) ≤eH , where
i i,max
eH is the maximum harvested energy in one slot recorded
We consider an IIoT system consisting of an AP endowed i,max
from a long time. It is further assumed that all channels are
with MEC and WPT functionalities, and N heterogeneous
independentand identically distributed (i.i.d.) flat block fading,
WDs indexed by N ={1,2,··· ,N}. As shown in Fig. 1(a),
i.e., channels remain static within each time slot but may vary
WDs in the system are divided into sets of Type-I and Type-
across different slots [13], [14], [28].
II devices, denoted by N and N , respectively. Similar to
1 2
By exploiting the channel reciprocity in time-division mode
WPCN, we assume the system operates in a frame-based
system [15] [21], the AP can acquire both the uplink and
time-division-multiplexing manner [15]–[17], [19]. Fig. 1(b)
downlink channel states at the beginning of each time slot
illustrates the system’ time frame structure with duration T,
with little signaling cost. This can be achieved by each WD
which consists of two phases. In the first phase, the first
sending its pilot for channel measurement at the AP [19], [28].
µ (t)T amount of time is assigned for downlink WPT, where
0
Hence, the achievable offloading data size of WD i (in bits)
µ (t) ∈ [0,1) denotes its allocated time portion at slot t. In
0
within time slot t can be given by [21], [22]
the second phase, the rest (1 − µ (t))T amount of time is
0
used for the computation offloading in the uplink. The time
P (t)h (t)
i i
c (t) = µ (t)TW log (1 + ), i ∈ N, (3)
allocated for WD i to offload is denoted by µ i(t)T, where i i 2
N
0
µ (t) ∈ [0,1). Consider ambient data analysis for IIoT, the
i
where W denotes the communication bandwidth, P (t) repre-
computation results at the AP is not required to be returned to i
sents the transmit power of WD i, and N denotes the noise
WDs. Hence, the time portions µ˜(t)=(µ (t),i ∈ N˜ ) satisfies 0
i
power at the receiver of the AP. Given the limited uplink
µ (t) ≤ 1, µ (t) ≥ 0, ∀i ∈ N˜ , (1) transmission power, c (t) in (3) is upper bounded by cmax.
i i i i
The notations used in this paper are summarized in Table I.
iX∈N˜
˜ ,
where N {0}∪N represents the set of the AP and all WDs.
We consider that the AP has a reliable power supply and a
B. Energy Models for Heterogeneous Devices
constant transmit power P by connecting with the power grid.
0
Energy models for Type-I and Type-II devices are entirely
It is assumed that the AP and all WDs have one single antenna
different due to their battery management capabilities, which
each. Compared to P , the energy harvested from noises and
0
are further discussed in the following.
received uplink signals from other WDs is much smaller, thus
1) Type-I devices: This type of WDs is equipped with
is assumed to be negligible [15]–[17], [19]. Within time slot
batteries that have low energy storage capacity and high self-
t, the amount of energy harvested by the i-th WD can be
discharge rate. In this case, the harvested but unused energy
expressed as [15], [21]
within the current slot will be depleted and cannot be kept for
eH (t) = ξ P h (t)µ (t)T, i ∈ N, (2)
i i 0 i 0 future use. As a result, if µ i(t)6=0, i-th WD will manage its
where ξ ∈ (0,1) is the energy harvesting efficiency, and h (t) energy in a myopic manner, i.e., exhausting all the harvested
i i
is the channel power gain between the AP and the i-th WD. energy for offloading. Thus, we have P (t)=0 if WD i stay
i

| Energy     |
| transfer   |
| circuit    |
|:-----------|
| Edge       |
| computing  |
| circuit    |

| 0              | 1               | 2               |
|:---------------|:----------------|:----------------|
| AP(cid:279)WDs | WD 1(cid:279)AP | WD 2(cid:279)AP |
| WPT            | Offload         | Offload         |

4
silent in the offloading phase, otherwise, WD i will offload the data buffer at the beginning of slot t+1. Therefore, the
with transmit power data backlog Q (t) evolves as follows:
i
η eH(t)
P (t) = i i , i ∈ N , (4) Q (t + 1)=[Q (t) − c (t)]+ + a (t), i ∈ N, (9)
i 1 i i i i
µ (t)T
i
where [x]+=max{x,0}. In some special cases, for example,
where η represents the fixed portion of the harvested energy
i
at the early stage of the network, Q (t) may be smaller than
that is used for data offloading. As the device exhausts all the i
c (t) as the collection of data takes time. Here, the first term in
harvested energy for uplink transmission, η =1 in the sequel. i
i
the right-hand-side (RHS) of equation (9) is used to guarantee
The maximum transmit power constraint for Type-I devices is
that the device cannot offload more than what remains in its
neglected here since the harvested energy from WPT at each
data buffer when Q (t)<c (t) happens [10], [29].
slot is small in practice [21]. i i
The AP maintains N data buffers S(t) = (S (t),i ∈ N)
2) Type-II devices: Different from Type-I devices, each i
to store the data that offloaded from WDs but have not been
device i ∈ N is equipped with a rechargeable battery that
2
processed. Constrained by the limited computing capability of
has a high energy storage capacity and low discharge rate.
the AP, at most r (t) amount of data from i-th WD can be
As long as the maximum battery capacity θ is not exceeded, i
i
processed at slot t, where r (t) is a stochastic number with
a Type-II device can save the harvested energy in its battery i
the maximum rmax [13]. Naturally, the data queue dynamics
for offloading in the following slots when the channel fading i
at the AP are given by
condition is unfavorable. Denote E(t) = (E (t),i ∈ N ) as
i 2
the vector of Type-II devices’ energy queue sizes at slot t, S (t + 1) = [S (t) − r (t)]+ + min{c (t),Q (t)}, (10)
i i i i i
and e(t)=(e (t),i ∈ N ) as the vector of their corresponding
i 2
where the second term in the RHS of (10) represents the data-
uplink transmit energy. The available energy in WD i evolves
available constraint of WD i, which means the WD cannot
according to the dynamic equation
offload more data than what it has stored. In the case when
E i(t + 1) = min{E i(t) + eH (t),θ i} − e i(t), i ∈ N 2. (5) c i(t) > Q i(t), the excessive offloading rate will be used for
i
transmitting dummy data [10], [29]. We will later show that
At any time slot t, the transmit energy e (t) must follow the
i
the optimization is still asymptotically optimal by doing this.
energy-available condition
e i(t) ≤ E i(t) + eH (t), i ∈ N 2, (6) D. Problem Formulation
i
Consider warehouse environmental monitoring services in
such that the energy used would not exceed what has been
an IIoT system, unfair data collection and offloading would
cumulatively harvested so far. Meanwhile, since a Type-II
reduce the overall system performance. This is because we
device can accumulate much energy before its transmission,
may waste too many resources for offloading redundant data
when offloading, it should also satisfy the maximum transmit
from one place while lacking enough data from other areas for
power constraint
analysis. Therefore, in this paper, we aim at maximizing the
e i(t) ≤ P imax µ i(t)T, i ∈ N 2, (7) system throughput while guaranteeing fairness among WDs.
However, fairness in the considered scenario is not easy
where Pmax is i-th WD’s maximum transmit power.
i to achieve due to the doubly near-far phenomenon [15] and
heterogeneity of the WDs, which is further discussed in
C. Data Collection and Queueing Models section V. To address this issue, instead of directly maximizing
the throughput, we formulate the problem as a sum-utility
At any slot t, the volume of data that can be collected by
maximization problem as follows
WD i is denoted by A (t). Due to the dynamic changes of
i
environment in IIoT, we assume A (t) to be i.i.d. over slots
i P: max U (a (t))
i i
with a maximum Amax [10], [13]. Given the data freshness and
µ˜(t),e(t),a(t)
i
i∈N
the limited data buffer of WD, only part of the data, denoted X
s.t. (1),(6),(7),(8),
by a (t), would be collected into the data buffer. Hence, we
i
C1: Q < ∞, ∀i ∈ N,
have i
0 ≤ a (t) ≤ A (t) ≤ Amax , ∀i ∈ N. (8) C2: S < ∞, ∀i ∈ N,
i i i i
Let Q(t)=(Q (t),i ∈ N) denote the backlog of data queue of where a(t)=(a (t),i ∈ N), X =lim 1 t−1 E {X(τ)}
i i t→∞ t τ=0
WDs at slot t, i.e., any collected but have not been offloaded defines the time average expectation of any stochastic process
P
data that are queued in the data buffer. At every slot, the X(t), constraints C1 and C2 ensure the stability of all the
network decides how much data should be collected (i.e., data queues, and the utility function based on proportional
a (t)) and how much existing data in the buffer to offload fairness [13], [30] is defined as U (x) = log(1+x). Here,
i i
(i.e., c (t)) according to the network state. Follow the basic log(·) denotes the natural logarithm.
i
operations of cascaded queueing systems [10], [13] (e.g., the As can be seen from the utility function, the marginal utility
edge computing network where the data arrival and offloading decreases as the amount of data collected by a WD increase.
operate on a first-in-first-out basis), the amount of data to be As a result, the system would be inclined to collect equal
collected (i.e., a (t)) is determined at slot t and queued into amounts of data from different WDs rather than show an
i

5
apparent preference for some devices. This thereby ensures sion for all slot t satisfies
system fairness.
The problem P is a typical stochastic optimization problem. ∆ Θ (t) ≤B − V E U a (t) | Θ (t)
V 1 i i
An offline optimization of P would require complete non- ( )
i∈N
(cid:0) (cid:1) X (cid:0) (cid:1)
causal NSI, which is impossible in practice due to the highly
E Θ
+ Q (t) {a (t) − c (t) | (t)}
i i i
stochastic and unpredictable characteristics of IIoT systems.
i∈N
Even if such NSI is available, the problem is still challenging X
E Θ
+ S (t) {c (t) − r (t) | (t)}
due to its high computational complexity. Therefore, we are i i i
i∈N
motivated to propose online algorithm to jointly schedule µ˜(t), X
E H Θ
e(t) and a(t) without future NSI. + [E i(t)−θ i] {e (t)−e i(t) | (t)},
i
i∈N2
X
(14)
where V > 0 is a control parameter that affects an explicit
III. ONLINE SCHEDULE OF HETEROGENEOUS DEVICES tradeoff between system utility and data backlogs, B denotes
1
a finite constant that satisfies
In this section, we develop an online decision-making
1
algorithm by employing Lyapunov optimization. The original B = (Amax )2 + (rmax )2 +2 (cmax )2
1 i i i
2
problem P is decoupled into a series of deterministic per-time ( )
i∈N i∈N
X (cid:2) (cid:3) X (15)
slot problems at independent time slots, which are then solved
1
by convex optimization technique. We later prove that the + [(eH )2 + (Pmax T)2]
i,max i
2
( )
proposed algorithm preserves asymptotic optimality compared i∈N2
X
with the optimum of the original problem.
Proof: Please refer to Appendix A
Θ
Minimizing ∆ (t) is still difficult due to its dynamics.
V
Instead, we are motivated to minimize the RHS of (14)
(cid:0) (cid:1)
according to the principle of opportunistically minimizing an
A. Problem Transformation
expectation [31] in a per-slot manner, subject to the constraints
Define Θ (t)=[Q(t),E(t),S(t)] as the concatenated vector (1), (7), and (8).
of the queues at WDs and the AP. To handle the time-
coupling in problem P, we first define a non-negativeperturbed
B. Optimal Scheduling Decisions
Lyapunov function as
In this subsection, we present an Energy-aware Resource
Scheduling algorithm with Real-time NSI (ERS-RN al-
1
L Θ (t) = S (t)2+ Q (t)2+ (E (t) − θ )2 ,
i i i i gorithm) to address the above problem. Since a(t) and
2
( )
i∈N i∈N i∈NB (e(t),µ˜(t)) can be decoupled with each other and are in-
(cid:0) (cid:1) X X X (11)
Θ
dependent of the current backlog (t), the minimization
where θ is a weight perturbation, also the battery capacity of
i
problem can be separated into two optimization sub-problems
Type-II devices mentioned in Section II. We will later show
as follows.
that (6) can be satisfied with a proper choice of θ . Meanwhile,
i
1) Distributed Data Collection: For each time slot t, the
Θ
when minimizing L (t) , we push the data backlogs at
data collection sub-problem can be decomposed for individual
both the AP and WDs towards zero, which is equivalent to
(cid:0) (cid:1) WD. The optimal data collection strategy can be obtained by
satisfying stability constraints C1 and C2 in P. Then the one-
solving
slot conditional Lyapunov drift can be expressed as
P1: min Q (t)a (t) − V U a (t)
i i i i
∆(Θ (t))=E Θ Θ Θ ai(t)
L (t + 1) − L (t) | (t) . (12)
s.t. (8). (cid:0) (cid:1)
(cid:2) (cid:0) (cid:1) (cid:0) (cid:1) (cid:3)
where the expectation is taken with respect to the random The problem P1 is a convex optimization problem since the
NSI and the control actions. Based on Lyapunov optimiza-
objective function is convex and its constraint is linear. Hence,
tion technique, we consider minimizing the drift-plus-penalty
the optimum is either at the stationary point of a (t) =
i
expression
V/Q (t)−1 or on one of the boundaries. For any WD i ∈ N,
i
the optimal data collection strategy is thus chosen by
Θ Θ E Θ
∆ (t) =∆ (t) −V U a (t) | (t) , (13) A (t), V ≥ (A (t) + 1)Q (t)
V i i i i i
( ) a i(t) = (16)
i∈N [ V − 1]+, otherwise
(cid:0) (cid:1) (cid:0) (cid:1) X (cid:0) (cid:1) ( Qi(t)
instead of directly leveraging the objection in P. The given policy indicates that the amount of data collected
Lemma 1: For any optimization decisions made on slot t, by each WD depends on the length of its backlog. A device
Θ
and all possible values of (t), the drift-plus-penalty expres- is inclined to collect more data when its backlog is small.

6
2) Joint Energy and Time Allocation: According to (14), Algorithm 1: ERS-RN Algorithm
the optimal transmit powers e(t) and the optimal time portions
At the AP:
µ˜(t) can be derived by solving
1: Observe Q(t), S(t), E(t), r(t) and channel gains;
2: Choose v(t) by solving P3;
P2: min [S (t) − Q (t)]c (t)
i i i
3: Inform v(t) to WDs and execute WPT;
e(t),µ˜(t)
i∈N
X 4: Update E (t) at each Type-II device i by v(t) and (5).
i
H
+ [E (t)−θ ][e (t)−e (t)]
i i i i At any WD i:
i∈N2 5: Observe Q (t), A (t) and c (t);
X i i i
s.t. (1),(7). 6: Decide a (t) based on (16);
i
7: Offload data and give feedback Q (t) to the AP in the
Due to the constraint (1), e(t) and µ˜(t) in problem P2 i
arranged sequence;
cannot be completely decoupled. Generally, P2 is a non-
8: Update Q (t) according to (9).
convex optimization problem. To solve this problem, we first i
At the AP:
,
define a set N {i | i ∈ N,S (t) ≥ Q (t)}, and then find
t i i
9: Update S(t) according to (10).
an interesting property of its optimization as shown in the
following theorem.
Theorem 1: For any device i ∈ N ∩ N , the term [S (t) −
t 2 i
Q (t)]c (t)+[E (t)−θ ][eH(t)−e (t)] in the objective function linear functions, the objective function of P3 is convex in v(t).
i i i i i i
of P2 gets its minimum when µ (t) = 0, e (t) = 0. Besides, Meanwhile, the constraints C3 and C4 are linear, and thus
i i
for arbitrary WD i ∈ N ∩ N , its optimal time portion is convex. Therefore, the problem P3 is a convex optimization
t 1
given by µ (t) = 0. problem, which can be effectively solved by off-the-shelf tool-
i
Proof: Please refer to Appendix B box CVX [33] at a maximal computational complexity order
Remark 1: Theorem 1 suggests that the AP prefers to serve of O(max{(2|Nt|+|Nt|+1)3,C}) [31]. Here, (2|Nt|+|Nt|+1)
2 1 2 1
WDs who have a larger data backlog than that queueing at the represents the number of variables to be optimized, C is the
AP. This result is in accordance with our intuition that when cost to evaluate the objective function together with its first
the waiting queue at the AP is large, offloading data from and second derivatives.
a WD whose queue length is small only brings transmission Based on the above analysis, the whole process of the ERS-
energy loss and more execution delay. RN algorithm is summarized in Algorithm 1. We call the
By excluding the devices in N , we denote the remaining algorithm energy-aware because the AP conducts the energy
t
Type-I WDs to be scheduled as Nt. Similarly, let Nt collect allocation by itself and obtains the real-time knowledge of
1 2
the Type-II devices that are not in N . For the sake of brevity, all devices’ energy storages without any feedback from WDs.
t
we define D (t) = [S (t)−Q (t)]TW, β (t) = h (t)/(N T), Note that the joint energy and time allocation depends on real-
i i i i i 0
δ (t)=ξ P h2(t)/N in the sequel. Then the problem P2 can time data queue lengths fed back by all WDs. Hence, the
i i 0 i 0
be simplified and rewritten as follows optimization of time portions can only be coordinated at the
AP in a centralized manner.
P3: min D (t)φ (t)− [E (t)−θ ]e (t)
i i i i i
v(t)
i X∈N 2t i X∈N 2t
C. Performance Analysis
+ D (t)ψ (t)+µ (t)TP [E (t)−θ ]ξ h (t)
i i 0 0 i i i i
In this subsection, we start by showing that the proposed
i∈Nt i∈N2
X1 X ERS-RN algorithm is asymptotically optimal. Denote U⋆ as
˜
s.t. C3: µ i(t) ≤ 1, µ i(t) > 0, ∀i ∈ N\N t, the offline optimum of problem P, which can only be obtained
i∈XN˜\Nt by using full non-causal knowledge of the IIoT network.
C4: e (t) ≤ Pmax µ (t)T, i ∈ Nt , Let U∗ denote the long-term time-average utility achieved by
i i i 2
the ERS-RN algorithm. Then, we can establish the following
where v(t)={e i(t)|i ∈ N 2t} ∪ {µ i(t)|i ∈ N˜ \N t} collects all theorem.
variables that is to be optimized, and
Theorem 2: Suppose the problem P is feasible, the gap
between U∗ and U⋆ satisfies
β (t)e (t)
φ (t)=µ (t)log (1+ i i ), i ∈ Nt , (17)
i i 2 2
µ (t)
i U⋆ − U∗ ≤ B /V. (19)
1
δ (t)µ (t)
ψ (t) = µ (t)log (1 + i 0 ), i ∈ Nt . (18) Proof: Please refer to Appendix C
i i 2 1
µ (t)
i Theorem 2 suggests that the achievable time-average utility
Note from (17) that φ (t) is a perspective function of of the proposed method can be arbitrarily close to the offline
i
f(x) = log (1 + β (t)x). Since f(x) is a concave function optimum by setting a sufficiently large V . In other words,
2 i
of x ≥ 0, φ (t) is jointly concave with respect to e (t) > 0 the proposed approach is asymptotically optimal in terms of
i i
and µ (t) > 0 for arbitrary i ∈ Nt [32]. Similarly, we can solving the original problem P. However, it is not the larger
i 2
prove that ψ (t) is concave in {µ (t),µ (t):∀i ∈ Nt} when the value of V , the better. The increase of V would also cause
i 0 i 1
µ (t) > 0 and µ (t) > 0. Since the objective function in a negative impact on system data backlogs, as revealed in the
0 i
P3 is a negative weighted sum of φ (t), ψ (t) and several following theorem.
i i

7
Theorem 3: At any time slot, the data backlogs at WD i ∈ N Therefore, in this section, we proceed to consider a more
and the AP are all upper bounded, with upper bounds given practical scenario of the considered IIoT system, where any
by device i that has been assigned time for offloading at slot t
Qmax =V +Amax , (20) should spare at least ǫ T time to give feedback of its data
i i i
backlog. Here, the time portion ǫ is a constant obtained
i
Smax =V +Amax +cmax . (21)
i i i by historical experience such that there is always enough
energy for transmitting an L bits feedback. WDs that have not
Proof: Please refer to Appendix D
gotten any uplink chances (i.e., silent) at slot t are generally
With Theorem 3, we then provide the value of the weight
not required for feedbacks in order to reduce system NSI
perturbation parameter θ and prove the energy-availability
i
overheads. The only exception is for those WDs that remain
constraint (6) is always satisfies in the following theorem.
silent in the past m slots, in case the shortage of NSI update
Theorem 4: With the proposed algorithm, the energy storage
at the AP permanently prevents some WDs from offloading.
capacity (or the perturbation parameter) θ is given as follows
i
For notation simplicity, we denote those WDs that reach their
(V + Amax)cmax compulsory feedback interval mT at time slot t as M in the
θ = i i + Pmax T, (22) t
i emin i sequel.
i
where emin is the minimum transmit energy other than zero.
i
B. Energy-Aware Resource Scheduling Algorithm with Out-
The equation (22) ensures there is enough energy in the battery
for optimal schedule. In other words, E (t)+eH(t) > P (t)T. dated NSI
i i i
Proof: Please refer to Appendix E The outdated NSI (i.e., data backlogs at WDs) acquired
Theorem 3 and 4 show that Qmax, Smax and θ increase through the above feedback mechanism has a direct impact on
i i i
monotonically with the control parameter V . A larger V leads the optimization of problem P3. To overcome the limitation
to a higher system utility at the expense of larger queue lengths of the ERS-RN algorithm, we develop a modified version of
at all WDs and the AP. On the other hand, a tiny V impairs the ERS algorithm with Outdated NSI (ERS-ON) by approx-
the asymptotic optimality of achievable utility but reduces imating the latest feedback of WDs’ data backlog values as
the demands for large storage spaces of the system. This the current values. Let Q (t) denote the approximation of i-th
i
reveals a [O(1/V ),O(V )] tradeoff between the system utility WD’s data backlog that the AP holds at time slot t. Hence,
and the required storage spaces. Therefore, instead of giving we have Q (t) = Q (tb− τ ), where τ ∈ {1,··· ,m}. Then,
i i i i
each WD a substantial data and energy storage space, we can the problem P3 can be transformed into
reduce the manufacturing costs of IIoT systems by embedding b
P4: min D (t)φ (t)− [E (t)−θ ]e (t)
appropriate data buffers and batteries for WDs based on the i i i i i
v(t)
expected system utility. i X∈N 2t i X∈N 2t
b
+ D (t)ψ (t)+µ (t)TP [E (t)−θ ]ξ h (t)
i i 0 0 i i i i
IV. RESOURCE SCHEDULING IN IIOT WITH i∈Nt i∈N2
X1 X
IMPLEMENTATION CONSIDERATIONS C4b
s.t. ,
In this section, we consider a more general setting in
C5: µ (t) ≤ 1− ǫ , µ (t) > ǫ , ∀i ∈ N\N .
i i i i t
which the overhead and delay for transmitting NSI cannot
i∈XN˜\Nt i∈ XMt
be overlooked. We develop a modified version of the ERS-
RN algorithm, called ERS-ON, to address the issues brought where D (t) = [S (t) − Q (t)]TW, and C5 ensures there is
i i i
by practical application, and further analyze its performance enough time for offloading and feedback in each time slot.
theoretically. Similarbto P3, problem Pb4 can be solved by CVX or other
convex optimization techniques as the constraint C5 preserves
convexity.
A. Practicability Considerations
Let {e∗(t) | i ∈ Nt} collect the optimal energy solutions
i 2
As discussed, real-time NSI feedback (i.e., Q(t)) is needed
and {µ∗(t) | i ∈ N˜ \N } denote the optimal time portions of
i t
at the AP for the joint optimization of energy allocations and
problem P4. The time portions for WDs and the AP at time
time portions. However, the transmission of NSI would occupy
slot t can thus be given by
the time for data offloading, which may jeopardize network
performance, or even prohibit the system from working. To 0, i ∈ N \M
t t
avoid explosive feedback costs, systems may send back only µ (t) = ǫ , i ∈ M (23)
i  i t
partial NSI, as the majority of feedbacks have less contribution
  µ∗(t), otherwise,
i
for optimization. Moreover, even if all WDs give continuous
feedbacks at every slot, the AP can only get outdated NSI where µ (t)=0 means WD i keeps silent at slot t.
i 
(e.g., Q(t−1) at slot t) since it has to make the scheduling Different from the time portions allocation, the energy
decision before obtaining Q (t) in the uplink phase at slot t. policies for WDs vary with their types. For Type-I devices,
i
As a result, the proposed ERS-RN algorithm may be hard to same like the statement in section II, all the harvested energy
be directly applied to real systems. Some modifications are would be consumed for offloading/feedback or be depleted.
needed in the presence of outdated NSI. On the contrary, Type-II devices in N ∩M can dynamically
2 t

8
TABLE II
280
SYSTEM SIMULATIONPARAMETERS
Basic Radio Configuration Parameters
Spectrum Bandwidth W (MHz) 0.2 [34] 260
Pass Loss Exponent α 2 [22] )spbk( tuphguorht egarevA
P0 / Pmax / N0 (W) 2/1/10−9 [22], [34] 240
i
emin / eH (mJ) 0.005/0.16
i i,max
cmax / L (Kbits) 100/0.016 [35]
i 220
−3 −αe  ERS-ON (proposed) 
Channel Power Gain h (t) = 10 d h(t) [22]
i i  EOT-ON       GAN  
Other Simulation Parameters
200  HDO-ON      PFN
Energy Harvesting Efficiency ξ 0.8 [22]
i
Slot Duration (ms) 100 [35]
Simulation Run-Time (slots) 1000 180
adjust their transmit energy to ensure the channel capacity 160
equals the data size of feedback, i.e., L = TWφ (t), thus
i
140
saving excessive energy for future use. More specifically, the 100 200 300 400 500 600
energy allocation policy for device i ∈ N satisfies Control parameter V
2
Fig. 2. Average system throughput versus the control parameter V
ǫi 2li − 1 , i ∈ N ∩ M
βi(t) 2 t
e (t) = e∗(t), i ∈ Nt (24)
i  i (cid:2) (cid:3) 2
V. SIMULATIONS

 0, otherwise,
In this section, we verify the analysis and evaluate the per-
where l i=L/(ǫ iTW ). The allocated transmit energy of Type- formance of the proposedalgorithm via MATLAB simulations.
II devices would not violate the constraints (6) and (7) since The parameters used in our simulation are taken from the
we have a large β i(t) and small l i when WD i ∈ N 2 ∩ M t. existing synthetic data set [22] and 3GPP specifications [34],
[35], to capture the features of practical wireless channels.
Detailed information is listed in Table II. The initial values
C. Asymptotic Optimality Analysis under Outdated NSI
of Q(t), S(t) and E(t) are set to be zero for the fair
The use of outdated NSI will inevitably impair the perfor-
comparison with [13]. In our simulations, we set T =100ms
mance of systems. In the worst case, a WD would lose m
and consider five Type-I devices and five Type-II devices.
chances to offload during the past mT time duration due to
Specifically, we set the distance between the AP and Type-
a lack of information update at the AP. For any slot t, the
I devices as d = (d ,i ∈ N ) = [3,5,7,9,11]m. Without
1 i 1
difference between the approximate values maintained at the
loss of generality, we consider d = (d ,i ∈ N ) = d . The
2 i 2 1
AP and the actual data backlogs at WDs are bounded by
channel is modeled after the Rayleigh fading model and is set
as h (t) = 10−3d−α h(t) [15], where α denotes the pass-loss
t i i
exponent, h(t) is an exponentially distributed random variable
Q (t) − Q (t)= Q (τ) − Q (τ − 1)
i i i i
(25) with unit mean whiech represents the short-term fading. We
τ=t−τi+1
≤X Am(cid:2) (cid:3) assume thaet α = 2 and the channel reciprocity holds for the
b τ ax ≤mAmax ,
i i i
uplink and downlink. The spectrum bandwidth for offloading
where the first inequality is derived from (8) and (9). For and the receiver noise power are set as W = 0.2MHz and
analytical tractability, we denote U∗ as the utility obtained N = 10−9W, respectively. For any device i ∈ N, the energy
0
by using Q (t) for optimization. Based on (25), we can prove harvesting efficiency ξ =0.8, and Amax =1Mbps. At the AP,
i i i
that the optimality loss due to the oubtdated knowledge of Q(t) the transmission power P =2W, rmax =50kbps, and m = 4.
0 i
is strictly bupper bounded as shown in the following theorem. For analysis simplicity, we assume ǫ = ǫ = 0.005s for any
i
Theorem 5: Suppose the problem P is feasible, the gap i ∈ N in the sequel unless otherwise stated.
between U∗ and U⋆ is bounded: We introduce four benchmark algorithms to evaluate the
performance of the proposed ERS-ON algorithm, which work
U⋆ − U∗ ≤ (B + B ǫ )/V, (26)
b 2 3 i as follows:
i∈N
X 1) Homogeneous device optimization with outdated NSI
b
where B = B +m (Amax)2 and B =2 (cmax)2. (HDO-ON): all WDs are seen as Type-I devices and
2 1 i∈N i 3 i∈N i
Proof: Please refer to Appendix F optimized without considering their heterogeneity.
P P
Theorem 5 proves that the asymptotic optimality of the pro- 2) Equal offloading time with outdated NSI (EOT-ON): all
posed ERS-ON algorithm is not compromised with outdated WDs are given equal offloading time at each slot. The
NSI. Compared with Theorem 2, the optimality loss caused optimization of e(t) and µ (t) in this scheme is similar
0
by outdated NSI is no greater than a constant divided by V . to the ERS-ON algorithm.
Moreover, the optimality loss is linear to m and increases with 3) Proportional fairness without NSI (PFN): the allocation
the growth of feedback overheads, which coincides with the of offloading time portions are based on proportional
intuition that a long compulsory feedback interval and a large fairness method with no knowledge of Q(t). In the
overhead result in weak system performances. scheme, overheads for feedback can be saved.

9
1.00 275
0.95 )tibk( DW eht ta golkcab atad egarevA)tibk( PA eht ta golkcab atad egarevA 250
 ERS-ON
0.90 225
 HDO-ON
xedni ssenriaf s’niaJxedni ssenriaf s’niaJ
0.85 200  EOT-ON
 PFN
0.80 175
 GAN
0.75 150
0.70 125
 ERS-ON
0.65 100
 HDO-ON
0.60  EOT-ON 75
 PFN
0.55 50
 GAN
0.50 25
100 200 300 400 500 600 100 200 300 400 500 600
Control parameter V Control parameter V
(a) Fairness performance versus control parameter V (a) Data backlog at the wireless device versus V
1.00 500
 Type-I
0.95 450
 Type-II
0.90 400
 ERS-ON
0.85 350
 HDO-ON
 EOT-ON
0.80 300 without feedback
 PFN
0.75 250
with feedback
0.70 200
0.65 150
0.60 100
0.55 50
0.50 0
ERS-ON HDO-ON EOT-ON PFN GAN 100 200 300 400 500 600
(b) Fairness among different device types, where V =300
Control parameter V
(b) Data backlog at the access point versus V
Fig. 3. Impact of control parameter V and schemes on fairness
Fig. 4. Impact of control parameter V on average data backlog in steady
state
4) Greedy algorithm without NSI (GAN): the scheme
maximizes the system throughput based on channel
Jain’s index is used to measure fairness among WDs [13],
conditions without considering fairness.
[30]. We observe from Fig. 3(a) that HDO-ON has almost the
Fig. 2 illustrates the average throughput of the proposed same high fairness with ERS-ON algorithm, which is barely
and benchmark mechanisms as V increases. Faster growth affected by the choice of V . However, with less concern on
is seen in the proposed algorithm when V is smaller than the heterogeneity, HDO-ON achieves the high fairness at the
200. With a further increase of V , the growth rate gradually cost of tremendous throughput. Furthermore, Fig. 3(b) shows
slows down, which coincides with what revealed in Theorem 5. the fairness of Type-I and Type-II devices, where V is set as
As expected, the proposed algorithm significantly outperforms 300. On one hand, we can see from EOT-ON, PFN, and GAN
HDO-ON, since Type-II devices in ERS-ON can save their that heterogeneous battery capacities would lead to an uneven
energy for future use when channel conditions are not good. offloading opportunity. Different from the above schemes, our
This proves the necessity to consider the heterogeneity of proposed ERS-ON algorithm strikes a good balance between
WDs in system optimization. Besides, we can also observe Type-I and Type-II devices, showing its superiority in handling
that the ERS-ON algorithm achieves higher throughput than systems with heterogeneous WDs. On the other hand, the near
GAN. This is because GAN wastes much offloading time to one Jain’s index also indicates that ERS-ON can also well
for WDs that own good channel conditions but with little or tackle the doubly near-far problem caused by different d .
i
even no data backlogs. The poor performances of GAN and Although higher throughput can be achieved by choosing
PFN combined suggest that it is desirable to acquire NSI for a larger V , it is not always better for the ERS-ON algorithm
system optimization even if the feedback would occupy some to do so. As shown in Fig. 4, the increase of V would also
transmission resource. result in linear growth of data backlogs at both the WD and
Fig. 3 shows the fairness against the control parameter V . the AP. By jointly considering Figs. 2, 3 and 4, we can observe

|    |    |    | None   | None   |    |    |    | None   | None   |    |    |    | None   | None   |    |    |    | None   |    |    | None   | None   |    |    | N   | None   |
|:---|:---|:---|:-------|:-------|:---|:---|:---|:-------|:-------|:---|:---|:---|:-------|:-------|:---|:---|:---|:-------|:---|:---|:-------|:-------|:---|:---|:----|:-------|
|    |    |    |        |        |    |    |    |        |        |    |    |    |        |        |    |    |    |        |    | E  | RS     | -      | O  | N  | N   |        |
|    |    |    |        |        |    |    |    |        |        |    |    |    |        |        |    |    |    |        |    | H  | D      | O      | -O | N  |     |        |
|    |    |    |        |        |    |    |    |        |        |    |    |    |        |        |    |    |    |        |    | E  | O      | T-     | O  |    |     |        |
|    |    |    |        |        |    |    |    |        |        |    |    |    |        |        |    |    |    |        |    | P  | FN     |        |    |    |     |        |
|    |    |    |        |        |    |    |    |        |        |    |    |    |        |        |    |    |    |        |    | G  | A      | N      |    |    |     |        |

| Type-I    | None   | None   | None   | None   | None   | None   | None   | None   | None   | None   | None   | None   | None   | None   | None   |
| Type-II   |        |        |        |        |        |        |        |        |        |        |        |        |        |        |        |
|:----------|:-------|:-------|:-------|:-------|:-------|:-------|:-------|:-------|:-------|:-------|:-------|:-------|:-------|:-------|:-------|

10
technique utilizes a fraction of the total frequency band in each
262
cell, such that no two neighbor cells use the same frequency.
As a result, inter-cell interference can be reduced, and each
261
cell can run the proposed Algorithm 1 independently with its
)spbk( tuphguorht egarevA
260 allocated bandwidth.
259
VI. CONCLUSION
258
257 Given the data collection and offloading in WPT-MEC
based heterogeneous IIoT systems, we have proposed an
 ERS-ON with complete NSI
256
 ERS-ON, m=4 energy-aware resource scheduling algorithm for throughput
 ERS-ON, m=8 maximization and offloading fairness. The performance of
255
 ERS-ON, m=12
such an algorithm was analyzed under a typical scenario,
254 where overhead and delay of feedbacks were non-negligible.
0.005 0.010 0.015 0.020 0.025
Simulations show that the proposed algorithm can achieve
Feedback overhead (s)
asymptotic optimality, and effectively tackle the doubly near-
Fig. 5. Impact of ǫ and m on system average throughput
far problem as well as the unfairness caused by heterogeneous
battery capabilities. As a result, the use of the algorithm is
that the utility-backlog performancefollows the [O(1/V),O(V)] fully justified by its merits on high throughput, fairness and
tradeoff, which verifies Theorem 3 and 5. Besides, the results perpetual operation in implementation.
also provide guidelines for the design of data buffer lengths The integration of the machine-to-machine (M2M) commu-
of WDs in IIoT, since an appropriate V can minimize the cost nications to the wireless powered MEC network is promis-
of embedding lengthy storage spaces given a fixed throughput ing to tackle the scalability problem in large-scale applica-
expectation. By using ERS-ON algorithm, as depicted in Fig. tions [37]. In such a scenario, the proposed algorithm is still
4(a), we can keep the data buffer length at the WD to a small valuable. We can first divide IIoT devices into different clusters
level compared with benchmarks, especially when V is large. according to their proximity and choose the device with the
In Fig. 4(b), the curve for GAN is dropped since its queue best channel condition in each cell to serve as the cluster
length at the AP increases as time goes by and never reaches a head. The AP only need to schedule those cluster heads for
steady state. It can be observed that EOT-ON maintains shorter data offloading with the proposed algorithm, while the other
data backlogs at the AP side. This is because its volume of devices migrate their data to nearby cluster heads through
offloading data is much less than ERS-ON. Furthermore, we M2M interactions. By this way, the computational complexity
also observe that scheme with NSI feedback has a shorter data at the AP can be brought down, and the feedback of NSI
backlog at the AP than one without. can also be reduced. However, M2M communication brings
For implementation considerations, the impact of ǫ and interference for the data offloaded to the AP. How to leverage
m on average throughput is further evaluated. We set ǫ to spatial reuse to coordinate the scheduling leaves for future
vary from 0.005s to 0.025s, and carry out simulations under work.
different compulsory feedback intervals. Fig. 5 shows that the
average throughput linearly reduces as ǫ increases. This is be-
cause the NSI feedback process takes up more time originally APPENDIX A
assigned for offloading when ǫ becomes larger. Compared
with m = 8 and m = 12, ERS-ON with m = 4 achieves Note that for any x ≥ 0, y ≥ 0, z ≥ 0, the following
a higher throughput, which corresponds to the conclusion in inequality
Theorem 5. Besides, in Fig. 5, ERS-ON with complete NSI
feedback represents that WD has to uplink their NSI in every ([x − y]+ + z)2 ≤ x2 + y2 + z2 + 2x(z − y). (27)
slot. Its throughput performance outperforms the others when
ǫ = 0.005s. However, the achievable throughput decreases always holds. Squaring both sides of (9), summing over i ∈ N,
rapidly as ǫ grows, and gets worse than ERS-ON with m=12 dividing both sides by 2 and combining (27), we obtain
when ǫ = 0.025s. This reveals that more NSI contributes to
1
the optimization of resource allocation when the overhead [Q2(t + 1) − Q2(t)]
i i
of feedback is small. Meanwhile, many resources would be 2
i∈N
X
wasted by complete NSI feedback when the signaling cost is
1
≤ [c2(t) + a2(t)] + Q (t)[a (t) − c (t)]
relatively large. In this case, it is even better to choose an i i i i i
2
appropriately large m. i∈N i∈N
X X
1
Although the above sections only consider the scenario of ≤ [(cmax )2 + (Amax )2] + Q (t)[a (t) − c (t)].
i i i i i
2
a single AP, the proposed algorithm can be readily extended
i∈N i∈N
X X
to the scenario of multiple cellular base stations by applying (28)
frequency reuse technique [36]. As the name suggests, the Similarly, using (5) and (10), we have

11
that a†(t), c†(t) and eH† satisfy:
1 ⋆ E †
[(E (t + 1) − θ )2−(E (t) − θ )2] U − { U i(a i(t))} ≤ σ,
i i i i
2
i∈N
i∈N2 X
X
E † †
1 {a (t)−c (t)} ≤ σ, i ∈ N, (32)
≤ [(eH (t))2+e2(t)]+ [E (t)−θ ][eH (t)−e (t)] i i
2 i i i i i i E {c† (t)−r (t)} ≤ σ, i ∈ N
i∈N2 i∈N2 i i
X X
1 E {eH† (t)−e† (t)} ≤ σ, i ∈ N
≤ [(eH )2 + (Pmax T)2] i i 2
i,max i
2
The 0-additive approximation ensures by (14) is as follows
i∈N2
X
H
+ [E (t)−θ ][e (t)−e (t)],
i i i i
Θ E † Θ
∆ ( (t)) ≤B − V U a (t) | (t)
i X∈N2 V 1 i i
(29) ( )
i∈N
X (cid:0) (cid:1)
and
E † † Θ
+ Q (t) a (t) − c (t) | (t)
i i i
1
[S2(t + 1)−S2(t)] i X∈N n o
i i
2 E † Θ
+ S (t) c (t) − r (t) | (t)
i∈N i i i
X
≤ 1 [r2(t)+(min{c (t),Q (t)})2] i X∈N n o
2 i i i + [E (t)−θ ]E {eH† (t)−e (t)† | Θ (t)},
i∈N i i i i
X
i∈N2
+ S (t)[min{c (t),Q (t)}−r (t)] X (33)
i i i i (30)
i∈N By substituting (32) into (33) and taking σ → 0, we have
X
1
≤ [r2(t)+c2(t)] + S (t)[c (t) − r (t)]
i i i i i
2 ∆(Θ (t))−V E U a (t) | Θ (t) ≤B −V U⋆ (34)
i∈N i∈N i i 1
X X
( )
1 i∈N
≤ [(rmax )2+(cmax )2] + S (t)[c (t) − r (t)] X (cid:0) (cid:1)
i i i i i
2 Using iterated expectations and telescoping sums over t,
i∈N i∈N
X X
dividing both sides by V t and rearranging terms yields
Substituting (28)-(30) into (12) yield (15). Taking expecta-
t−1 E Θ
Θ 1 B {L( (0))}
tion of the Lyapunov drift conditioned on (t) and subtracting E U a (t) ≥U⋆ − 1 − (35)
i i
V E { U i(a i(t)) | Θ (t)} to both sides proves the result. t ( ) V V t
i∈N τ=0 i∈N
X X (cid:0) (cid:1)
E Θ
P Since {L( (0))} < ∞ holds, taking limits on both sides of
APPENDIX B (35) as t → ∞ proves the result.
By substituting (2) into the objective function of problem
APPENDIX D
P2, the problem can be reformulated into minimizing
The proof can be obtained by mathematical induction. We
first show that Q (t) is deterministic bounded by V+Amax for
[S i(t) − Q i(t)]c i(t) − [E i(t)−θ i]e i(t) i i
all t. This clearly holds for t = 0 as Q (0) = 0. Suppose it
i∈N2 i∈N2 i
X X
holds for time slot t, then we show it also holds for time slot
+ [S (t)−Q (t)]c (t)+µ (t) [E (t)−θ ]ξ P h (t)T.
i i i 0 i i i 0 i t + 1. Consider the case when Q (t) ≤ V . Since the buffer
i
i X∈N1 i X∈N2 can increase by at most Amax at any slot, we have Q (t+1) ≤
(31) i i
V +Amax. Then consider the other case when V < Q (t) ≤
The last term in (31) a decreasing function of µ (t) since i i
0
V +Amax. In this case, the data admission a (t) should choose
[E (t)−θ ]ξ P h (t)T is a non-positive constant. For i i
i∈N2 i i i 0 i
to be zero according to (16). Hence, we have
any WD i ∈ N ∩N , we can choose µ (t)=0 to minimize the
t 1 i
P
term [S i(t)−Q i(t)]c i(t) and re-allocate the originally allocated Q (t + 1)=[Q (t) − c (t)]+≤Q (t)≤V + Amax .
i i i i i
time portion of WD i for µ (t). For arbitrary i ∈ N ∩N , as
0 t 2
c i(t) is a non-decreasing function of e i(t) and E i(t) < θ i, the In other words, Q i(t + 1) ≤ V + Am ax holds at t + 1, which
i
term [S i(t) − Q i(t)]c i(t) − [E i(t)−θ i]e i(t) is non-decreasing completes the proof of the upper bound of Q i(t).
with e i(t). Hence, the minimal value of the first and second Similarly, we proceed to prove S i(t)≤V +Am ax+cm ax by
i i
terms in (31) is 0 when e (t) = 0. In such condition, µ (t) mathematical induction. Again, it holds for t = 0 as S(t) = 0
i i
has no contribution to the value of the objection function. It at the beginning and we suppose it also holds in time slot t.
is better to make µ (t)=0 and add the value of µ (t) so as When S(t) ≤ V + Amax, from (10), we obtain
i 0 i
to minimize the objective function.
S (t + 1) = [S (t) − r (t)]+ + min{c (t),Q (t)}
i i i i i
≤ S (t) + cmax (36)
i i
APPENDIX C Amax cmax
≤ V + + .
i i
Based on [31], for all σ > 0, there exists a feasible Otherwise, in the case when S (t) ≥ V +Amax, using the
i i
stationary policy Π† that chooses a†(t), e†(t) and µ˜†(t) such previously proven conclusion (20) yields S (t) ≥ Q (t). This
i i

12
means the corresponding backlog at the AP is larger than the in (14). Similar to F(t), we are motivated to minimize the
queue length at i-th WD, i.e., i ∈ N . In such a condition, expectation of F(t) under the feedback mechanism, where
t
the AP will allocate no offloading time for WD i according
F(t) = − V U a (t)
to Theorem 1. Therefore, no data from WD i arrive at the AP b i i
at time slot t, i.e., c (t) = 0. We have i∈N
i X (cid:0) (cid:1)
b
+ Q (t)[a (t) − (1 − ǫ )c (t)]
i i i i
S (t+1) = [S (t)−r (t)]+ ≤ S (t) ≤ V +Amax +cmax . (37)
i i i i i i i∈N i∈Mt
X X
From (36) and (37), we can prove that S (t+1)≤V +Amax + + Sb (t)[(1 − ǫ )c (t) − r (t)]
i i i i i i
cm ax holds at time slot t+1. This thus concludes the proof.
i X∈N i∈ XMt
i
H
+ [E (t)−θ ][(1 − ǫ )e (t)−e (t)].
i i i i i
APPENDIX E
i∈N2 i∈Mt
X X
(42)
If θ is set according to (22) and E (t)≤ PmaxT at slot t,
i i i Since the real-time queue length is always larger than the
we obtain
(V + Amax)cmax approximate queue backlog, combined with (25), we have
E (t) − θ ≤ − i i (38)
i i
emin Q (t) ≤ Q (t) ≤ Q (t) + mAmax (43)
i i i i i
Considering arbitrary WD i ∈ N , we have
2 Therefore, we can derive that
b b
[S (t) − Q (t)]c (t) − [E (t) − θ ]e (t)
i i i i i i F(t)−F(t)= [Q (t)−Q (t)]a (t)+ ǫ S (t)c (t)
(39) i i i i i i
max max
≥ − Q (t)c (t) + (V + A )c ≥ 0
i i i i i∈N i∈Mt i∈N
X X X
b b
where the second inequality holds because (20) is always + [Q (t)(1 − ǫ ) − Q (t)]c (t)
i i i i
satisfied. According to the proof in Theorem 1, WD i will i∈N i∈Mt
X X
not be allocated time for offloading if (39) holds. This proves b H
+ ǫ [E (t) − θ ]e (t)
i i i i
that E (t) > PmaxT is guaranteed under the given θ , thus we
i i i i∈Mt i∈N2
have E (t)+eH(t)>P (t)T. X X
i i i ≤ m (Amax )2 + ǫ [S (t) − Q (t)]c (t)
i i i i i
i∈N i∈Mt i∈N
X X X
APPENDIX F
≤ m (Amax )2 + 2 ǫ (cmax )2
i i i
Before the proof of Theorem 5, we first prove the following
i∈N i∈N i∈N
X X X
theorem through mathematical induction. (44)
Theorem 6: At each time slot, the difference between the where the first inequality holds since E (t) ≤ θ and (43) are
i i
backlogs at each WD i ∈ N and the AP is strictly bounded, satisfied, and the second inequality is derived from Theorem 6.
which is given by Submitting (44) into (14), we have
S (t) − Q (t) ≤ 2cmax . (40)
i i i Θ Θ E Θ
∆ ( (t)) =∆( (t))−V U a (t) | (t)
V i i
( )
Proof: The upper bound holds at slot t = 0 given that i∈N (45)
X (cid:0) (cid:1)
S (t) = Q (t) = 0,∀i ∈ N. Suppose it holds at time slot t. E Θ
i i ≤B + B ǫ + {F(t) | (t)},
2 3 i
Then, if S (t)−Q (t) < 0, we have
i i i∈N
X
b
Q (t+1)=[Q (t)−c (t)]++a (t) ≥ Q (t)−c (t)+a (t). (41) where B =B +m (Amax)2 and B =2 (cmax)2.
i i i i i i i 2 1 i∈N i 3 i∈N i
We can then prove this theorem by using the similar argument
Combining (36) and (41), we see that P P
in the proof of theorem 2.
S (t + 1)−Q (t + 1) ≤ S (t)−Q (t)+2c (t)−a (t)
i i i i i i
2cmax REFERENCES
< 2c (t)−a (t) ≤
i i i
[1] E. Sisinni, A. Saifullah, S. Han et al., “Industrial internet of things:
On the other hand, if 0 ≤ S (t)−Q (t) ≤ 2cmax, c (t) = 0
i i i i Challenges, opportunities, and directions,” IEEETrans. Ind. Inf., vol. 14,
according to Theorem 1. Hence, we have no. 11, pp. 4724–4734, Nov. 2018.
[2] K. Wang, Y. Wang, Y. Sun et al., “Green industrial internet of things
S (t + 1)−Q (t + 1) = [S (t)−r (t)]+−Q (t)−a (t) architecture: An energy-efficient perspective,” IEEE Commun. Mag.,
i i i i i i
vol. 54, no. 12, pp. 48–54, Dec. 2016.
max
≤ S(t)−Q (t) ≤ 2c
i i [3] J. Wan, S. Tang, Z. Shu et al., “Software-defined industrial internet of
things in the context of industry 4.0,” IEEE Sensors J., vol. 16, no. 20,
As a result, the upper bound also holds at time slot t+1, which
pp. 7373–7380, Oct. 2016.
concludes the proof. [4] I. Bisio, C. Garibotto, A. Grattarola et al., “Exploiting context-aware
Owing to the feedback mechanism of queue lengths, part capabilities over the internet of things for industry 4.0 applications,”
IEEE Netw., vol. 32, no. 3, pp. 101–107, May 2018.
of the offloading opportunity will be occupied. Hence, only
[5] Y. Fu, S. Wang, C. Wang et al., “Artificial intelligence to manage
(1 − ǫ )T can be used for WPT and offloading in network traffic of 5G wireless networks,” IEEE Netw., vol. 32, no. 6,
i∈Mt i
each time duration. This will have a direct influence on c (t) pp. 58–64, Nov. 2018.
i
P [6] H. Ye, L. Liang, G. Y. Li et al., “Machine learning for vehicular net-
and eH as can be seen from (2) and (3). Let F(t) denote the
i works: Recent advances and application examples,” IEEE Veh. Technol.
function inside the expectation on the RHS of the drift bound Mag., vol. 13, no. 2, pp. 94–101, June 2018.

13
[7] M. Tseng, T. Edmunds, and L. Canaran, “Introduction to Edge Com- [22] X. Hu, K. Wong, and K. Yang, “Wireless powered cooperation-assisted
puting in IIoT,” Industrial Internet Consortium (IIC) White Paper, Tech. mobile edge computing,” IEEE Trans. Wireless Commun., vol. 17, no. 4,
Rep., June 2018. pp. 2375–2388, Apr. 2018.
[8] M. Aazam, S. Zeadally, and K. A. Harras, “Deploying Fog Computing [23] F. Wang, J. Xu, X. Wang et al., “Joint offloading and computing
in Industrial Internet of Things and Industry 4.0,” IEEE Trans. Ind. Inf., optimization in wireless powered mobile-edge computing systems,”
vol. 14, no. 10, pp. 4674–4682, Oct. 2018. IEEE Trans. Wireless Commun., vol. 17, no. 3, pp. 1784–1797, March
[9] K. Kaur, S. Garg, G. S. Aujla et al., “Edge computing in the industrial 2018.
internet of things environment: Software-defined-networks-based edge- [24] Z. Hou, H. Chen, Y. Li et al., “Incentive mechanism design for wireless
cloud interplay,” IEEE Commun. Mag., vol. 56, no. 2, pp. 44–51, Feb. energy harvesting-based internet of things,” IEEE Internet Things J.,
2018. vol. 5, no. 4, pp. 2620–2632, Aug. 2018.
[10] Y. Mao, J. Zhang, S. H. Song et al., “Stochastic joint radio and com- [25] X. Lyu, W. Ni, H. Tian et al., “Distributed online optimization of fog
putational resource management for multi-user mobile-edge computing computing for selfish devices with out-of-date information,” IEEETrans.
systems,” IEEETrans. Wireless Commun., vol. 16, no.9, pp. 5994–6009, Wireless Commun., vol. 17, no. 11, pp. 7704–7717, Nov. 2018.
Sept. 2017.
[26] C. Ren, X. Lyu, W. Ni et al., “Distributed online learning of fog
[11] X. Lyu, H. Tian, W. Ni et al., “Energy-efficient admission of delay-
computing under non-uniform device cardinality,” IEEE Internet Things
sensitive tasks for mobile edge computing,” IEEE Trans. Commun., J., vol. 6, no. 1, pp. 1147–1159, Feb. 2019.
vol. 66, no. 6, pp. 2603–2616, June 2018.
[27] X. Lyu, C. Ren, W. Ni et al., “Multi-timescale decentralized online
[12] J. Zhang, X. Hu, Z. Ning et al., “Energy-latency tradeoff for energy-
orchestration of software-defined networks,” IEEE J. Sel. Areas Comm-
aware offloading in mobile edge computing networks,” IEEE Internet
mun., vol. 36, no. 12, pp. 2716–2730, Dec. 2018.
Things J., vol. 5, no. 4, pp. 2633–2645, Aug 2018.
[28] Z. Yang, W. Xu, Y. Pan et al., “Optimal fairness-aware time and power
[13] X. Lyu, W. Ni, H. Tian et al., “Optimal schedule of mobile edge
allocation in wireless powered communication networks,” IEEE Trans.
computing for internet of things using partial information,” IEEE J. Sel.
Commun., vol. 66, no. 7, pp. 3122–3135, July 2018.
Areas Commun., vol. 35, no. 11, pp. 2606–2615, Nov. 2017.
[29] L. Huang and M. J. Neely, “Utility optimal scheduling in energy-
[14] Y. Mao, J. Zhang, and K. B. Letaief, “Dynamic computation offloading
harvesting networks,” IEEE/ACM Trans. Netw., vol. 21, no. 4, pp. 1117–
for mobile-edge computing with energy harvesting devices,” IEEE J.
1130, Aug. 2013.
Sel. Areas Commmun., vol. 34, no. 12, pp. 3590–3605, Dec. 2016.
[30] H. SHI, R. V. Prasad, E. Onur et al., “Fairness in wireless net-
[15] H. Ju and R. Zhang, “Throughput maximization in wireless powered
works:issues, measures and challenges,” IEEE Commun. Surveys &
communication networks,” IEEE Trans. Wireless Commun., vol. 13,
Tutorials, vol. 16, no. 1, pp. 5–24, First 2014.
no. 1, pp. 418–428, Jan. 2014.
[31] M. J. Neely, “Stochastic network optimization with application to
[16] Q. Wu, M. Tao, D. W. K. Ng et al., “Energy-efficient resource allocation
communication and queueing systems,” Synthesis Lectures on Commun.
for wireless powered communication networks,” IEEE Trans. Wireless
Netw., vol. 3, no. 1, pp. 1–211, 2010.
Commun., vol. 15, no. 3, pp. 2312–2327, Mar. 2016.
[32] S. Boyd and L. Vandenberghe, Convex Optimization. UK: Cambridge
[17] J. Yang, Q. Yang, K. S. Kwak et al., “Power-delay tradeoff in wireless
Univ. Press, 2004.
powered communication networks,” IEEE Trans. Veh. Technol., vol. 66,
[33] M. Grant and S. Boyd. (2010, Apr.) Cvx: Matlab software for
no. 4, pp. 3280–3292, Apr. 2017.
disciplined convex programming (web page and software). [Online].
[18] S. Mao, S. Leng, K. Yang et al., “Energy efficiency and delay tradeoff in
Available: http://cvxr.com/cvx
multi-user wireless powered mobile-edge computing systems,” in Proc.
[34] 3GPP, “Cellular system support for ultra-low complexity and low
IEEE GLOBECOM, Dec. 2017, pp. 1–6.
throughput Internet of Things,” Rep. TR 45.820 v13.1.0, Tech. Rep.,
[19] Z. Hadzi-Velkov, I. Nikoloska, H. Chingoska et al., “Opportunistic
Nov. 2015.
scheduling in wireless powered communication networks,” IEEE Trans.
[35] ——, “Study on NR Industrial Internet of Things,” Rep. TR 38.825
Wireless Commun., vol. 16, no. 6, pp. 4106–4119, June 2017.
v16.0.0, Tech. Rep., Mar. 2019.
[20] Y. L. Che, L. Duan, and R. Zhang, “Spatial throughput maximization
[36] G. Nie, H. Tian, C. Sengul et al., “Forward and backhaul link opti-
of wireless powered communication networks,” IEEE J. Sel. Areas
mization for energy efficient ofdma small cell networks,” IEEE Trans.
Commmun., vol. 33, no. 8, pp. 1534–1548, Aug. 2015.
Wireless Commun., vol. 16, no. 2, pp. 1080–1093, Feb 2017.
[21] S. Bi and Y. J. Zhang, “Computation rate maximization for wireless
powered mobile-edge computing with binary computation offloading,” [37] A. Virdis, C. Vallati, G. Nardini et al., “D2D communications for large-
IEEE Trans. Wireless Commun., vol. 17, no. 6, pp. 4177–4190, June scale fog platforms: Enabling direct M2M interactions,” IEEE Veh.
2018. Technol. Mag., vol. 13, no. 2, pp. 24–33, June 2018.