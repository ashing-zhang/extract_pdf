7102 ceD 41  ]MQ.oib-q[  1v77150.2171:viXra
Single gene dynamics under controlled mating
Vladimir Obolonkin1,*, Anatoly Zherelo2, George Krylov3, Murray
Jorgensen4, Richard Spelman1
1 Livestock Improvement Corporation, Hamilton, New Zealand
2 Department of Nonlinear and Stochastic Analysis, Institute of
Mathematics, National Academy of Sciences, Minsk, Belarus
3 Department of Physics, Belarusian State University, Minsk,
Belarus
4 Department of Statistics, University of Waikato, Hamilton, New
Zealand
* E-mail: vobolonkin@lic.co.nz
Abstract
We seek models for the genotype evolution of agricultural animals, animals
involved in primary production processes. Classical models for genotype
evolution have tended to be very simple in order that analytic methods may
be employed in their study. Unfortunately these models fail to describe pro-
cesses in artificially controlled populations including agricultural livestock. It
is particularly important to describe such processes in order to make better
use of the massive genotyping data becoming available.
We describe an approach to stochastically modeling the dynamics of a
biallelic polymorphism herds under conditions of controlled mating and re-
striction of herds size from above. The system of stochastic differential equa-
tions that we propose is based on jump diffusion processes to provide an
effective platform for Monte Carlo simulation. Our choice of this modeling
framework foreshadows the use of semi-analytic tools to complement simula-
tion. Another reason for adopting the framework is its flexibility in modeling
different population management systems.
A feature of the model is the division of the population into a main herd
comprised of animals involved in the production process and a replacement
herd of animals not currently in the production process, typically juvenile
1

animals. This feature allows for exploring different strategies for adding
replacement animals to the main herd without altering the part of the model
concerned with the dynamics of the main herd.
A discrete-time version of the model has been developed which reflects
the typical practice of New Zealand dairy herd management.
Our Monte Carlo simulation has demonstrated that an isolated deme
whose size is bounded above (by imposition of a fixed size control require-
ment) demonstrate size stabilization at a level less than the control limit, it
is looks like partial extinction, the effect being well known in classic mod-
els. Another interesting feature of the model with a size control rule is its
sensitivity to a form of a control. We have found that even change a rule to
different moment of choice of animal substitution ( from replacement herd to
a main one) results in observable variation in herds’ temporal characteristics.
We demonstrate several simulation results under the condition of Mendelian
inheritance and its corresponding rule of summation. We also propose a vari-
ant of the model taking into account animal inflows and outflows providing
exchange through an external market. For future work we consider the co-
operative development of an open source platform for such modeling and for
in silico experiments utilizing real genotyping data from the New Zealand
dairy cow population.
Introduction
The two seminal papers of G. Hardy [1] and W. Weinberg [2] on the steady
state distribution of alleles were based on the Mendelian law of genetics. The
Mendelian law and these papers are the corner stones of practical genetics
and strongly influenced later development in the field.
One of the main results, called Hardy-Weinberg equilibrium, states that in
a population satisfying certain conditions the observed frequencies of possible
genotypes AA, AB, BB in some locus of interest are p2, 2pq, q2, where p and
q = 1 − p are the proportions of the alleles A and B at the locus. In
reality, the conditions needed to ensure Hardy-Weinberg equilibrium often
fail to be met. For example in the case of New Zealand dairy cows, the
national herd has about 4 × 106 cows distributed in about 1.1 × 104 herds.
There were just over 3700 bulls used for insemination in 2013-2014 season
with under 100 top bulls used to mate 80% of the whole national herd.
Except by chance the genotype frequencies in whole population are far from
2

Hardy-Weinberg proportions at any locus and the proportions vary by herd,
region, and loci. Table 1 compares the conditions needed to establish Hardy-
Weinberg equilibrium with the production situation in the dairy industry in
New Zealand and, we suspect, many other countries.
In reality such steady-state results are not of central interest for animal
breeding decisions as the intent is to change the properties of the production
herd in a favored direction. Before considering a more realistic model for
such controlled breeding we will set the scene by mentioning some classical
dynamic models in genetics.
One of the most influential such models was a genetic evolution model
proposed by S. Wright [3] and R. Fisher [4]. In this model, for a fixed size
total population and binary alleles (A, B), the discrete time dynamics of
relative frequencies of different types of individual is considered under the
neutrality (equal fitness) and Markov assumptions. This allows a stochastic
dynamic flow with rather good analytical properties. The model has the
same probability structure that would result if each of the N individuals of
st
the n + 1 generation picked their parents at random, though of course this
cannot literally happen. A prominent phenomenon of the neutral Wright-
Fisher model without mutation is a “fixation” that is the extinction of all
types but one at a finite but random time.
The further development of the Fisher approach has been in ways of
weakening the assumptions used. The two most evident ones are to introduce
more types of alleles [5] and to consider a variable resampling rate (floating
total population size) [6,7]. More sophisticated approaches are to introduce
a more complicated distribution law (say, a Poissonian one) for a number of
offspring of an individual [5], to take into account mutation and/or selection
[8], to introduce a random process for mortality of individuals [9], or to work
with diffusion-like models [10]. Good introductions to some of these general
topics can be found in [11,12] and the first chapter of [5].
These models are relatively simple in that analytical results for variables
of interest, or asymptotic expansions for them, may be derived within them
(see for example [13]). But to make the obtaining of analytical results a goal
inevitably leads to a focus on mathematical tractability in the setting up of
the model. This in turn encourages the avoidance of the complexities of real
life problems, resulting in an oversimplified model.
An important point is that classical models typically assume infinitely
large population size while investigating the dynamics of allele frequencies.
While these models have powerful asymptotic analysis techniques available
3

to them they are not relevant to the situation of a typical farm running a herd
of only a few hundred cows. So instead we will concentrate on accounting
for the effects of a finite, stochastically driven, herd size.
While in this paper we concentrate on cows on a particular farm it is
important to note that these farm herds are strongly connected by the fact
mentioned above that a few tens of top bulls fertilize millions of New Zealand
cows. This focus on a small number of male animals is in further contrast to
the situation envisioned by the classical population models.
Another difficulty with the quest for analytic solutions is that often they
are available only for the evolution of mean values of variables of interest and
not for other properties of their distributions such as variance and shape,
whose knowledge will be required in real industry applications. Thus it is
necessary to put analytic methods to the side and develop realistic stochastic
models allowing Monte-Carlo simulation of all required distributions.
The chief tool available to the dairy industry for improvement of the
genetic merit of the herd is the ability, via artificial insemination, to choose
the parents of the next generation. So our concern is chiefly with genotype
dynamics under controlled mating, often termed artificial breeding in the
dairy industry. Genomic methods are becoming important in sire selection
now that statistical genomic prediction methods are available [14]. Hand in
hand with this animal evaluation technology vast genotyping data sets are
increasingly available.
The model we develop in this paper is a rather general one in sense of
being capable of a range of adjustments. For example other species could
be considered, as might more sophisticated rules of genotype sum possibly
addressing genotype dependent (genomic) selection, or other departures from
the equal fitness assumption. Our model simulates the dynamics of alleles at
a single locus in each animal of a herd under controlled mating.
The model, in the discrete form given below, incorporates some features
typical for New Zealand seasonal dairy herd management practice. This
allows the model to be useful for estimating the time necessary to reduce the
proportion of unwanted genomic variants in the population to an acceptably
low value. Also it could be used to estimate the time to introduce some
desirable genomic variant, for example one that influenced milk composition
in a beneficial way.
There are a growing number of genomic discoveries published concerning
the importance of some particular single variants [15], [16], [17]. It is obvious
the number of known deleterious genes will increase as knowledge is gained
4

and more is understood about common diseases. Every sire selected for
AI carries some deleterious genes. The model developed may help in risk
analysis by running different scenarios to optimize AI strategy in sense of
performance merit vs deleterious gene carrying.
Methods
Firstly we introduce a general stochastic model for genotype evolution in
an isolated herd subjected to a maximum herd size. Secondly we present a
discrete-time version of this model as well as a generalization which allows
a limited inflow of animals from an external source such as the market. The
discrete model is then used in few simulations to illustrate its use, obtaining
some interesting results. Finally we outline directions for possible further
development.
Let us consider a herd as effectively comprising two sub-herds: the main
(production) herd and a replacement herd. The main herd consists of adult
animals providing the productive output of a herd e.g. cows in milk. The
replacement herd includes mostly young animals from birth up to just before
going into production. It can also include some (typically small) number of
adult animals, each expected to be suitable when required to join the main
herd as a replacement.
We will (for example in equations 2 below) use subscripts i and j to refer
to individual members of each herd but these numbers will refer to a formal
position in a herd, much as do the numbers on the shirts of football players
in a team. We will use functions of the form f (t) to refer to properties of the
i
animal in position i of the herd as a function of time, t. If a maximum herd
size is imposed, a new animal can only be introduced as a replacement for
a removed animal or if the herd size is below the limit. In the latter case it
will take the first unoccupied position. If animal i is replaced at time t this
∗
will typically cause a discontinuity or ‘jump’ in the function f (t) at t = t .
i ∗
The presence of animal replacements means the stochastic processes in
our model will have jumps. Such processes have found much application
in financial modeling. It has been found that the best way to formulate
these processes is to use the integral form of stochastic differential equations
using stochastic Ito integration ( [18,19]). Jumps usually arise in financial
modeling as the result of a real-world event changing the value of a stock.
The jumps in our model will not be of this kind. An analog of our type of
5

model in Finance might be where a portfolio of stocks corresponds to a herd
of animals and a jump is caused by replacing one stock in the portfolio by a
new stock.
Our model makes a number of assumptions about the main and replace-
ment herds and some parameters of animal movements in and out of the
herd.
List of assumptions for continuous time model
1. The number of cows in the main herd is initialised to N at the initial
0
time t = 0 and never exceeds this value subsequently. The correspond-
0
ing dynamical variable is N(t).
2. The number of cows in the replacement herd is initialised to M at
0
the initial time t = 0 and never exceeds this value subsequently. The
0
corresponding dynamical variable is M(t).
3. At initial time t = 0, the age of cows in the main herd is generated by
0
a customized random number generator.
4. The genotype of a progeny follows from that of its parents via a summa-
tion rule. In this article we consider the Mendelian only case expressed
by equation 1.
5. The departure of an animal from the main herd is subject to a Poisson
process with a rate parameter λ . This allows uniform accounting for
D
different causes of animal departure (animal fate).
6. The departure of an animal from the replacement herd is also subject
to a Poisson process with another rate parameter λ .
d
7. The animal movements between sub-herds and departures happen an-
nually (once a year) and are simulated by the following scheme. Using
assumptions 1 to 6 simulate this year’s set of animals to depart. Then
fill vacancies thus created in the main herd by random choice (variable
ξ) from members of the replacement herd that have reached the age
of t years to maintain predefined size. If this turns to be impossi-
min
ble due to lack of heifers of proper age in the replacement herd, then
replace as many as possible, the main herd now taking a smaller size.
6

8. The replacement strategy in the replacement herd is annual (once a
year) addition of newborn calves to maintain predefined size M. If it
turns to be impossible due to lack of newborn calves, the replacement
herd remains with this smaller size.
9. One bull, or team of bulls, of known genotype sires the whole herd. A
new generation appears every year.
10. There is no in-flow of animals from outside.
Assumptions 5 and 6 are for simplicity and may later be replaced by
other descriptions of these animal departure processes more closely reflecting
actual herd management practice.
Assumption 7 somewhat departs from the common practice, which is to
have some flow of animals from outside (say, from the market) but we leave
this for a subsequent publication considering the modeling of multiple herds.
There is some discussion of market influence below; see Herd with a limited
inflow of animals.
The parameters λ , λ are chosen by estimating the mean of animal’s
D d
life time in the main and replacement herds respectively either on common
practice or detailed analysis of the survival curve. In New Zealand practice
actual mortality as a cause of departure from either herd would be rare but
poor condition might cause a decision to remove an animal from either herd
Variants of the model with different strategy, distribution and parameter
settings are possible but are outside the scope of this article.
Rule of single genotype sum
We represent the genotype of an animal in the locus of interest as a number
from {−1, 0, 1}. Where −1 and 1 stand for homozygous and 0 for heterozy-
gous genotypes correspondingly.
The mode of inheritance at a single locus assumed to be Mendelian leading
to the following rule of summation (where P gives the probability of each
outcome):
7

(−1)+˙ (−1) = −1, P = 1
−1 P = 0.5
0+˙ (−1) =
0 P = 0.5
(
1+˙ (−1) = 0, P = 1 (1)
−1, P = 0.25
0+˙ 0 = 0, P = 0.5


1, P = 0.25
0, P = 0.5

1+˙ 0 =
1, P = 0.5
(
1+˙ 1 = 1, P = 1
Here +˙ is a commutative infix operation giving a random value of a ‘child’
genotype as a random function of two variables of corresponding parental
genotypes.
Continuous time model: integral form
Our goal in this article has been to introduce a very general model with the
flexibility to represent a variety of types of managed animal populations. To
express such a model in the language of Stochastic Differential Equations
and so have access to that body of theory we need to represent time in a
continuous manner. Models with continuous time can show closeness to the
observable herd dynamics but require some modification to assumptions 6
and 7 in the list of model assumptions given above regarding the random
jump time for the departure processes.
We will use the index j for the above-mentioned formal position in a main
herd and the index i for the same in the replacement one. To develop our
stochastic model of two interacting herds we state two elementary evolution
processes for every index. The first is the process of the changing genotype
value in a position (j or i), designated as D (t) or d (t). The second is the
j i
process of the changing animal age in a position, designated as A and a .
j i
These processes are responsible for decisions on position characteristics such
as whether or not to replace an animal.
8

The control on animal departure from the herds will be based on ad-
ditional independent processes P and P in such a way that changes of
D d
j i
D (t) and (or) d (t) occur precisely at the time moment of a jump of the
j i
appropriate Poisson process P.
Accounting for this and based on the previous discussion, we can write
down a system of stochastic equations describing temporal evolution of en-
semble of cows in main and replacement herds in the following form
t
D (t) = D (0) + −D (s−) + d (s−) dP (s + A (0))
j j j ξ Dj j
0 j
t
d (t) = d (0) + (−d (s−) + f(D (s−), S ))dP (s + a (0))
i i i η ζ d i
R0 (cid:0) i (cid:1) i i (2)
t
A (t) = A (0) + t − (A (s−) − a (s−))dP (s + A (0))
j j j ξ Dj j
R 0 j
t
a (t) = a (0) + t − a (s−)dP (s + a (0))
i i i d i
R0 i
R
where t ∈ [0, T], and the other quantities in equation (2) are defined as
follows
• D is the value of the allele for a formal j-th cow in the main herd;
j
• P is the Poisson process with a parameter λ defining the elimination
D D
j
rate for a cow in the main herd;
• A is the age of the j-th cow of the main herd;
j
• d the value of the allele for a formal i-th cow of the replacement herd;
i
• P is the Poisson process with a parameter λ defining the elimination
d d
i
rate for a cow in the replacement herd;
• a is the age of the i-th cow of the replacement herd;
i
• f(·, ·) is the female calf’s genotype as a stochastic function of the
parental genotypes. Here f(·, ·) is usually given by the rule of sum-
mation, equation 1, but other rules are possible.
• η is a random variable corresponding to the random choice of a cow
from the main herd to be used as a dam for the replacement herd and
which subsequently gives birth to a female animal.
• {S } is a set of values of alleles for sires;
k
9

• ζ is a rule for choosing the sire; it can be a random variable or a
determined sequence.
We explain the correctness of the system (2) for a position j in the main
herd as follows. A jump of the Poisson process for the first equation occurs
at a moment s. Due to the definition of the Ito integral the new value of
the locus is formed by arithmetic summation with terms −D (s−)+d (s−).
j ξ
The first term zeros the current position value and the second one establishes
the new value (with a random choice ξ). Based on the same Poisson process
jump the third equation in (2) reflects the change at position j of the age
variable A , taking into account that age should be increased if there is no
j
jump (term t in this equation). In a similar way we deal with replacement
herd except for the fact that the new genotype value at the locus is defined
by the summation rule (1). The connection of the replacement herd with
a main one is fulfilled via the term D (s−) as an argument in function f
η
defined above.
At a given stage of the model construction we assume that all variables
and processes are mutually independent, for example that the loss of a cow
from the main herd is not affected by losses in the replacement herd. Integrals
are in Ito’s sense, see for example [20], p. 84.
The definition of integrals over a Poisson process can be done by taking
into account the fact that P(t) = P(t)+λt, where P(t) is the Poisson process
with a parameter λ, and P(t) is a martingale corresponding to P(t) known
as the compensated Poisson proceses.
An important point toebe mentioned is that the proposed model is a rig-
orously defined system of stochastic differential equations in integral form.
One possible alternative approach to the modeling would be to proceed as is
done in Evolutionary Game Theory [21] where one defines a stochastic dy-
namical flow by set of local “game rules”, an approach which is also suitable
for Monte-Carlo simulation of system evolution. Formulation in the form of
stochastic differential equations also allows Monte-Carlo simulation but does
not restrict itself to this. For example approximate methods of the so-called
weak type [22, 23] exist which allow (admittedly in a rather difficult way)
direct estimates of functionals constructed on solutions of stochastic differ-
ential equations, such as the functionals for mean and variance of variables
of interest. These direct estimates do not require exhaustive Monte-Carlo
simulation to ensure proper statistic quality of simulation results.
Leaving this possibility for future work, we turn to discrete-time methods.
10

So now let us reformulate the model in the discrete form suitable for Monte-
Carlo simulation.
The model in discrete form
Digital computers operate in a discrete world and so for simulation purposes,
it is convenient to work with a model in discrete time. Note also that we
would commonly lack precise information on the timing of events in a herd
but may have this information on a monthly or annual basis. We discretize
the above model at a sequence of fixed time steps 0 = τ < τ < . . . < τ = T
0 1 L
.
We suppose that in each of the L intervals (τ , τ ] the probability of
l−1 l
more than one Poisson process jump (control action) within the interval is
negligible, or alternatively that multiple jumps can be replaced by a single
jump of value equal to the sum of the individual jumps.
Then we arrive at the following discrete system of model equations:
L
D (t) = D (0) + (−D (τ ) + d (τ ))sign[P(λ A (τ ))]I (τ )
j j l=1 j l−1 ξ l−1 D j l−1 [0,t) l
L
d (t) = d (0) + (−d (τ ) + f(D (τ ), S )) sign[P(λ a (τ ))]I (τ )
i i Pl=1 i l−1 η l−1 ζ d i l−1 [0,t) l
L
A (t) = A (0) + (1 + (a (τ ) − A (τ ))sign[P(λ A (τ ))])I (τ )
j j P l=1 ξ l−1 j l−1 D j l−1 [0,t) l
L
a (t) = a (0) + (1 − a (τ )sign[P(λ a (τ ))])I (τ ).
i i Pl=1 i l−1 d i l−1 [0,t) l
(3)
P
In the system of equations (3), the P(κ) are all independent Poisson
random values with rate parameters
Herd with a limited inflow of animals
The model described in the previous section for a medium herd size can
demonstrate a long period of animal deficit due to an “extinction effect”
which has been mentioned in the literature and which is observable in our
simulation study. (see the discussion of Figure 4 below). Such a situation
seems not to be a typical one as a farmer tends to fill the gap by animal
purchase.
To account for such herd size control polices, we will modify the model
in the following way. We assume that a purchased animal is placed into
the replacement herd first. Such a simple assumption, nevertheless allows
us to incorporate a market inflow by reformulating the meaning of the η
11

variable in equation (3) only. Namely, a a zero value of this variable now will
correspond to the event of a male animal birth whereas for born female the
variable value is still the index of the dam in the main herd. Then we can
rewrite the equations for the replacement herd in the following simple form
L
d (t) =d (0) + − d (τ ) + sign(η)f(D (τ ), S )
i i i l−1 η l−1 ζ
l=1
X (cid:0)
+ (1 − sign(η))D sign[P (λ a (τ ))]I (τ )
M d d i l−1 [0,t) l
L
(cid:1)
a (t) =a (0) + 1 + (1 − sign(η))a
i i M
l=1 (cid:18)
X (cid:0)
− sign(η)a (τ ) sign[P (λ a (τ ))] I (τ ). (4)
i l−1 d d i l−1 [0,t) l
(cid:19)
(cid:1)
where D is the random variable defining the distribution of the modeled
M
allele in animals from the market, a is the random variable for the cows
M
age distribution at the market.
As one can see from the equations (4), when η = 0 (male is born) the
sign-function gives a non-zero contribution into terms with index M and
the last can be interpreted as incorporation of animal from market into the
replacement herd. When η > 0, the factor (1 − sign(η)) zeros the market
contribution, restoring the original system (3).
One additional technical advantage of the last proposed model is that
now the size of the replacement herd is constant, which simplifies working
with the system, especially for the goals of numerical simulation.
Simulation of genotype dynamics
In order to account for genomic selection models in animal breeding we now
show some simulation results under the rule of genotype sum and controlled
mating. We continue using the −1, 0, 1 coding. In each example we begin
with a dam of genotype −1 (homozygous with allele to be eliminated), the
dam and her resulting progenies are then inseminated by a sequence of sires
of known genotypes. We choose the time points for the discretization with a
constant one year spacing, that is we set τ − τ = 1 (year), l = 0, 1, . . ., L.
l l−1
At the initial time τ it is also assumed that the distribution of alleles in the
0
12

replacement herd is the same as in the main one. This leads, as we see later,
to a two-year lag in switching dependence.
First, we consider the dynamics for unconditional switch of genotype into
state 1 (homozygous with allele to be introduced). We achieve the goal by
the sequence of sires, where all sires have genotype 1.
In Figure 1 we demonstrate two realizations of single trajectory in this
case. It is worth mentioning that every plot shows the dependence of gene
index in a particular, say the j-th, slot in the array of animals in the herd.
Then in Figures 1a,b only jumps can be definitely interpreted as animal
change, whereas horizontal lines could correspond, in principle, replacement
at any time step an animal by another one with the same genotype. We stress
that single trajectories ( Figure 1) and bundles of trajectories ( Figure 2)
for the transition of an SNP from one state into another may differ quite
markedly from the mean ( Figure 4(a)).
Figure 1: Two randomly chosen genotype trajectories. The depen-
dent variable is a genotype value at the fixed index slot of the array
of main herd, see in text for details.
Next, in Figure 2, we plot a bundle of 100 trajectories with jittering so
that the probability of each route may be inferred from the plot. The density
13

of lines allows visual estimation of the number of animals in particular states
-1,0,1.
Figure 2: Bundle of 100 genotype trajectories.
Finally, in Figure 3, we illustrate the effect when one of the sires has the
genotype −1 and again consider 100 individual trajectories. As one can see
from this plot, a single fault (using a sire with g = −1), can seriously slow
down the transition period. It needs to be pointed out that in Figures 2 and 3
the near vanishing of genotype -1 at the end of the simulation period does
not mean that it has been eliminated from the whole of the herd.
Now we turn to the statistical characteristics of ensembles of simulated
herds. In Figure 4 we show the temporal evolution of mean (a) and variance
(b) for the case of 1000 herds, each simulation starting from a “herd” of 200
14

Figure 3: Bundle of 50 genotype trajectories, one bull in sequence
(third one) with g = −1.
homozygous dams in the main herd (all initial genotypes are −1) and then
developing independently.
An important feature discovered in this simulation is that the herd size
evolves in time in direction of stabilization at a level which is less than what
was chosen as a upper bound in simulation. The appropriate plot for herd
size mean value is shown in Figure 5. It looks like some sort of “partial
extinction” and can be explained as follows. Any positive fluctuation in
number of female born at definite time step is cut by application of the rule
of the upper bound control policy of assumptions 1 and 2.
In contrast to this, rare strong negative fluctuations in number of females
15

Figure 4: Mean (left) and variance of mean (right) of genotype value
for 1000 herds, every main herd size is 200, replacement herd size
is 100 at initial time, λ = 0.114, λ = 0.25.
D d
born, which produce deficit of cows in the replacement herd seriously influ-
ence subsequent dynamics and lead to a period of slow herd size restoration.
Averaging over herds does not improve the results, as this would include
more and more rare but strong fluctuations.
As we see from the last plot, the dynamics of the replacement herd
strongly influence on those of the main herd. In accord with this, the pre-
sented results on main herd should be considered as demonstrating only ten-
dencies, because we did not seek to investigate the influence of replacement
herd management nor try to optimize it somehow.
As we have already mentioned the at first sight an unpleasant “extinction
effect” can be eliminated by animal inflow from the market in a way been
discussed above. But much more profitable seems to be the following point
of view, namely that “partial extinction” is a key ingredient in faster switch
to a given allele. In fact, the Poisson process constant λ for the main
D
herd is directly linked with “partial extinction” level as one can see from the
following plots in Figures 6, 7, 8, 9, 10 where we demonstrate the rate of the
16

Figure 5: The dependence of the mean main herd size upon time.
All parameters are the same as in Figure 4.
switch from a definite sign (it was chosen as −) of the allele into opposite
sign depended on values of λ . Values λ and colors sequence (red, cyan,
D D
green, blue, black) corresponds to probability equals 0.8 for a cow to live
in herd up to 4, 6, 8, 10, 12 years correspondingly, it was used averaging over
10000 herds in this simulations.
One of the interesting feature of the model is the sensitivity to a fine detail
of the transition of animal from replacement herd to a main one. We consider
two variants, in the first one we fill the main herd up to a limit size first from
the replacement herd, then make a random choice of a way for rest animals
in replacement hers to leave the herd. In the second variant, we make a
random choice of leave/rest and then specify the variant of leave (if success).
It turns out that at intermediate time these two slightly different procedure
17

0.5
2 4 6 8 10 12 14
-0.5
-1.0
Figure 6: Mean genotype value time evolution for 10000 herds,
every main herd size is 400, replacement herd size is 200 at initial
time. Colors sequence corresponds to different values of the mean
life constant in the main herd, see details in text.
give observably different behaviour, as demonstrated in Figure 11 for mean
values, variances Figure 12 and mean size of the main herd Figure 13. For
gene index dynamics both curves are very near, variances differ slightly but
the mean herd size is influence strongly by the control scheme. The last leads
to conclusion that it is necessary to be very accurate when formulating any
control scheme for such a dynamical system, schemes seems to be very near
at first glance could produce significantly different results.
Discussion
To summarize, we have constructed a system of stochastic differential equa-
tion that can model temporal evolution of biallelic polymorphism in a deme
under conditions of controlled mating. The model incorporates peculiarities
typical for New Zealand dairy herd management such as herd split into main
and replacement herds, typical lifetime distribution, size control for main
herd and rule of inflow from the replacement into main herd. Currently
the model is implemented in R but an open source C++ version is under
development [24].
18

1.0
0.8
0.6
0.4
0.2
2 4 6 8 10 12 14
Figure 7: Mean displayed allele frequency time evolution for 10000
herds, every main herd size is 400, replacement herd size is 200 at
initial time. Colors sequence corresponds to different values of the
mean life constant in the main herd, see details in text.
400
350
300
250
5 10 15
Figure 8: Mean main herd size time evolution for 10000 herds,
every main herd size is 400, replacement herd size is 200 at initial
time. Colors sequence corresponds to different values of the mean
life constant in the main herd, see details in text.
19

0.0014
0.0012
0.0010
0.0008
0.0006
0.0004
0.0002
2 4 6 8 10 12 14
Figure 9: Variance of mean (right) of genotype value evolution for
10000 herds, every main herd size is 400, replacement herd size is
200 at initial time. Colors sequence corresponds to different values
of the mean life constant in the main herd, see details in text.
0.0006
0.0005
0.0004
0.0003
0.0002
0.0001
2 4 6 8 10 12 14
Figure 10: Variance of the displaced allele frequency for 10000
herds, every main herd size is 400, replacement herd size is 200 at
initial time. Colors sequence corresponds to different values of the
mean life constant in the main herd, see details in text.
20

G
0.5
years
2 4 6 8 10
-0.5
-1.0
Figure 11: The comparison of the mean main herd gene index upon
time dependencies for two models. Thin red line is for model 1,
thick-blue line is for model 2. All parameters are the same as in
Figure 4.
Σ2
0.007
0.006
0.005
0.004
0.003
0.002
0.001
years
2 4 6 8 10
Figure 12: The comparison of the mean main herd gene index
variance upon time dependencies for two models. Thin red line is
for model 1, thick-blue line is for model 2. All parameters are the
same as in Figure 4.
21

N
200
150
100
50
years
2 4 6 8 10 12
Figure 13: The comparison of the mean main herd size upon time
dependencies for two models. Thin red line is for model 1, thick-
blue line is for model 2. All parameters are the same as in Figure 4.
Simulations have demonstrated that when a maximum herd size is im-
posed local fluctuations of new born animals will strongly influence the sys-
tem dynamics and lead to observable diminishing of the herd size (partial
extinction). To suppress this feature, which is not observed in real farm sit-
uations, the model has been further adjusted to allow for an external inflow
of animals from the market. Another important conclusion one can make is
that the investigation of replacement herd management policy could be of
great importance for reaching optimization goals.
Acknowledgments
Our thanks go to Jack Hooper of Livestock Improvement Corporation for
reading drafts of this article and for valuable comments on existing herd
management practice in New Zealand.
22

References
1. Hardy GH. Mendelian proportions in a mixed population. Science
1908; 28: 49–50.
¨
2. Weinberg W. Uber den nachweis der vererbung beim menschen. W
Jahreshefte des Vereins fu¨r vaterl¨andische Naturkunde in Wu¨rttemberg
1908; 64: 368–382.
3. Wright S. Evolution in Mendelian populations. Genetics 1931; 16:
97–159.
4. Fisher RA. The Genetical Theory of Natural Selection. Oxford:
Clarendon Press, 1931.
5. Feng S. Poisson-Dirichlet Distribution and Related Topics: Models and
asymptotic behaviors. Berlin Heidelberg: Springer-Verlag, 2010.
6. Donnelly P, Kurtz TG. Genealogical processes for Fleming-Viot models
with selection and recombination. Annals of Applied Probability 1991;
9: 1091–1148.
7. Kaj I, Krone SM. The coalescent process in a population with stochas-
tically varying size. Journal of Applied Probability 2003; 40: 33–48.
8. Steinsaltz D, Evans SN, Wachter KW. A generalized model of
mutation–selection balance with applications to aging. Advances in
Applied Mathematics 2005; 35: 16–33.
9. Moran PAP. Random processes in genetics. Mathematical Proceedings
of the Cambridge Philosophical Society 1958; 54: 60–71.
10. Feller W (1951) Diffusion processes in genetics. In Proc. Second Berke-
ley Symp. Math. Statist. Prob. 1951; 227–246.
11. Dawson DA. Stochastic population dynamics. Lec-
tures at Summer School in Probability, at PIMS-UBC.
http://www.math.ubc.ca/ db5d/SummerSchool09/LectureNotes.html
~
[20 July 2016]
23

12. Pfaffelhuber P, Pennings P, Hermisson J. Tutorial: Population
genetics. Mathematics and BioSciences Group, University of Vi-
enna. prefixhttp://www.mabs.at/teaching/files/popgen2009.pdf
[20 July 2016]
13. Draghi JA, Parsons TL, Plotkin JB. Epistasis increases the rate of
conditionally neutral substitution in an adapting population. Genetics
2011; 187: 1139–1152.
14. Harris B, Johnson D. Genomic predictions for New Zealand dairy bulls
and integration with national genetic evaluation. Journal of Dairy
Science 2010; 93: 1243–1252.
15. Grisart B, Farnir F, Karim L, Cambisano N, Kim JJ, et al. Genetic
and functional confirmation of the causality of the DGAT1 K232A
quantitative trait nucleotide in affecting milk yield and composition.
Proceedings of the National Academy of Sciences of the United States
of America 2004; 101: 2398–2403.
16. Allais-Bonnet A, Grohs C, Medugorac I, Krebs S, Djari A, et al. Novel
Insights into the Bovine Polled Phenotype and Horn Ontogenesis in
Bovidae. PLoS ONE 2013; 8: 63512.
17. Morris AP, Zeggini E. An evaluation of statistical approaches to rare
variant analysis in genetic association studies. Genetic epidemiology
2010; 34: 188–193.
18. Øksendal BK, Sulem A. Applied stochastic control of jump diffusions,
vol. 498. Springer, 2005.
19. Applebaum D. L´evy processes and stochastic calculus. Cambridge uni-
versity press, 2009.
20. Gardiner CW. Handbook of stochastic methods: for Physics, Chemistry
and the Natural Sciences. Springer, 2004.
21. Smith M. Evolution and the Theory of Games. Cambridge University
Press, Cambridge, 1982.
22. Yanovich AEPSL Functional Integrals: Approximate Evaluation and
Applications. Springer, 1993.
24

23. Zherelo A. On convergence of the method based on approximately ex-
act formulas for functional polynomials for calculation of expectations
of functionals to solutions of stochastic differential equations. Monte
Carlo Methods and Applications 2013; 19: 183–200.
24. Soudlenkov G. SingleGeneControlled: Single
gene dynamics under controlled mating simulation.
https://github.com/genie68/SingleGeneControlled/[20 July
2016]
25

Table 1: Hardy-Weinberg Conditions and the New Zealand Dairy
Herd
Ideal Population Production industry
Large homogeneous population Heterogeneous Herds and Regions
Random mating Controlled mating
No mutation Mutations happen
No selection Selection exists
No migration Export/import of genes
26