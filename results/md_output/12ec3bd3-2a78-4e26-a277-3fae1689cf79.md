daru ‑ Data Analysis in RUby
Introduction
daru (Data Analysis in RUby) is a library for storage, analysis, manipulation and visualization of data
in Ruby.
daru makes it easy and intuitive to process data predominantly through 2 data structures: Daru
::DataFrame and Daru::Vector. Written in pure Ruby works with all ruby implementations.
Tested with MRI 2.5.1 and 2.7.1.
daru plugin gems
• daru‑view
daru‑view is for easy and interactive plotting in web application & IRuby notebook. It can work in any
Ruby web application frameworks like Rails, Sinatra, Nanoc and hopefully in others too.
Articles/Blogs, that summarize powerful features of daru‑view:
• GSoC 2017 daru‑view
• GSoC 2018 Progress Report
• HighCharts Official blog post regarding daru‑view
• daru‑io
This gem extends support for many Import and Export methods of Daru::DataFrame. This gem
is intended to help Rubyists who are into Data Analysis or Web Development, by serving as a general
purpose conversion library that takes input in one format (say, JSON) and converts it another format
(say,Avro)whilealsomakingitincrediblyeasytogettingstartedonanalyzingdatawithdaru. Onecan
read more in SciRuby/blog/daru‑io.
Features
• Data structures:
– Vector ‑ A basic 1‑D vector.
1

– DataFrame ‑ A 2‑D spreadsheet‑like structure for manipulating and storing data sets. This
is daru’s primary data structure.
• Compatible with IRuby notebook, statsample, statsample‑glm and statsample‑timeseries.
• Support for time series.
• Singly and hierarchically indexed data structures.
• Flexible and intuitive API for manipulation and analysis of data.
• Easy plotting, statistics and arithmetic.
• Plentiful iterators.
• Optional speed and space optimization on MRI with NMatrix and GSL.
• Easy splitting, aggregation and grouping of data.
• Quickly reducing data with pivot tables for quick data summary.
• ImportandexportdatafromandtoExcel,CSV,SQLDatabases,ActiveRecordandplaintextfiles.
Installation
1 $ gem install daru
Notebooks
Notebooks on most use cases
• Overview of most daru functions
• Basic Creation of Vectors and DataFrame
• Detailed Usage of Daru::Vector
• Detailed Usage of Daru::DataFrame
• Searching and combining data in daru
• Grouping, Splitting and Pivoting Data
• Usage of Categorical Data
Visualization
• Visualizing Data With Daru::DataFrame
• Plotting using Nyaplot
• Plotting using GnuplotRB
• Vector plotting with Gruff
• DataFrame plotting with Gruff
2

Notebooks on Time series
• Basic Time Series
• Time Series Analysis and Plotting
Notebooks on Indexing
• Indexing in Vector
• Indexing in DataFrame
Case Studies
• Logistic Regression Analysis with daru and statsample‑glm
• Finding and Plotting most heard artists from a Last.fm dataset
• Analyzing baby names with daru
• Example usage of Categorical Data
• Example usage of Categorical Index
Blog Posts
• Data Analysis in RUby: Basic data manipulation and plotting
• Data Analysis in RUby: Splitting, sorting, aggregating data and data types
• Finding and Combining data in daru
• Introduction to analyzing datasets with daru library
Time series
• Analysis of Time Series in daru
• Date Offsets in Daru
Categorical Data
• Categorical Index
• Categorical Data
• Visualization with Categorical Data
3

Basic Usage
daru exposes two major data structures: DataFrame and Vector. The Vector is a basic 1‑D struc‑
ture corresponding to a labelled Array, while the DataFrame ‑ daru’s primary data structure ‑ is 2‑D
spreadsheet‑like structure for manipulating and storing data sets.
Basic DataFrame intitialization.
1 data_frame = Daru::DataFrame.new(
2 {
3 'Beer' => ['Kingfisher', 'Snow', 'Bud Light', 'Tiger Beer', '
Budweiser'],
4 'Gallons sold' => [500, 400, 450, 200, 250]
5 },
6 index: ['India', 'China', 'USA', 'Malaysia', 'Canada']
7 )
8 data_frame
Load data from CSV files.
1 df = Daru::DataFrame.from_csv('TradeoffData.csv')
4

| 1 data_frame = Daru::DataFrame.new(                             |
|:----------------------------------------------------------------|
| 2 {                                                             |
| 3 'Beer' => ['Kingfisher', 'Snow', 'Bud Light', 'Tiger Beer', ' |
| Budweiser'],                                                    |
| 4 'Gallons sold' => [500, 400, 450, 200, 250]                   |
| 5 },                                                            |
| 6 index: ['India', 'China', 'USA', 'Malaysia', 'Canada']        |
| 7 )                                                             |
| 8 data_frame                                                    |

Basic Data Manipulation
Selecting rows.
1 data_frame.row['USA']
Selecting columns.
1 data_frame['Beer']
5

A range of rows.
1 data_frame.row['India'..'USA']
The first 2 rows.
1 data_frame.first(2)
6

The last 2 rows.
1 data_frame.last(2)
Adding a new column.
1 data_frame['Gallons produced'] = [550, 500, 600, 210, 240]
7

Creating a new column based on data in other columns.
1 data_frame['Demand supply gap'] = data_frame['Gallons produced'] -
data_frame['Gallons sold']
Condition based selection
Selecting countries based on the number of gallons sold in each. We use a syntax similar to that de‑
fined by Arel, i.e. by using the where clause.
1 data_frame.where(data_frame['Gallons sold'].lt(300))
8

| 1 data_frame['Demand supply gap'] = data_frame['Gallons produced'] -   |
|:-----------------------------------------------------------------------|
| data_frame['Gallons sold']                                             |

Youcanpassacombinationofbooleanoperationsintothe#wheremethodanditshouldworkfine:
1 data_frame.where(
2 data_frame['Beer']
3 .in(['Snow', 'Kingfisher','Tiger Beer'])
4 .and(
5 data_frame['Gallons produced'].gt(520).or(data_frame['Gallons
produced'].lt(250))
6 )
7 )
Plotting
Darusupportsplottingofinteractivegraphswithnyaplot. Youcaneasilycreateaplotwiththe#plot
method. Here we plot the gallons sold on the Y axis and name of the brand on the X axis in a bar
graph.
1 data_frame.plot type: :bar, x: 'Beer', y: 'Gallons sold' do |plot,
diagram|
2 plot.x_label "Beer"
3 plot.y_label "Gallons Sold"
4 plot.yrange [0,600]
5 plot.width 500
6 plot.height 400
7 end
9

| 1 data_frame.where(                                             |
|:----------------------------------------------------------------|
| 2 data_frame['Beer']                                            |
| 3 .in(['Snow', 'Kingfisher','Tiger Beer'])                      |
| 4 .and(                                                         |
| 5 data_frame['Gallons produced'].gt(520).or(data_frame['Gallons |
| produced'].lt(250))                                             |
| 6 )                                                             |
| 7 )                                                             |

| 1 data_frame.plot type: :bar, x: 'Beer', y: 'Gallons sold' do |plot,   |
|:-----------------------------------------------------------------------|
| diagram|                                                               |
| 2 plot.x_label "Beer"                                                  |
| 3 plot.y_label "Gallons Sold"                                          |
| 4 plot.yrange [0,600]                                                  |
| 5 plot.width 500                                                       |
| 6 plot.height 400                                                      |
| 7 end                                                                  |

In addition to nyaplot, daru also supports plotting out of the box with gnuplotrb.
Documentation
Docs can be found here.
Contributing
Pick a feature from the Roadmap or the issue tracker or think of your own and send me a Pull Re‑
quest!
For details see CONTRIBUTING.
10

Acknowledgements
• Google and the Ruby Science Foundation for the Google Summer of Code 2016 grant for
speed enhancements and implementation of support for categorical data. Special thanks to
@lokeshh, @zverok and @agisga for their efforts.
• GoogleandtheRubyScienceFoundationfortheGoogleSummerofCode2015grantforfurther
developing daru and integrating it with other ruby gems.
• Thank you last.fm for making user data accessible to the public.
Copyright (c) 2015, Sameer Deshmukh All rights reserved
11