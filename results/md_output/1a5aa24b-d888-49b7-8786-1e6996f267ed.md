1
A Note on a Sum of Lognormals
By N B Chakrabarti,
ECE Dept., IIT Kharagpur, Kharagpur, India.
6102 ceD 32  ]OC.tats[  2v00370.6061:viXra
Abstract
This note considers the applicability of Gauss-Hermite quadrature and direct numerical quadrature
for computation of moment generating function (mgf) and the derivatives. A preprocessing using the
asymptotic technique is employed while computing the characteristic function (chf) using Gauss Hermite
quadrature while this is optional for mgf. The mgf of the low and high amplitude regions of a single
lognormal variable and the derivatives is examined and attention is drawn to the effect of variance.
The problem of inversion of the mgf/chf of a sum of lognormals to obtain the CDF/pdf is considered
with special reference to methods related to Post Widder technique, Gaussian quadrature and the Fourier
series method. The method based on the complex exponential integral which makes use of the derivative
of the cumulant or non-harmonic Fourier series is an alternative. Segmentation of the mgf/chf on the
basis of the derivative structure which indicates activity rate is shown to be useful.
Index Terms
lognormal distribution, characteristic function, moment generating function, cumulative distribu-
tion function, Gauss-Hermite quadrature, inverse Laplace Transform, Post-Widder technique, Gaussian
quadrature, Fourier series method, Gil-Pelaez formula, complex exponential integral
I. INTRODUCTION
The behavior of a sum of lognormals has been extensively studied [1-10]. The Fenton-
Williamson (FW) technique of representing the distribution of the sum in terms of an equivalent
lognormal remains a powerful tool. It is known that moderation of moment values by truncation
enhances the range of applicability of the FW method. An alternative of finding the mgf/chf
of the independent lognormals together with other relevant distributions to compute the product
mgf/chf and then finding the inverse has also been studied [8,9]. The present work is concerned
with this approach.

2
A random positive variable x is log-normally distributed if the logarithm of x is normally
distributed. Its probability density function (pdf) and cumulative distribution function (CDF)
are:
2
1 (lnx µ)
p(x) = exp − (1)
xσ√2π − 2σ2
  !
and
1 1 ln x µ
F(x) = + erf − (2)
2 2 √2σ
(cid:20) (cid:21)
It is easy to verify that ln(p(x)) is quadratic in log(x); this is used to test lognormality. The fact
that p(x)dx equals p(y)dy where y = 1 is the basis of reduced range integration. In the text,
− x
the parameter µ is suppressed and is restored in the final step.
II. COMPUTATION OF MOMENT GENERATING FUNCTION
The moment generating function M(s) of a lognormal random variable and its derivatives can
be found using Gauss Hermite quadrature. For even length
N
M(s) = w exp s exp √2σx (3)
k k
− ·
k=−N
X (cid:16) (cid:16) (cid:17)(cid:17)
where x are the abscissas and w are the weights. The transform variable s will be assumed
k k
to be real except when otherwise specified.
One may express M(s) as a sum of contributions M (s) and M (s) from the regions where
1 2
0 x 1 and x 1 respectively, i.e.,
≤ ≤ ≥
N
M (s) = w exp s exp √2σx (4)
1 k k
− · −
Xk=1
(cid:16) (cid:16) (cid:17)(cid:17)
N
and M (s) = w exp s exp √ 2σx (5)
2 k k
− ·
k=1
X (cid:16) (cid:16) (cid:17)(cid:17)
These are equal at s = 0 and comparable in magnitude at very low frequencies. Both M and
1
M decrease with s, M faster than M . The n-th derivative of M(s) is
2 2 1
N
M (s) = ( 1)n w exp n√2x exp s exp √2σx (6)
n k k k
− − ·
k=−N
X (cid:16) (cid:17) (cid:16) (cid:16) (cid:17)(cid:17)
Equation (6) shows that the equivalent weights w exp(n√2x ) for derivatives are smaller for
k k
M (s). The contributions from negative x , i.e., x lying within the region from zero to unity, is
1 k
therefore initially small but the decay with s is slow.

3
Holgate [6] used an asymptotic technique to derive the closed form expression for chf ϕ(jω)
as
1 z2 2z
ϕ(jω) = exp − (7)
√1 z − 2σ2
(cid:18) (cid:19)
−
The parameter z satisfies the Lambert W equation z exp( z) = jωσ2 [9,10].
−
Equation (7) is known to be applicable at high frequency and small value of variance. The
saddle point method enables one to compress the frequency scale by a transformation so that
z is restricted to lie in the second quadrant. The applicability of this method can be improved
z2−2z
if one expresses the chf as a product of H(z) = exp and a term G(z) derived by
2σ2
−
integrating the residual employing Gauss-Hermite quadr(cid:16)ature. (cid:17)
An expression for M(s) based on the asymptotic technique and Gauss Hermite quadrature
may be written as
(W2 + 2W) W
M(s) = exp w exp exp √2σx √2σx 1 (8)
k k k
− 2σ2 −σ2 − −
(cid:18) (cid:19) k (cid:18) (cid:19)
X (cid:16) (cid:16) (cid:17) (cid:17)
where W satisfies the Lambertw equation, viz., W exp(W) = sσ2. An equivalent form is
W2 Wg(x, σ)
M(s) = exp w exp (9)
k
−2σ2 − σ2
(cid:18) (cid:19) k (cid:18) (cid:19)
X
where g(x, σ) = exp √2σx √2σx.
−
An examination of Equations (3) and (8) is instructive. For practical applications the number of
(cid:0) (cid:1)
terms necessary does not usually exceed twenty. When the frequency is high, one would require
still fewer terms. W is almost linear with s at small s. One can replace the exponent in the
RHS of (9) by (1 (1 exp( s)))g(x,σ) . M(s) can then be written as exp ( W2)P (s), where
1
− − − −
P (s) is a polynomial in s. For high frequencies on the other hand, W varies logarithmically
1
2
and one obtains an approximation M (s) exp ln (s) P 1 , where P 1 is a polynomial in
h − 2σ2 h s h s
1. These point to the applicability of Pade ap(cid:16)proxima(cid:17)tion.
(cid:0) (cid:1) (cid:0) (cid:1)
s
MGF and its derivatives can also be computed using simple quadrature in the reduced range
of x from zero to unity. These can be written as:
1
s
M(s) = p(x) exp ( sx) + exp dx (10)
− −x
Z
0 (cid:16) (cid:16) (cid:17)(cid:17)
1
dkM(s) 1 k s
k k
= ( 1) p(x) x exp ( sx) + exp dx (11)
dsk − − x −x
  !
Z (cid:18) (cid:19)
0 (cid:16) (cid:17)

4
Lognormal mgf with variance
1
M(s);σ = 0.5
0.9
M(s);σ = 1
M(s);σ = 2
0.8
M(s);σ = 3
0.7 M (s);σ = 2
1
M (s);σ = 2
2
0.6
fgm
0.5
M s
( )
0.4 1
0.3
0.2
M s
( )
2
0.1
0
0 0.2 0.4 0.6 0.8 1 1.2 1.4 1.6 1.8 2
s
Fig. 1. Moment generating function for a set of variances. Relative contributions from M and M are also indicated.
1 2
It is evident from Equation (10) that for zero mean lognormal, inverse moments are equal to the
positive moments.
If the variance is large, M(s) decreases fast at low frequencies and has a knee like appearance.
This results in the crossing of the mgfs of different variances typically close to s = 0.6 as shown
in Figure 1. This signifies that moment or cumulant matching techniques must avoid regions
close to where mgf corresponding to a sum of lognormals may not possess uniqueness. One
notices that the mgf of a sum of lognormals has a wide variety of descent patterns depending
on the distribution of the variances. The variety becomes wider when Rice/Suzuki and other
distributions are also associated.
Figure 2 shows the variation of real and imaginary parts of the chf for different variances.
Here again crossings occur for the real and imaginary parts but at different locations. The spread
is wider compared to that of mgf.
The derivatives of the mgf convey a wealth of useful information. The values of the derivatives
are known to be large at s = 0; they give the moments. These decrease fast with s becoming
negligible beyond s = 2. Figure 3 shows the variation of the first four derivatives with s. It is
often assumed that the estimate of equivalent lognormal may be improved by using derivatives
higher than two but one must note that these lose their dominance as the frequency increases.

|     |    |    |    |    |    |    |    |    |    |    |    |    |    | M   | (   | s);   | σ=   | 0.   | 5   |    |
|     |    |    |    |    |    |    |    |    |    |    |    |    |    | M   | (   | s);   | σ=   | 1    |     |    |
|     |    |    |    |    |    |    |    |    |    |    |    |    |    | M   | (   | s);   | σ=   | 2    |     |    |
|     |    |    |    |    |    |    |    |    |    |    |    |    |    | M   | (   | s);   | σ=   | 3    |     |    |
|:----|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|:----|:----|:------|:-----|:-----|:----|:---|
|     |    |    |    |    |    |    |    |    |    |    |    |    |    | M   | (   | s);   | σ=   | 2    |     |    |
|     |    |    |    |    |    |    |    |    |    |    |    |    |    | M   | 1   | s     | σ    |      |     |    |
|     |    |    |    |    |    |    |    |    |    |    |    |    |    |     | (   | );    | =    | 2    |     |    |
|     |    |    |    |    |    |    |    |    |    |    |    |    |    |     | 2   |       |      |      |     |    |
| M   | (  | s) |    |    |    |    |    |    |    |    |    |    |    |     |     |       |      |      |     |    |
|     | 1  |    |    |    |    |    |    |    |    |    |    |    |    |     |     |       |      |      |     |    |
| M ( | s) |    |    |    |    |    |    |    |    |    |    |    |    |     |     |       |      |      |     |    |
| 2   |    |    |    |    |    |    |    |    |    |    |    |    |    |     |     |       |      |      |     |    |

5
1
σ = 1
fhcfostrapyranigamIdnalaeRfgmfosevitaviredfoiludoM
0.8 σ = 2
σ = 3
0.6
0.4
0.2
0
-0.2
0 1 2 3 4 5 6 7 8 9 10
ω
Fig. 2. Real and imaginary parts of chf for a set of variances.
σ
Lognormal mgf derivatives for = 2.
4
10
First
3
10 Second
Third
2
10
Fourth
1
10
0
10
-1
10
-2
10
-3
10
-4
10
1 2 3 4 5 6 7 8 9 10
s
Fig. 3. Variation of first four derivatives w.r.t. frequency (s) for lognormal mgf.
(W2 +2W)
In fact if one considers only the term exp , the inverse of the equivalent variance
2σ2
−
(cid:18) (cid:19)
equals the sum of the inverses of individual variances.
An analytical expression for mgf at very high frequencies has been obtained by Barouch and

|    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    | None   |    |    |
|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|:-------|:---|:---|
|    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |        |    |    |
|    |    |    |    |    |    |    |    |    |    |    |    |    |    |    | σ  | =  | 1  |        |    |    |
|    |    |    |    |    |    |    |    |    |    |    |    |    |    |    | σ  |    |    |        |    |    |
|    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    | =  | 2  |        |    |    |
|    |    |    |    |    |    |    |    |    |    |    |    |    |    |    | σ  | =  | 3  |        |    |    |
|    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |        |    |    |
|    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |        |    |    |
|    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |        |    |    |
|    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |        |    |    |
|    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |        |    |    |
|    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |        |    |    |
|    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |        |    |    |
|    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |        |    |    |
|    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |        |    |    |
|    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |        |    |    |
|    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |        |    |    |
|    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |        |    |    |
|    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |        |    |    |
|    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |        |    |    |
|    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |        |    |    |
|    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |        |    |    |
|    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |        |    |    |
|    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |        |    |    |
|    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |        |    |    |

|    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    | F   | irs   | t     |    |    |
|    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    | S   | ec    | ond   |    |    |
|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|:----|:------|:------|:---|:---|
|    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    | T   | hi    | rd    |    |    |
|    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    | F   | ou    | rth   |    |    |

6
Kaufman [5]. Letting z = sx, the integral for M(s) becomes
∞ 2 2
1 1 ln s ln z
lns
M(s) = z σ2 exp z dz (12)
√2πσ z − − 2σ2 − 2σ2
Z0 (cid:18) (cid:19)
Ignoring correction terms for simplicity, the integral may be approximated by
2
1 ln s ln s
M(s) = exp Γ (13)
√2πσ − 2σ2 σ2
(cid:18) (cid:19) (cid:18) (cid:19)
The derivative of order n may be obtained approximately by augmenting the argument of the
Gamma function by n and dividing the result by ( s)n.
−
A study of the derivative enables one to understand why some techniques for estimating the
behavior of lognormal work best in some regions. A knowledge of derivatives is useful in con-
trolling the sampling rate in the regions where M(s) varies fast. An immediate application is to
improve the accuracy of inversion by incorporating interpolation in regions where derivatives are
large. For a sum of lognormals, the first derivative is not hard to calculate; one merely multiplies
the mgf by the sum of logarithmic derivatives of individual lognormals. Numerical differentiation
is also an alternative. The fact that the derivatives at low frequencies are dominated by large x
region of pdf while those at high frequencies are contributed by the small x region indicates
that components on two sides of the median can be separated by high order differentiation or
differencing as in Post-Widder formula . The behavior of a lognormal sum depends as is well
known on the distribution of variances. When the combination of large variance components
has amplitude lower than that of the combination of low variance components, the sum has
a uniformly decaying character. In a situation where the mgf of low variance components is
comparable to or lower than the mgf of the large variance components in a significant part of
the spectrum, a variety of patterns emerges.
III. INVERSION METHODS FOR DERIVING CDF, PDF AND DERIVATIVE
Once the mgf/chf of the individual components has been found, an important task is the
computation of the CDF and pdf corresponding to the mgf/chf of the product.
In many applications, a knowledge of CDF is the primary objective. This is found by in-
tegrating the contributions from the entire frequency domain. One is often interested in the
information about lower tail, the upper tail and the region close to the median. In such cases
the computational load can be considerably reduced. Techniques of inversion which yield both

7
CDF and pdf find application in the estimation of median starting from the value obtained from
FW’s technique.
Laplace transforms Inversion Methods: A large number of methods for numerically inverting
Laplace transforms have been developed [12, 13]. These may be classified according as they
employ real and complex arithmetic derived respectively from the Post Widder technique and
Bromwich contour integral. The survey of Brian and Martin [12] groups them as: (a) methods
which compute a sample, (b) methods which expand in exponential functions, (c) Gaussian
numerical quadrature, (d) representation as Fourier series based on the Poisson summation
formula and (e) Pade approximation. The Talbot technique based on deforming the contour
deserves mention. Widder in his book [11] states an asymptotic formula for the inverse
k+1
k 1 k
k k
f(x) = ( 1) M (14)
− x k! x
(cid:18) (cid:19) (cid:18) (cid:19)
where Mk is the k-th derivative of the input transform M(s) at s = k. This formula is
x
known to converge slowly. Der Haar [12] has shown that in some cases the simple formula
1M 1 gives reasonable answers. This and the variant 1 M 1 are single point formulas.Better
x x 2x 2x
approximations are provided by the formulas using derivatives; while these are not accurate,
(cid:0) (cid:1) (cid:0) (cid:1)
they serve as indicators of expected comparisons.In many cases the expression based on the
first derivative proves useful. Post-Widder formula is remarkable in establishing direct relation
between M(s) and f(x). Davies and Martin [12] point out a relation between Post Widder and
a delta-convergent sequence.
A. Gaver and Gaussian Quadrature:
Gaver [14] developed a family of three parameter functions
(n + m)!
n
f(n, m, a) = (1 exp(aµ)) exp (maµ) (15)
n!(m 1)! −
−
where m and n are integers and the parameter a is inversely proportional to x. Gaver-Stehfest
inversion technique originated from this formula based on the difference operator in the special
case where m = n. This may be written as
a na
f(x) = K M (16)
n
x x
X (cid:16) (cid:17)
where a = ln 2 and K are the coefficients and the summation is carried out over N terms.
n
A similar relation was derived by Zakian [16] where a = 2. It was shown that the condition

8
required for finding CDF is satisfied. Gaussian numerical quadrature of the inversion integral has
yielded a large class of methods using orthogonal polynomials which give approximate formula
for inversion which is exact when M(s) is a linear combination of inverse powers of s up to an
order 2(N 1) (Piessens, [15]). Many variants of the Gaussian quadrature technique have been
−
developed [12,13], and nodes and weights for computing the inverse tabulated. The inversion
integral is first written as
1 z
f(x) = M exp(z)dz (17)
2πjx x
Z
(cid:16) (cid:17)
The integral is approximated by a sum.
1 a
n
f(x) = K M (18)
n
x x
X (cid:16) (cid:17)
and the coefficients are computed. The roots a are complex and so are the coefficients.
n
A simple way to obtain a is to replace the exponential function (i.e. exp(z)) by the Pade
n
approximation [12] and find the roots of the denominator polynomial. CDF is obtainable as
K a
n n
F(x) = M (19)
a x
n
X (cid:16) (cid:17)
The k-th derivative is given by
1 a k a
n n
P (x) = K M (20)
k n
x x x
X (cid:16) (cid:17) (cid:16) (cid:17)
B. Fourier Series Method:
The Fourier series method is popular in statistical literature. The simpler Fourier inversion
form uses either the cosine transform or the sine transform, where the cosine transform is given
by
2 cx c + jπk πkx
f (x) = exp cos (21)
c
L L ℜ L L
k (cid:18) (cid:19) (cid:18) (cid:19)
(cid:16) (cid:17)X
and the sine transform is given by
2 cx c + jπk πkx
f (x) = exp sin (22)
s
−L L ℑ L L
k (cid:18) (cid:19) (cid:18) (cid:19)
(cid:16) (cid:17)X
respectively, where c defines the contour and L is the length. An equally weighted sum is known
to achieve better accuracy.

9
2.5
tnalumucfostrapyranigamIdnalaeR
2 Imaginary part
1.5
1
0.5
σ = 3
0 σ = 2
σ = 1
-0.5 Real part
-1
-1.5
-2
0 0.5 1 1.5 2 2.5 3 3.5 4 4.5 5
ω
Fig. 4. Cumulants of a chf of lognormal for a set of variances.
The corresponding expression for CDF due to Gil-Pelaez [17,18,19] in terms of the chf ϕ(jω)
is
∞
1 1 dω
F(x) = [exp ( jωx) ϕ(jω) exp (jωx) ϕ( jω)] (23)
2 − π − − − ω
Z
0
When the cumulants and are known this may be written as
1 2
X X
∞
1 1 sin ( ωx)
2
F(x) = exp ( ) X − dω (24)
1
2 − π X ω
Z
0
Figure 4 shows the variation of cumulants with frequency (ω) for three values of the variances.
The envelopes are found to cross near ω = 2. Davies [18] presented a numerical technique for
implementing the Gil-Pelaez formula for evaluating CDF as
N d
1 1 d exp j k + x
F(x) = ϕ k + − 2 (25)
2 − 2 ℑ 2 π k + d
k=0 ( (cid:18) (cid:19) (cid:0) (cid:0) 2 (cid:1) (cid:1))
X
where d is the grid spacing. (cid:0) (cid:1)
C. Complex exponential integral:
It is noticed from Figure 4 that the cumulant has a smooth characteristic except near the origin.
A knowledge of the first derivatives of , enables the use of the complex exponential integral
1 2
X X

|    |    |    |     |     |    |    |    |    |    |    |    |      |    |    |    |    |    |    |    | None   |
|:---|:---|:---|:----|:----|:---|:---|:---|:---|:---|:---|:---|:-----|:---|:---|:---|:---|:---|:---|:---|:-------|
|    | I  | ma | gin | ary | pa | rt |    |    |    |    |    |      |    |    |    |    |    |    |    |        |
|    |    |    |     |     |    |    |    |    |    |    |    |      |    |    |    |    |    |    |    |        |
|    |    |    |     |     |    |    |    |    |    |    |    |      |    |    |    |    |    |    |    |        |
|    |    |    |     |     |    |    |    |    |    |    |    |      |    |    |    |    |    |    |    |        |
|    |    |    |     |     |    |    |    |    |    |    |    |      |    |    |    |    |    |    |    |        |
|    |    |    |     |     |    |    |    |    |    |    |    |      |    |    |    |    |    |    |    |        |
|    |    |    |     |     |    |    |    |    |    |    |    |      |    |    |    |    |    |    |    |        |
|    |    |    |     |     |    |    |    |    |    |    |    |      |    |    |    |    |    |    | 3  |        |
|    |    |    |     |     |    |    |    |    |    |    |    |      |    |    |    |    | σ  | =  | 3  |        |
|    |    |    |     |     |    |    |    |    |    |    |    |      |    |    |    |    | σ  |    |    |        |
|    |    |    |     |     |    |    |    |    |    |    |    |      |    |    |    |    | σ  | =  | 2  |        |
|    |    |    |     |     |    |    |    |    |    |    |    |      |    |    |    |    |    | =  | 1  |        |
|    |    |    |     |     |    |    |    |    |    | R  | ea | l pa | rt |    |    |    |    |    |    |        |
|    |    |    |     |     |    |    |    |    |    |    |    |      |    |    |    |    |    |    |    |        |
|    |    |    |     |     |    |    |    |    |    |    |    |      |    |    |    |    |    |    |    |        |
|    |    |    |     |     |    |    |    |    |    |    |    |      |    |    |    |    |    |    |    |        |
|    |    |    |     |     |    |    |    |    |    |    |    |      |    |    |    |    |    |    |    |        |
|    |    |    |     |     |    |    |    |    |    |    |    |      |    |    |    |    |    |    |    |        |

10
[21,22] to compute the contributions to the CDF from different sub-intervals. For the purpose it
is necessary to examine the nature of variation of the real and imaginary parts of the cumulant
with frequency. The real part ( ) varies very slowly at low frequencies and the derivative is
1
X
consequently very small. The derivative has a peak at about ω = 0.01 for a lognormal of variance
2 and decreases monotonically thereafter. The derivative of the imaginary part has a large value
at low frequencies and also decreases monotonically. The derivative of the real part is smaller
in magnitude than that of the imaginary part at low frequencies and the role is reversed at high
frequencies.
The complex exponential integral [21,22] is written as
∞
exp( t)
E
(z) = − dt (26)
1
t
z
Z
Three relevant integrals are [21,22]
1 e−at
sin bt b
tan−1 E
dt = + (a + jb) (27)
1
t a ℑ
0
Z
1 eat sin bt b
tan−1 E
dt = + (a + jb) + π (28)
1
t − a ℑ
0
Z
1 e−at(1 cosbt) 1 b2
E E
− dt = log 1 + (a) + (a + jb) (29)
1 1
t 2 a2 − ℜ ℜ
Z0 (cid:18) (cid:19)
When the cumulant has linear variation with an attenuation constant ‘a’ and group delay ‘b’ in
the interval of interest, the exponent of the integral ϕ (jω)exp( jωx)/ω may be written as
−
+ j aω + j(b x)ω where and are the components of the cumulant at the lower
1 2 1 2
X X − − X X
end. In the interval of ω from zero to unity, the integral is given by [21,22]
b x
J = arctan − + E (a + j(b x)) (30)
1 1
a ℑ −
(cid:18) (cid:19)
as is 0 at the origin. At the high frequency end, the amplitude is small in the stretch extending
X
from ω to infinity, the integral is
m
J = exp( )E (ω (a + j(b x))) (31)
m m 1 m m m
X −
In the piecewise sum approach one sums the contributions from the different segments.To
derive the value of the integral from ω to ω , one subtracts the contribution from the ranges
1 2
ω to infinity and ω to infinity with the appropriate values of the (a, b) parameters. One can
1 2

11
include the effect of the second derivative partially by expressing the difference as a short length
Fourier series, i.e,
πkω
exp ( (ω) + aω jbω) = 1 + c sin (32)
1 k
X − L
(cid:18) (cid:19)
X
where L is the length of the segment. The resulting expression can be written as a sum of
complex exponentials.
A substitution of the first term of the R.H.S of equation (30) in equation (24) gives
1 1 b x
F (x) = arctan − (33)
0
2 − π a
(cid:18) (cid:19)
The value at x = 0 is different from the desired value of zero. On the other hand if one uses
the relation for CDF based on the real part one obtains the integral
sin(ωx)
exp( aω) cos(bω) dw
− ω
Z
which gives
1 b + x 1 b x
F (x) = arctan arctan − (34)
0
π a − π a
(cid:18) (cid:19) (cid:18) (cid:19)
The result is independent of the polarity of b. Combining the arctan terms one obtains
1 2ax
F (x) = arctan (35)
0
π a2 + b2 x2
(cid:18) − (cid:19)
This shows that at low amplitudes F (x) is linear. The median corresponding to F (x) = 0.5 is
0 0
given by √a2 + b2. The pdf corresponding to (34) is 1 a + a . This has finite
π a2 +(b+x)2 a2 +(b−x)2
value at x close to zero. This indicates that weighting aht small values of a anid b is necessary.
This conclusion also follows from an examination of RHS of equation (24).
As an alternative to the piecewise sum which requires a precise knowledge of the local
derivatives, one may express the chf as a sum of complex exponentials
ϕ(jω) = A exp( a ω + jb ω) (36)
k k k
−
X
where A is the amplitude of the k-th component. The CDF is then expressed as
k
1 b + x b x
k k
F(x) = A arctan arctan − (37)
k
π a − a
k k
(cid:18) (cid:18) (cid:19) (cid:18) (cid:19)(cid:19)
X
As mentioned earlier the absolute and relative values of a and b depend on the frequency
k k
regions concerned. Specifically small a occurs at very low frequencies for a short while and
k
both a and b are small at very low frequencies. The CDF F (x) rises fast if a is small and
k k 0 k

12
slowly for large a and b is a shift parameter. There is a one to one correspondence between
k k
the frequency and the a, b parameters.
A remark on exponential sum representation is relevant. There are methods of Laplace trans-
form inversion which assumes the result can be expanded as a sum of exponential functions
[12,13]. The Carathe`odory representation has a form
c = ρ exp(jπθ k), (38)
k m m
m
X
where 1 < θ 1 and ρ > 0. This yields on inversion a sum of step functions. Complex
m j
− ≤
exponential sum is widely used in spectral analysis and other applications [23]. A common
technique is to employ SVD on the frequency data and find roots of an eigen polynomial derived
from it and then find the weights. This technique is not directly applicable because some roots
give positive real part of the logarithm and the weights have complex values. These are not
appropriate for the present application because the integrals that apply are then as in equation
(28) and equation (29).
In the present work, the basis of selection of the density of nodes is the values of the derivatives
of the real and imaginary parts of the cumulant. As noted earlier the square root of a2 + b2
yields the median of the individual arctangent graph. A choice of node interval proportional
to the inverse of the local median seems appropriate. When a and b are both very small, the
rise occurring at small x is fast. The values of x for F (x) = 0.1 and F (x) = 0.9 can be
0 0
found from the arctan expression. The above remarks provide general guidelines but one must
compare the values of the cumulant of chf computed from the expression for the exponential
sum, insert/delete nodes and use weighting as necessary to correct the error using non-linear
least square technique.
Fairly accurate results are obtained even for an equally weighted sum if the contributions
from very low, low, medium and high frequencies are included. It is noticed that each term
in equation (37) has the appearance of a CDF increasing monotonically from zero to unity.
Figure 5 compares a result with the theoretical CDF. It is necessary in applications of complex
exponential integral to verify that the frequency behaviour of the sum is close to that of CHF.
The first two derivatives can be used for computing the pdf of a lognormal. If a and b
2 2
are the second derivatives of the cumulants while a and b are the first derivative valid for a
1 1

13
0.9
0.8
0.7
0.6
Theoretical CDF
0.5
)( Equation (34) with ten arctan terms
xF
0.4
0.3
0.2
0.1
0
0 1 2 3 4 5 6 7 8 9 10
x
Fig. 5. Comparison between theoretical CDF and computation using sum of arctans for σ = 2.
frequency segment, the chf may be written as
ϕ(jω) = A exp (a ω2 + a ω) + j(b ω2 + b ω) (39)
k 2k 1k 2k 1k
−
X (cid:0) (cid:1)
To compute the pdf, one may make use of the second derivatives of the cumulant together with
the first derivatives.
The converse - chf from CDF: If chf is expressed as a non-harmonic Fourier series (Paley
and Wiener/Gil-Pelaez [17]/Carathe`odory) viz.,
N
ϕ(jω) = A exp (jωx ) (40)
k k
k=1
X
the CDF derived from the real part is a staircase function with steps of A at the nodes x .
k k
When one introduces a damping parameter to ensure the smoothness, the similarity with Eq. (36)
becomes obvious. The converse of the above can be used to find the chf from the known values
of the distribution function, for example weibull, lognormal and generalized gamma. When the
random variables are uncorrelated one can find the chf of the sum by forming the product of
individual chfs. If the variables are correlated but the distributions are derivable from correlated
Gaussian, the pdf of a pair can be found from the joint distribution. The heights of the steps A
k
and the values of the nodes x are related to the sub-integral of the pdf.
k

|    |    |    |    |    |    |    |    |     |      |     |    |     |     |    |     |    |     |    |    | None   |
|:---|:---|:---|:---|:---|:---|:---|:---|:----|:-----|:----|:---|:----|:----|:---|:----|:---|:----|:---|:---|:-------|
|    |    |    |    |    |    |    |    |     |      |     |    |     |     |    |     |    |     |    |    |        |
|    |    |    |    |    |    |    |    |     |      |     |    |     |     |    |     |    |     |    |    |        |
|    |    |    |    |    |    |    |    |     |      |     |    |     |     |    |     |    |     |    |    |        |
|    |    |    |    |    |    |    |    |     |      |     |    |     |     |    |     |    |     |    |    |        |
|    |    |    |    |    |    |    |    |     |      |     |    |     |     |    |     |    |     |    |    |        |
|    |    |    |    |    |    |    |    |     |      |     |    |     |     |    |     |    |     |    |    |        |
|    |    |    |    |    |    | T  | he | ore | tica | lC  | DF |     |     |    |     |    |     |    |    |        |
|    |    |    |    |    |    |    |    |     |      |     |    |     |     |    |     |    |     |    |    |        |
|    |    |    |    |    |    | E  | qu | ati | on   | (34 | )w | ith | ten | ar | cta | nt | erm | s  |    |        |
|    |    |    |    |    |    |    |    |     |      |     |    |     |     |    |     |    |     |    |    |        |
|    |    |    |    |    |    |    |    |     |      |     |    |     |     |    |     |    |     |    |    |        |
|    |    |    |    |    |    |    |    |     |      |     |    |     |     |    |     |    |     |    |    |        |
|    |    |    |    |    |    |    |    |     |      |     |    |     |     |    |     |    |     |    |    |        |
|    |    |    |    |    |    |    |    |     |      |     |    |     |     |    |     |    |     |    |    |        |
|    |    |    |    |    |    |    |    |     |      |     |    |     |     |    |     |    |     |    |    |        |
|    |    |    |    |    |    |    |    |     |      |     |    |     |     |    |     |    |     |    |    |        |
|    |    |    |    |    |    |    |    |     |      |     |    |     |     |    |     |    |     |    |    |        |
|    |    |    |    |    |    |    |    |     |      |     |    |     |     |    |     |    |     |    |    |        |
|    |    |    |    |    |    |    |    |     |      |     |    |     |     |    |     |    |     |    |    |        |

14
σ
Sum of two and four lognormals for = 2
1
0.9
0.8
0.7
Single
0.6
Sum of two
)(
xF
0.5 Sum of four
0.4
0.3
0.2
0.1
0
0 5 10 15 20 25 30 35 40 45 50
x
Fig. 6. CDFs of sum of lognormals computed by inversion of the chf segmented into four regions.
D. Applicability in finding CDF:
It is useful to compare the requirements and complexities of the techniques in relation to
inversion of the mgf/chf of a lognormal sum. As noted earlier, the mgf has a wide range of
variation in rate and it is necessary to adapt the sampling rate accordingly. Post Widder, Gaver
and Gaussian quadrature require summation of weighted mgf near the inverse point as the
Equations (16) and (18) show. Post Widder uses differentiation of an order k typically greater
than twenty at s = k. The range of s for Gaver and Gaussian quadrature is large for small x
x
and is compressed for large x. Gaver technique which uses real arithmetic has a range of the
ln(2) ln(2)
argument of M(s) equal to N with a starting point of N . Cohen [13] chooses a starting
x x
ln(2)
value of ; this makes better use of the low frequency region. The requirement in s-space
x
for x = 0.1 for N = 16 is as large as 160 ln(2). The range for Zakian with N = 10 is 200 for
x = 0.1 and 2 for x = 10. For both Gaver and Zakiar, the range of s for large x is too large to
make effective use of the low frequency end.
For similar values of N, the moduli of the complex roots of the Gaussian quadrature method
[12,13] have typically a range of 1.3N and the s-space range has comparable values. For a large
value of x, the s-range is compressed but the requirement of restricting the s-values to within

|    |    |    |    |    |    |    |    |    |    |    |    |    | None   |    |    |     |     |     |    |    |
|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|:-------|:---|:---|:----|:----|:----|:---|:---|
|    |    |    |    |    |    |    |    |    |    |    |    |    |        |    |    |     |     |     |    |    |
|    |    |    |    |    |    |    |    |    |    |    |    |    |        |    |    |     |     |     |    |    |
|    |    |    |    |    |    |    |    |    |    |    |    |    |        |    |    |     |     |     |    |    |
|    |    |    |    |    |    |    |    |    |    |    |    |    |        |    |    |     |     |     |    |    |
|    |    |    |    |    |    |    |    |    |    |    |    |    |        |    |    |     |     |     |    |    |
|    |    |    |    |    |    |    |    |    |    |    |    |    |        |    |    |     |     |     |    |    |
|    |    |    |    |    |    |    |    |    |    |    |    |    |        |    |    | Sin | gle |     |    |    |
|    |    |    |    |    |    |    |    |    |    |    |    |    |        |    |    |     |     |     |    |    |
|    |    |    |    |    |    |    |    |    |    |    |    |    |        |    |    | Su  | mo  | ftw | o  |    |
|    |    |    |    |    |    |    |    |    |    |    |    |    |        |    |    | Su  | mo  | ffo | ur |    |
|    |    |    |    |    |    |    |    |    |    |    |    |    |        |    |    |     |     |     |    |    |
|    |    |    |    |    |    |    |    |    |    |    |    |    |        |    |    |     |     |     |    |    |
|    |    |    |    |    |    |    |    |    |    |    |    |    |        |    |    |     |     |     |    |    |
|    |    |    |    |    |    |    |    |    |    |    |    |    |        |    |    |     |     |     |    |    |
|    |    |    |    |    |    |    |    |    |    |    |    |    |        |    |    |     |     |     |    |    |
|    |    |    |    |    |    |    |    |    |    |    |    |    |        |    |    |     |     |     |    |    |
|    |    |    |    |    |    |    |    |    |    |    |    |    |        |    |    |     |     |     |    |    |
|    |    |    |    |    |    |    |    |    |    |    |    |    |        |    |    |     |     |     |    |    |
|    |    |    |    |    |    |    |    |    |    |    |    |    |        |    |    |     |     |     |    |    |

15
the region where M(s) varies fast is hard to meet. The Fourier method uses the entire frequency
domain to compute all the values of x ordinarily using uniform grids .This is expensive if one
has to accommodate the large changes of rates of variation. Three methods deserve attention.
The first is to segment the frequency range in terms of activity noting that the low frequency
region has large rate of variation, the far tail has a low rate and the central region has variable
activity depending on the variance distribution. The second is to let the value of the derivative
control the segment interval. One can then use exponential integral tables and the simple arctan
expression. These two methods received attention in the present work. Figure 6 shows CDFs
of a sum of lognormals computed by inversion using four segments. The smallest number of
segments needed in Fourier method is two. The third is to use multigrid extension suggested by
Dalquist [20] where a set of transforms starting at the origin has different values of the highest
frequency. One has however to remove repetitions of data.
IV. CONCLUDING REMARKS
Direct reduced range numerical integration is a convenient tool for finding the mgf of log-
normals on the real line or chf on the imaginary axis and their derivatives. The saddle point
method followed by Gauss Hermite quadrature provides insight into the behavior of mgf and
derivatives.
The simplest way to find the inverse of mgf is to use low order Post-Widder/Gaver technique
when high accuracy is not demanded. Inversion using Pade approximation is specially useful
when almost all components have large variance and the spectrum has dominant low frequency
character. The method employing a sum of complex exponential integrals is simple and attractive
because of the availability of tables but special care is needed at low frequencies where the
envelope is very close to unity.
Among the three general purpose inversion techniques, viz., Gaver, Gaussian quadrature
and Fourier series methods, Gaver and Gaussian quadrature have similar forms and are better
equipped to invert if the frequency is not low. Gaver technique is simpler as it uses real arithmetic
and is easier to vary the number N of inputs using a recursive algorithm [13]. Both Gaver
and Gaussian quadrature techniques provide pdf and CDF directly. According to the survey
by Brian and Martin, the number of terms necessary for Gaussian quadrature is smaller than
for Gaver-Stehfest. The familiar Fourier series method requires an order of magnitude larger

16
number of terms while providing transforms for all values. However separate computations are
needed to find pdf and CDF and it requires modifications for taking care of varying activity
rates. The combination of direct numerical integration and Fourier method of inversion appears
to be a simple first choice for finding the distribution function. The first two derivatives of
the cumulants are directly useful in computing the piecewise sum for CDF and pdf employing
tables of exponential integral and complex error function. The simplest approach is to use the
arctangent expression based on the first derivatives of the cumulant. One may call attention to
the fact that while the distribution at the lower tail is not hard to find, problems remain in finding
the distribution at the upper tail. One must find the forward transform at closely spaced small
values of frequency near the origin and appropriate inversion methods in this range to meet the
accuracy requirements. FW technique, one recalls, has more reliable results at the far tail than
at the lower tail.
ACKNOWLEDGMENT
The author is grateful to Prof Saswat Chakrabarti for helpful discussions. Thanks are due to
Dr. Praful Mankar, Mr. Priyabrata Parida, Mr. Kishore Kumar, and Mr. Dipjyoti Paul for many
assistances.
REFERENCES
[1] G. L. Stu¨ber, Principles of Mobile Communication (2nd Ed.). Norwell, MA, USA: Kluwer Academic Publishers, 2001.
[2] L. Fenton, “The sum of log-normal probability distributions in scatter transmission systems,” IRE Transactions on
Communications Systems, vol. 8, no. 1, pp. 57–67, March 1960.
[3] S. C. Schwartz and Y. S. Yeh, “On the distribution function and moments of power sums with log-normal components,”
Bell System Technical Journal, vol. 61, no. 7, pp. 1441–1462, 1982.
[4] W. Janos, “Tail of the distribution of sums of log-normal variates,” IEEE Transactions on Information Theory, vol. 16,
no. 3, pp. 299–302, May 1970.
[5] E. Barouch and G. M. Kaufman, “On sums of lognormal random variables,” MIT, Feb 1976.
[6] P. Holgate, “The lognormal characteristic function,” Communications in Statistics - Theory and Methods, vol. 18, no. 12,
pp. 4539–4548, 1989.
[7] N. Beaulieu and Q. Xie, “An optimal lognormal approximation to lognormal sum distributions,” IEEE Transactions on
Vehicular Technology, vol. 53, no. 2, pp. 479–489, March 2004.
[8] N. Mehta, J. Wu, A. Molisch, and J. Zhang, “Approximating a sum of random variables with a lognormal,” IEEE
Transactions on Wireless Communications, vol. 6, no. 7, pp. 2690–2699, July 2007.
[9] C. Tellambura and D. Senaratne, “Accurate computation of the mgf of the lognormal distribution and its application to
sum of lognormals,” IEEE Transactions on Communications, vol. 58, no. 5, pp. 1568–1577, May 2010.

17
[10] S. Asmussen, J. L. Jensen, and L. Rojas-Nandayapa, “On the laplace transform of the lognormal distribution,” Methodology
and Computing in Applied Probability, pp. 1–18, 2014.
[11] D. V. Widder, The Laplace Transform. Princeton: Princeton University Press, 1946.
[12] B. Davis and B. Martin, “Numerical inversion of the laplace transform: a survey and comparison of methods,” Journal of
Computational Physics, vol. 33, no. 1, pp. 1 – 32, 1979.
[13] A. M. Cohen, Numerical methods for Laplace Transform Inversion. Springer, 2007.
[14] D. P. Gaver, “Observing stochastic processes, and approximate transform inversion,” Operations Research, vol. 14, no. 3,
pp. 444–459, 1966. [Online]. Available: http://www.jstor.org/stable/168200
[15] R. Piessens, “Gaussian quadrature formulas for the numerical integration of bromwich’s integral and the inversion of the
laplace transform,” Journal of Engineering Mathematics, vol. 5, no. 1, pp. 1–9.
[16] V. Zakian and D. R. Gannon, “Least-squares optimisation of numerical inversion of laplace transforms,” Electronics Letters,
vol. 7, no. 3, pp. 70–71, February 1971.
[17] Gil-Pelaez, “Note on the inversion theorem citation,” Biometrika, vol. 38, no. 3-4, pp. 481–482, 1951.
[18] R. B. Davies, “Numerical inversion of a characteristic function,” Biometrika, vol. 60, no. 2, pp. 415–417, 1973.
[19] N. Shephard, “From characteristic function to distribution function: A simple framework for the theory,” Econometric
Theory, vol. 7, no. 04, pp. 519–529, 1991.
[20] G. Dahlquist, “A multigrid extension of thefft for the numerical inversion of fourier and laplace transforms,” BIT Numerical
Mathematics, vol. 33, no. 1, pp. 85–112.
[21] M. S. Corrington, “Applications of the complex exponential integral,” Mathematics of Computation, vol. 15, no. 73, pp.
1–6, 1961.
[22] M. Abramowitz and I. A. Stegun, Handbook of Mathematical Functions, With Formulas, Graphs, and Mathematical Tables.
Dover Publications, Incorporated, 1974.
[23] G. Beylkin, and L. Monzon, “On Generalized Gaussian Quadratures for Exponentials and Their Applications,” Applied
and Computational Harmonic Analysis, vol. 12, no. 3, pp. 332–373, 2002.