Joint Estimation of the Time Delay and the Clock
Drift and Offset Using UWB signals
A. Mallat and L. Vandendorpe
Universite´ catholique de Louvain
ICTEAM Institute
Place du Levant 2, B-1348 Louvain-la-Neuve, Belgium
Email: Achraf.Mallat, Luc.Vandendorpe @uclouvain.be
{ }
Abstract—We consider two transceivers, the first with perfect account the TOA estimation errors at both transceivers. We
clock and the second with imperfect clock. We investigate the compute the Cramer-Rao lower bounds (CRLB) for the joint
joint estimation of the delay between the transceivers and the
estimation of the delay and the drift and derive the joint
offset and the drift of the imperfect clock. We propose a protocol
4102 nuJ 62  ]PA.tats[  1v9976.6041:viXra maximum likelihood estimator (MLE). Also, we propose some
for the synchronization of the clocks. We derive some empirical
empirical estimators for the delay, the clock offset and the
estimators for the delay, the offset and the drift, and compute
the Cramer-Rao lower bounds and the joint maximum likelihood drift. The impact of the different parameters of the protocol
estimator of the delay and the drift. We study the impact of the and the TOA estimation variance on the proposed estimators is
protocol parameters and the time-of-arrival estimation variance
examined. The theoretical results are validated by simulation.
on the achieved performances. We validate some theoretical
The approach followed in this paper can be extended to derive
results by simulation.
the CRLBs and the joint MLE for many synchronization
I. INTRODUCTION protocols under different assumptions.
Highly accurate positioning can be performed by employing The rest of the paper is organized as follows. In Sec. II,
the time-of-arrival (TOA) technique if impulse-radio (IR) ultra we describe the system model. In Sec. III, we present the
wideband (UWB) signals [1]–[3] are transmitted. estimation protocol. In Sec. IV, we propose an empirical
However, one of the main challenges facing the realization algorithm. In Sec. V, we derive the CRLBs and the MLE.
of UWB-based positioning systems is the need of synchroniza- In Sec. VI, we show and discuss some numerical results.
tion among all the network transceivers if the TOA technique is
used and among the reference nodes if the time-difference-of- II. SYSTEM MODEL
arrival (TDOA) is used. Synchronization can be accomplished
As mentioned above, we describe in this section our system
by using high-precision clocks which seems to be impractical
′
model. Let us consider two transceivers Tr and Tr equipped
due to the required high-cost. To overcome this problem ′
with two clocks Ck and Ck , respectively, and assume that:
two-way ranging strategies can be used as proposed in [4]
′
1) The clock Ck is perfect whereas the clock Ck suffers
and adopted in the IEEE802.15.4a standard [5]–[7]. Two-way
from a drift and an offset.
ranging can mitigate the effects of the offset between clocks.
′
2) The time delay τ between Tr and Tr (i.e. τ is the time
However, the impact of clock drift is still present and causes
′
spent by a signal transmitted by Tr to reach Tr ) is
non-negligible errors when the waited time at the receiver side
′
constant. Therefore, if Tr and Tr communicate through
is relatively long [7]–[10].
free space (resp. a cable) then the distance (resp. the
The effects of clock drift on TOA estimation accuracy is
cable length) should be constant. In multipath channels,
evaluated in many works where a wide variety of two-way
τ is proportional to the length of the detected path (not
protocols are proposed to reduce as much as possible the
necessarily the direct one).
impact of the drift [8]–[14]. However the problem of joint
′ ′
The local time t of Ck can be written with respect to (w.r.t.)
delay and clock offset and drift estimation is not investigated,
the true time t (local time of Ck) as:
or is investigated but without taking into account the primary
impact of TOA estimation errors. Even when TOA estimation
′
t = αt + γ = (1 + ν)t + γ (1)
errors are considered they are either considered in simulation
only, or are considered in the proposed model but the proposed
where ν = α 1 (a coefficient) and γ (in seconds) denote
estimators are not optimal. − ′
the drift and the offset of Ck , respectively. The drift is often
In this paper we consider two transceivers, one equipped expressed in terms of parts-per-million (ppm); it is defined as
with a perfect clock and one equipped with an imperfect the maximum number of extra or missed clock counts over
clock. We investigate the joint estimation of the time delay a total of 106 counts. The drift as defined in (1) is obtained
10−6.
between the two transceivers and the offset and the drift of from that in ppm ν by ν = ν We assume in this
ppm ppm
the imperfect clock. We propose a system model taking into paper that ν can be positive or negative.

 
True time 3) Tr waits for the durations δ , ,δ (known in advance
1 N
′ ··· ′
Offset by Tr ) before sending N reply signals to Tr . We will
Drift see later in Sec. IV-A that N cannot be lower than
Jitter two. The nth signal is transmitted at the true “time of
semit lacoL
O+D+J
departure after waiting” (TOW)
′
t γ
t = tˆ + δ = D − + τ + δ + ǫ (3)
W,n A n n A
α
′
and arrives to Tr at the true “time of return” (TOR)
′
t γ
t = t + τ = D − + 2τ + δ + ǫ
R,n W,n n A
α
0 
′
0 which corresponds w.r.t. Ck to
True time
′
t = αt + γ = α(t + τ) + γ
R,n R,n W,n
′
Fig. 1. True time (solid line), local time with offset (dashed line), local time = t + α(2τ + δ ) + αǫ .
D n A
with drift (dotted line), local time with jitter (dash-dotted line), and local time
Tr′ t′ tˆ′
with offset, drift and jitter (line with circles). 4) estimates ; denote by the estimated TOR
R,n R,n
Ck′ tˆ′
w.r.t. ; can be written as:
R,n
tˆ′ t′ ǫ′ ǫ′
Similarly to [7]–[11], [13] the problem of clock jitter is not = + = α(t + τ) + γ + (4)
R,n R,n R,n W,n R,n
included in our model for simplicity reasons. The jitter denotes = t′ + α(2τ + δ ) + αǫ + ǫ′ (5)
D n A R,n
the instantaneous fluctuations around the average local time
′ ′
where ǫ denotes the estimation error w.r.t. Ck .
described in (1). In Fig. 1, we illustrate the lines representing R,n
′
5) Tr proceeds to the estimation of the unknown pa-
the true time (solid line), a local time with an offset (dashed
rameters α, γ and τ by making use of the protocol
line), a local time with drift (dotted line), a local with jitter
parameters δ , ,δ , the estimated TOA tˆ and TORs
(dash-dotted line), and a local time with all the mentioned 1 N A
···
tˆ′ ,tˆ′
, , and the distributions of the estima-
imperfections (line with circles). R,1 R,N
···
′ ′
tion errors ǫ ,ǫ , ,ǫ (possible to be estimated
A R,1 R,N
In the next sessions we propose a protocol and some ···
jointly with the TOA and the TORs).
′
algorithms to synchronize Tr and Tr and to estimate the time
To be able to estimate the clock offset γ, the estimated TOA
delay between them. tˆ should be contained in the reply signals sent by Tr to Tr′ .
A
′
Otherwise, Tr can only estimate the time delay τ and the
III. ESTIMATION PROTOCOL
tˆ′ ,tˆ′
clock drift α (from the estimated TORs , ).
In this section we describe our estimation protocol. “Proto- R,1 ··· R,N
It can be shown [15] that in the presence of an additive white
col” stands for the consecutive steps to be followed by Tr and
′ Gaussian noise (AWGN), the MLE of the TOA is unbiased at
Tr in order to obtain the observation carrying the information
sufficiently high signal-to-noise ratios (SNR), follows a normal
about the unknown parameters. After proposing our protocol
distribution and achieves the CRLB. At low and medium
we realized that a similar protocol has already been proposed
SNRs, the MLE is no longer Gaussian. Let us assume that:
in [8]. The main contribution in this work is the derivation
of the CRLBs and the estimation algorithms presented in the ǫ (0,σ2 ) (6)
A A
∼ N
next sections rather than the protocol described here. ǫ′ (0,σ2 = α2σ2 σ2 ), n (7)
R,n R′ R R
∼ N ≈ ∀
Let us present the protocol:
where (µ ,σ2 ) denotes the normal distribution of mean
′ N N
1) Tr sends a signal to Tr at the “time of departure” (TOD) N
µ and variance σ2 , σ2 the variance of tˆ w.r.t. a perfect
′ ′ ′ N N A A
t D (TOD w.r.t. Ck ); using (1), we can write t D w.r.t. clock, and σ2 and σ2 the variances of tˆ′ w.r.t. an imperfect
R′ R R,n
the true TOD t as:
D and a perfect clock respectively; σ2 is approximated by σ2
R′ R
′ to make the covariance matrices in Secs. IV, V independent of
t = αt + γ.
D D
the unknown parameters to estimate (valid assumption because
The transmitted signal arrives to Tr at the true “time of
α 1 and because σ is much smaller than τ and δ ). In
R n
≈
arrival” (TOA) (7), σ2 is the same n because the reply signals sent by Tr
R
t′ γ to Tr′ have all the s∀ ame energy; σ2 is not assumed equal
t A = t D + τ = D − + τ. to σ2 because the signals transmitteA d by Tr and Tr′ do not
α R
necessarily have the same energy.
2) Tr estimates t ; denote by tˆ the estimated TOA w.r.t.
A A At sufficiently high SNRs, both σ2 and σ2 can be computed
the perfect clock. We can write tˆ as: A R
A
from the expression of the CRLB for time estimation given
′
t γ
by [16], [17]
tˆ = t + ǫ = D − + τ + ǫ (2)
A A A A
α
1
c =
where ǫ denotes the estimation error. T ρβ2
A

where ρ and β2 denote the SNR and the mean quadratic B. The proposed algorithm
bandwidth of the transmitted signal (β is also called effective
Many empirical estimators for α, τ and γ can be proposed
bandwidth) respectively. For a signal occupying the whole
based on the equations established in Sec. III. However, it will
UWB band authorized by the US federal commission of
suffice to investigate one estimator only as an example. The
communications (FCC) [1] (central frequencyof 6.85 GHz and
main goal is to compare the performances of an empirical
bandwidth of 7.5 GHz so β = 45.14 GHz) we have √c = 7
T estimator with the performances of the optimal estimator
ps (resp. 0.7 ps) at ρ = 10 dB (resp. 30 ps).
considered in Sec. V.
From (8), we can generate the following N 1 estimates
IV. EMPIRICAL ALGORITHM −
of α (n = 1, ,N 1):
··· −
In this section we propose an empirical algorithm for the tˆ′ tˆ′
R,n+1 R,1
αˆ = − . (12)
estimation of the time delay and the clock offset and drift. n,1
δ δ
n+1 1
We consider in Sec. IV-A the case where the estimation errors −
ǫ in (2) and ǫ′ in (5) are null (i.e tˆ and tˆ′ correctly Let αˆ 1 = (αˆ 1,1, ,αˆ N−1,1)T with T denoting the transpose
A R,n A R,n ···
operator. By considering αˆ as the observation carrying the in-
estimated) and present in Sec. IV-B the proposed algorithm. 1
formation on α, the log-likelihood function for the estimation
Note that an optimal estimator should treat the entire avail-
of α can be written from (7) and (12) as:
able observation. Accordingly, if tˆ is known (resp. unknown)
A
′ 1 T
by Tr then α, γ and τ (resp. α and τ) should be jointly Ω−1
Λ = αˆ µ αˆ µ
αˆ1 1 1
estimated by maximizing the likelihood function relative to −2 − αˆ1 αˆ1 − αˆ1
(cid:16) (cid:17) (cid:16) (cid:17)
tˆ and tˆ′ , ,tˆ′ (resp. tˆ′ , ,tˆ′ ). where
A R,1 R,N R,1 R,N
··· ···
µ = α1
N−1
A. Error-free case αˆ1
Ω = (ω )
As mentioned above we assume here that ǫ in (2) and ǫ′ αˆ1 m,n m,n=1,···,N−1
A R,n
in (5) are null. denote the mean and the covariance matrix of αˆ with 1
1 N−1
being a vector of N 1 elements equal to one, and
To find α and τ from (5), we need at least two equations.
−
2
So by taking N = 2 we can write 2σ
R m = n
(δn−δ1)2
ω =
m,n 2
tˆ′ = t′ + α(2τ + δ ) ( σ R m = n.
R,1 D 1 (δm−δ1)(δn−δ1) 6
tˆ′ t′
= + α(2τ + δ )
(cid:26) R,2 D 2 The MLE αˆ 1 (w.r.t. to the observation αˆ 1) of α consists
on maximizing the log-likelihood function Λ . The partial
so α and τ can be expressed as (n = 1,2): αˆ1
derivative of Λ w.r.t. α can be written as:
αˆ1
tˆ′ tˆ′
T
R,2 R,1 ∂µ
α = − (8) ∂Λ
δ δ αˆ1 = αˆ1 Ω−1 αˆ µ
2 1
− ∂α ∂α αˆ1 − αˆ1
tˆ′ t′ αδ   !
R,n D n (cid:16) (cid:17)
τ = − − . (9) = 1T Ω−1αˆ α1T Ω−1 1 .
2α N−1 1 N−1 N−1
αˆ1 − αˆ1
Note that τ is also given by ∂Λαˆ1
By equating to zero we can express αˆ as:
∂α 1
2(tˆ′ t′ 1(tˆ′ t′
δ D) δ D) aTαˆ
τ = R,1 − − R,2 − . αˆ = 1 (13)
2(tˆ′ tˆ′ ) 1 A
R,2 R,1
−
with
However, we prefer the expression in (9) because it will be
aT 1T Ω−1
used later in Sec. IV-B in the proposed algorithm. =
N−1
αˆ1
froI mf w (e 2)a ,s (s 3u )m ae nt dha (4t )tˆ A asis (k nn =ow 1b ,2y )T r′ , then γ can be expressed A = 1T N−1Ω α− ˆ11 1 N−1.
:
We can see from (13) that αˆ follows a normal distribution
1
γ = t′ α(tˆ τ) (10) with a mean and a variance respectively given by
D A
− −
= tˆ′ α(tˆ + δ + τ). (11) aTµ
R,n A n αˆ1
−
µ = = α
αˆ1
A
Hence, N = 2 is sufficient to obtain the exact values
aTΩ a
1
of the unknown parameters in the error-free case. In the αˆ1
σ2 = = . (14)
presence of errors, N = 2 is also sufficient to perform the αˆ1 A2 A
estimation; however, estimation performance can be improved Our estimator is thus unbiased. We have considered αˆ as
1
by increasing the number of observations. empirical because αˆ is not necessarily a sufficient statistic.
1

From (9) and (13), we can generate the following N A. CRLBs for the joint estimation of α and τ
estimates of τ (n = 1, ,N):
The CRLB for the estimation of a parameter gives the lowest
···
E
tˆ′ t′ variance achievable by an unbiased estimator. Denote by
αˆ δ
R,n D 1 n
τˆ = − − . (15) the expectation operator. The CRLBs of α and τ are [18]
n,1
2αˆ
1
the diagonal elements of the inverse of the Fisher information
The variance of τˆ is not the same n due to the term αˆ 1δ
n,1 n matrix (FIM) given by
∀
(the variance of αˆ is proportional to σ2 ); we recall that the
1 R
variance of tˆ′ is equal to σ2 + σ2 , n. From τˆ in (15), f α,α f α,τ
R,n A R n,1 =
∀ FX f f
we propose the following estimator of τ: τ,α τ,τ
(cid:18) (cid:19)
where
1T τˆ
N 1
τˆ 1 = N (16) ∂2Λ ∂µT ∂µ
f θ,θ′ = −E ∂θ∂θX = ∂θX Ω− X1 ∂θX = f θ′,θ
′ ′
where τˆ = (τˆ , ,τˆ )T.
1 1,1 N,1 (cid:26) (cid:27)
···
′
From (11), (13) and (16), we can generate the following N with θ,θ α,τ and
∈ { }
estimates of γ (n = 1, ,N):
∂µ
···
X
γˆ = tˆ′ αˆ tˆ + δ + τˆ . (17) ∂α = 2τ1 N + δ (22)
n,1 R,n 1 A n 1
−
∂µ
From γˆ in (17), we propos(cid:0)e the followin(cid:1)g estimator of γ: X
n,1 = 2α1 . (23)
N
∂τ
1T γˆ
N 1 Hence,
γˆ = (18)
11
N
f = 4τ2B + 4τD + F
α,α
where γˆ = (γˆ , ,γˆ )T. Another estimator can be
1 1,1 ··· N,1 f = 4α2B
directly proposed from (10) as: τ,τ
f = 2α(2τB + D) = f
α,τ τ,α
γˆ = t′ αˆ (tˆ τˆ ). (19)
12 D 1 A 1
− −
where
Note that the exact means and variances of τˆ in (15) and
n,1
B = 1T Ω−1 1
γˆ in (17) are not easy to express because τˆ is the ratio of
n,1 n,1 N X N
two random variables. However, the asymptotic statistics are D = 1T Ω−1δ
N
possible to compute. Nevertheless, we did not calculate them X
δT Ω−1δ.
here for the sake of conciseness. F =
X
The CRLBs of α and τ can respectively be expressed as:
V. CRLBS AND JOINT MLE
f B
In this section we derive the CRLBs for the joint estimation τ,τ
c = = (24)
α
of the time delay τ and the clock drift α based on the estimated f f f2 BF D2
α,α τ,τ α,τ
− −
tˆ′
TORs in (5). We compute the joint MLE of α and τ and f 4τ2B + 4τD + F
R,n α,α
c = = . (25)
propose two empirical estimators for the clock offset γ. τ
f f f2 4α2(BF D2)
α,α τ,τ α,τ
− −
Let:
We can show that c is a function of σ2 , N and the variance
α R
tˆ′ t′
X = 1 of δ only. We can show as well that the term 4τ2B + 4τD
R D N n
−
can be neglected in the expression of c and that α can be
τ
where tˆ′ R = (tˆ′ R,1, ,tˆ′ R,N)T. The log-likelihood function approximated by 1 so c becomes a function of σ A2 , σ R2 , N
··· τ
for the joint estimation of α and τ can be written from (5)–
and the mean and the variance of δ .
n
(7) as:
B. Joint MLE of α and τ
1 T
Ω−1
Λ = X µ X µ
X The MLE (αˆ ,τˆ ) of (α,τ) consists on maximizing the log-
−2 − X X − X 2 2
(cid:16) (cid:17) (cid:16) (cid:17) likelihood function Λ . Therefore, (αˆ ,τˆ ) can be obtained
where X 2 2
by equating the partial derivatives of Λ to zero:
X
µ = α(2τ1 + δ) (20)
X N ∂ΛX
= 0
Ω = (ω ) (21) ∂α
X m,n m,n=1,···,N (α,τ)=(αˆ2,τˆ2) (26)
 ∂ΛX (cid:12)
(cid:12) = 0
respectively denote the mean and the covariance matrix of X   ∂τ (cid:12)(α,τ)=(αˆ2,τˆ2)
with δ = (δ δ )T and (cid:12)
1 ··· N where  (cid:12)
 (cid:12)
σ2 + σ2 m = n ∂µT
ω = A R ∂Λ
m,n σ2 m = n. X = X Ω−1 X µ
A
(cid:26) 6 ∂θ ∂θ X − X
(cid:16) (cid:17)

with θ α,τ . Using (20)–(23), we can write from (26): This result is very interesting because it shows that αˆ is
2
∈ { }
efficient; it always achieves the CRLB.
δ)T Ω−1
(2τˆ 1 + X αˆ (2τˆ 1 + δ) = 0 (27)
2 N X − 2 2 N Unlike αˆ , τˆ is biased and follows the distribution of the
2αˆ 21T NΩ−1 (cid:2)X αˆ 2(2τˆ 21 + δ)(cid:3) = 0. (28) two2 co2
N ratio of rrelated normal variables. The PDF of τˆ can
X − 2
be computed by making use of the work in [19], [20] about
By taking account of (28(cid:2)), (27) becomes: (cid:3)
the ratio of normal variables. For sufficiently high SNRs, τˆ
2
δT Ω−1
X αˆ (2τˆ 1 + δ) = 0. (29) becomes, as can be observed from (38) unbiased and follows
2 2 N
X −
a normal distribution with a variance given by:
After some manip(cid:2)ulations, we can write(cid:3) (28) and (29) as:
T T
C 2αˆ τˆ B αˆ D = 0 (30) k τl Ω k τl 4τ2B + 4τD + F
− 2 2 − 2 σ2 = − X − = = c .
E 2αˆ τˆ D αˆ F = 0 (31) τˆ2 (cid:16) 4α2(B(cid:17)F D(cid:16)2)2 (cid:17) 4α2(BF D2) τ
2 2 2
− − − − (40)
where
This result is very interesting as well because it shows that τˆ
2
C = 1T Ω−1X is asymptotically efficient.
N
X
δT Ω−1X.
E = C. Empirical estimators of γ
X
By solving the equation system in (30) and (31) we obtain the Assume now that the TOA tˆ is know by Tr′ . The joint
A
following expressions of αˆ and τˆ : MLE of α, γ and τ consists in this case on maximizing the
2 2
log-likelihood function corresponding to tˆ and all tˆ′ . This
BE CD A R,n
αˆ = − = gTX (32) estimator is not investigated in this paper. In this subsection
2
BF D2
− we propose two empirical estimators of γ by making use of
T
CF DE k X
αˆ and τˆ derived in the last subsection.
τˆ = − = (33) 2 2
2
2(BE CD) lT X
− Similarly to the estimators in (18) and (19), we propose the
where
following two estimators:
BδT D1T Ω−1
gT − N X 1T Nγˆ 2
= γˆ = (41)
(cid:16) BF D2(cid:17) 21 N
−
kT = F1T N − DδT Ω− X1 γˆ 22 = t′ D − αˆ 2(tˆ A − τˆ 2). (42)
lT = (cid:16) 2 BδT D1T(cid:17) Ω−1. where γˆ = (γˆ 1,2, ,γˆ N,2)T with
2
− N X ···
In order to compute the(cid:16) statistics of ou(cid:17) r estimators we write γˆ = tˆ′ αˆ tˆ + δ + τˆ .
n,2 R,n 2 A n 2
−
X, using (5), in the expressions of αˆ and τˆ as:
2 2
(cid:0) (cid:1)
VI. NUMERICAL RESULTS AND DISCUSSION
X = α(2τ1 + δ) + ǫ (34)
N R
In this section we discuss some numerical results. The main
where ǫ = αǫ 1 + (ǫ′ ǫ′ )T; ǫ is zero-mean and
R A N R,1 R,N R two goals are to evaluate our estimators and to study the impact
···
has the same covariance matrix as X. Then,
of some parameters (σ , σ , δ and N) on the achieved
A R N
αˆ = gT α(2τ1 + δ) + ǫ = α + gTǫ (35) performances. Unfortunately, we cannot show all our results
2 N R R
due to the lack of space.
T
k ǫR
kT(cid:2)α(2τ1 + δ) + ǫ (cid:3) τ +
N R 2α(BF−D2) Unless mentioned otherwise, we consider the following
τˆ = = (36)
2 lT (cid:2)α(2τ1 N + δ) + ǫ R(cid:3) 1 + 2α(BlT Fǫ −R D2) values in our simulations: ν ppm = 20 ppm, γ = 1µs, τ = 100
ns (which corresponds to a distance of 30 m), σ = σ = 0.1
A R
(cid:2) kT ǫ (cid:3) lT ǫ
R R ns, δ = 1 ms, and N = 4; δ is given by δ = nδN . In
τ + 1 (37) N n n
N
≈ " 2α(BF D2) #" − 2α(BF D2) # our simulations the variances are obtained based on 104 noise
− −
samples.
T T
k τl ǫ
R
−
τ + . (38) We denote by σ , σ , σ , σ , σ , σ , σ and
α,1 α,2 τ,1 τ,2 γ,11 γ,12 γ,21
≈ (cid:16)2α(BF D(cid:17) 2)
σ the standard deviations (Stds) obtained by simulation of
− γ,22
We have obtained (37) from (36) by using the approximation the estimators αˆ in (13), αˆ in (32), τˆ in (16), τˆ in (33), γˆ
1 2 1 2 11
(1 + ξ)m 1 + mξ for ξ << 1, and (38) from (37) by in (18), γˆ in (19), γˆ in (41) and γˆ in (42), respectively,
12 21 22
≈
neglecting the noise product (i.e. the noise of second order). by κ the Std of αˆ (square root of σ2 in (14)), and by
α,1 1 αˆ1
κ and κ the square roots of the CRLBs c in (24) and
We can see form (35) that αˆ is unbiased and follows a α,2 τ,2 α
2
c in (25), respectively.
normal distribution with a variance given by: τ
B In Figs. 2(a)–2(l) we show the Stds for drift, offset and delay
σ2 = gT Ω g = = c . (39)
αˆ2 X BF D2 α estimation, respectively, w.r.t. σ A, σ R, δ N and N, respectively.
−

A. Impact of σ REFERENCES
A
[1] Federal Communications Commission (FCC), “Revision of part 15 of
Fig. 2(a) shows that αˆ and αˆ achieve the same perfor-
1 2 the commission rules regarding ultra-wideband transmission systems,”
mance; they both achieve the CRLB which is independent of
in FCC 02-48, Apr. 2002.
σ . The variance of an unbiased estimator can never be lower [2] Commission of the European Communities (EC), “Commission decision
A
of 21/ii/2007 on allowing the use of the radio spectrum for equipment
than the CRLB. However, σ , σ are sometimes lower than
α,1 α,2 using ultra-wideband technology in a harmonised manner in the com-
κ because they are obtained by simulation. Fig. 2(b) shows
α,2 munity,” Feb. 2007.
that γˆ and γˆ approximately achieve the same performance. [3] ——, “Final report from CEPT in response to EC mandates on the
1 2
harmonized introduction of radio applications based on ultra-wideband
The achieved variances increase with σ . Fig. 2(c) shows that
A (UWB) technology,” Mar. 2007.
τˆ and τˆ approximately achieve the same performance. They
1 2 [4] J.-Y. Lee and R. Scholtz, “Ranging in a dense multipath environment
both achieve the CRLB that increases with σ . using an UWB radio link,” IEEE Journal on Selected Areas in Commu-
A
nications, vol. 20, no. 9, pp. 1677–1683, Dec. 2002.
[5] “IEEE Standard for Information Technology - Telecommunications and
Information Exchange Between Systems - Local and Metropolitan Area
B. Impact of σ
R
Networks - Specific Requirement Part 15.4: Wireless Medium Access
Control (Mac) and Physical Layer (PHY) Specifications for Low-Rate
For the estimation of γ and τ, we observe in Figs. 2(e) and
Wireless Personal Area Networks (WPANs),” IEEE Std 802.15.4a-2007
2(f) the same results discussed in Sec. VI-A. However, the (Amendment to IEEE Std 802.15.4-2006), pp. 1–203, 2007.
variance achieved by the estimators of α increases now with [6] Z. Sahinoglu and S. Gezici, “Ranging in the IEEE 802.15.4a stan-
dard,” in IEEE Annual Wireless and Microwave Technology Conference
σ as can be observed in Fig. 2(d).
R (WAMICON 2006), Dec. 2006, pp. 1–5.
[7] D. Dardari, A. Conti, U. Ferner, A. Giorgetti, and M. Win, “Ranging
with ultrawide bandwidth signals in multipath environments,” Proc.
C. Impact of δ
N IEEE, vol. 97, no. 2, pp. 404–426, Feb. 2009.
[8] H. Kim, “Double-sided two-way ranging algorithm to reduce ranging
The variance achieved by the estimators of α decreases as time,” IEEE Communications Letters, vol. 13, no. 7, pp. 486–488, July
δ increases as can be seen in Fig. 2(g). This result can be 2009.
N
[9] L. J. Xing, L. Zhiwei, and F. Shin, “Symmetric double side two
expected from (12).
way ranging with unequal reply time,” in IEEE Vehicular Technology
Conference (VTC 2007), Sept. 2007, pp. 1980–1983.
Fig. 2(h) shows that the variances achieved by the estimators
[10] Y. Jiang and V. Leung, “An asymmetric double sided two-way ranging
of γ decrease as δ increases, then increase to reach a given for crystal offset,” in International Symposium on Signals, Systems and
N
ceil. The convergence to a constant value is due to the fact Electronics (ISSSE 2007), July 2007, pp. 525–528.
[11] B. Denis, J.-B. Pierrot, and C. Abou-Rjeily, “Joint distributed synchro-
that the lowest variance achieved by an estimator of γ should
nization and positioning in UWB ad hoc networks using TOA,” IEEE
be a function of σ , σ and N. However, to understand the Transactions on Microwave Theory and Techniques, vol. 54, no. 4, pp.
A R
non-monotonous behavior of the achieved variance we need a 1896–1911, June 2006.
[12] Y. Shimizu and Y. Sanada, “Accuracy of relative distance measurement
closed-form expression of the variance or the CRLB.
with ultra wideband system,” in 2003 IEEE Conference on Ultra
Wideband Systems and Technologies, Nov. 2003, pp. 374–378.
We can see in Fig. 2(i) that the variances achieved by the
[13] F. Sivrikaya and B. Yener, “Time synchronization in sensor networks: a
estimators of τ decrease as δ N increases until they converge to survey,” IEEE Network, vol. 18, no. 4, pp. 45–50, July 2004.
a constant value. This result is expected like for the estimation [14] B. Zhen, H.-B. Li,and R. Kohno, “Clock management in ultra-wideband
ranging,” in 2007 Mobile and Wireless Communications Summit, July
of γ.
2007, pp. 1–5.
[15] R. McAulay and D. Sakrison, “A PPM/PM hybrid modulation system,”
IEEE Trans. Commun. Technol., vol. 17, no. 4, pp. 458–469, Aug. 1969.
D. Impact of N
[16] A. Mallat, J. Louveaux, and L. Vandendorpe, “UWB based positioning
in multipath channels: CRBs for AOA and for hybrid TOA-AOA based
We can observe in Figs. 2(j)–2(l) that the variances achieved methods,” in IEEE Int. Conf. Commun. (ICC 2007), June 2007, pp.
by the estimators of α, γ and τ decrease as N increases; 5775–5780.
[17] A. Mallat, C. Oestges, and L. Vandendorpe, “CRBs for UWB multipath
in fact, by increasing N we increase the total SNR because
channel estimation: Impact of the overlapping between the MPCs on
tˆ′ ,tˆ′
, are independent. MPC gain and TOA estimation,” in IEEE Int. Conf. Commun. (ICC
R,1 R,N
···
2009), June 2009, pp. 1–6.
[18] S. Kay, Fundamentals of Statistical Signal Processing Estimation The-
VII. CONCLUSION ory. Prentice-Hall, 1993.
[19] G. Marsaglia, “Ratios of normal variables and ratios of sums of uniform
variables,” J. Amer. Statist. Assoc., vol. 60, no. 309, pp. 193–204, Mar.
We have considered the joint estimation of the time delay
1965.
between two transceivers and the offset and the drift of [20] ——, “Ratios of normal variables,” J. Stat. Softw., vol. 16, no. 4, May
2006.
an imperfect clock. We have proposed a protocol for the
synchronization of the transceivers. We have proposed some
empirical estimators for the delay, the offset and the drift.
Also, we have derived the CRLBs and the joint MLE of
the delay and the drift. We have studied the impact of the
parameters of the protocol and the TOA estimation variance
on the achieved performances. Some theoretical results are
validated by simulation.

     
σ σ
)mpp( srotamitse tfird fo sdtS)mpp( srotamitse tfird fo sdtS)mpp( srotamitse tfird fo sdtS)mpp( srotamitse tfird fo sdtS 0.1795 γ,11 τ,1
)s( srotamitse tesffo fo sdtS)s( srotamitse tesffo fo sdtS)s( srotamitse tesffo fo sdtS)s( srotamitse tesffo fo sdtS )s( srotamitse yaled fo sdtS)s( srotamitse yaled fo sdtS)s( srotamitse yaled fo sdtS)s( srotamitse yaled fo sdtS
σ σ
γ,12 τ,2
0.179
σ κ
γ,21 τ,2
0.1785
σ
σ γ,22
α,1
0.178
σ
α,2
0.1775
κ
α,1 10−10 10−10
0.177 κ
α,2
0.1765
     
−12 −11 −10 −9 −12 −11 −10 −9 −12 −11 −10 −9
10 10 10 10 10 10 10 10 10 10 10 10
σ  (s) σ  (s) σ  (s)
A A A
(a) (b) (c)
     
σ σ σ
1.6 α,1 γ,11 τ,1
σ σ σ
1.4 α,2 γ,12 τ,2
κ σ κ
1.2 α,1 γ,21 τ,2
1 κ σ
α,2 γ,22
0.8
0.6
−10 −10
10 10
0.4
0.2
     
−12 −11 −10 −9 −12 −11 −10 −9 −12 −11 −10 −9
10 10 10 10 10 10 10 10 10 10 10 10
σ  (s) σ  (s) σ  (s)
R R R
(d) (e) (f)
     
2
10 σ σ −10.04 σ
α,1 γ,11 10 τ,1
σ σ σ
α,2 γ,12 τ,2
1 κ −10 σ κ
10 α,1 10 γ,21 τ,2
−10.06
κ σ 10
α,2 γ,22
0
10
−10.08
10
−1
10
−10.1
10
     
−6 −5 −4 −3 −2 −6 −5 −4 −3 −2 −6 −4 −2
10 10 10 10 10 10 10 10 10 10 10 10 10
δ δ δ
N N N
(g) (h) (i)
0.28      
σ σ σ
0.26 α,1 γ,11 τ,1
σ σ σ
κα,2 σγ,12 κτ,2
0.24 10−10 10−10
α,1 γ,21 τ,2
0.22
κ σ
α,2 γ,22
0.2
0.18
0.16
0.14
0.12
     
2 4 6 8 10 2 4 6 8 10 2 4 6 8 10
N N N
(j) (k) (l)
Fig. 2. (a)–(l) Stds for drift, offset and delay estimation, respectively, w.r.t. σ A, σ R, δ N and N, respectively.

| 0.1795 )mpp(           |     | σ                         | σ      | σ                           |
| 0.179                  |     | γ,11                      | γ,11   | τ,1                         |
| srotamitse             |     | )s(                       | σ      | )s(                         |
| 0.1785                 |     | σ                         | γ,12   | σ                           |
| σ                      |     | γ,12 srotamitse           | σ      | τ,2 srotamitse              |
| 0.178 α,1              |     | σ                         | γ,21   | κ                           |
| σ α,2 tfird            |     | γ,21                      | σ      | τ,2                         |
| 0.1775                 |     | σ                         | γ,22   | yaled                       |
| κ                      |     | γ,22                      |        | fo                          |
| α,1 fo                 |     | tesffo                    |        | 10−10                       |
| 0.177 κ sdtS           |     | fo                        |        | sdtS                        |
| α,2                    |     | 10−10                     |        | −9 10−12 10−11 10−10 10−9   |
| 0.1765                 |     | sdtS                      |        | σ (s)                       |
| 10−12 10−11 10−10 10   |     | −9 10−12 10−11 10−10 10   |        | A                           |
| σ (s)                  |     | σ (s)                     |        |                             |
| A                      |     | A                         |        |                             |
|:-----------------------|:----|:--------------------------|:-------|:----------------------------|
|                        | σ   |                           |        |                             |
|                        | α,1 |                           |        |                             |
|                        | σ   |                           |        |                             |
|                        | α,2 |                           |        |                             |
|                        | κ   |                           |        |                             |
|                        | α,1 |                           |        |                             |
|                        | κ   |                           |        |                             |
|                        | α,2 |                           |        |                             |

|     |
|:----|
| σ   |
| τ,1 |
| σ   |
| τ,2 |
| κ   |
| τ,2 |

| 0                    | 1                       | 2                         |
|:---------------------|:------------------------|:--------------------------|
| σ                    | σ                       | σ                         |
| 1.6 α,1 )mpp(        | γ,11                    | τ,1                       |
| σ                    | )s(                     | )s(                       |
| 1.4 α,2              | σ                       | σ                         |
| 1.2 κ α,1 srotamitse | γ,12 srotamitse         | τ,2 srotamitse            |
| 1 κ α,2              | σ                       | κ                         |
| 0.8                  | γ,21                    | τ,2                       |
| tfird                | σ                       | yaled                     |
| 0.6                  | γ,22                    | 10−10 fo                  |
| fo                   | tesffo                  | sdtS                      |
| 0.4 sdtS             | 10−10 fo                | −9 10−12 10−11 10−10 10−9 |
| 0.2                  | sdtS                    | σ (s)                     |
| 10−12 10−11 10−10 10 | −9 10−12 10−11 10−10 10 | R                         |
| σ (s)                | σ (s)                   |                           |
| R                    | R                       |                           |

| 0                      | 1   | 2                         | 3    | 4                 |
|:-----------------------|:----|:--------------------------|:-----|:------------------|
| 102                    | σ   | σ                         | σ    | 10−10.04 σ        |
| σ                      | α,1 | γ,11                      | γ,11 | τ,1               |
| α,1 )mpp(              | σ   | σ )s(                     | σ    | σ )s(             |
| σ                      | α,2 | γ,12 srotamitse           | γ,12 | τ,2 srotamitse    |
| α,2                    | κ   | 10−10 σ                   | σ    | κ                 |
| 101 κ α,1 srotamitse   | α,1 | γ,21                      | γ,21 | 10−10.06 τ,2      |
| κ                      | κ   | σ                         | σ    | yaled             |
| α,2                    | α,2 | γ,22                      | γ,22 | 10−10.08          |
| 100                    |     | tesffo                    |      | fo                |
| tfird                  |     | fo                        |      | sdtS              |
| fo                     |     | sdtS                      |      | 10−10.1           |
| 10−1 sdtS              |     | −2 10−6 10−5 10−4 10−3 10 |      | −2 10−6 10−4 10−2 |
| 10−6 10−5 10−4 10−3 10 |     | δ                         |      | δ                 |
| δ                      |     | N                         |      | N                 |
| N                      |     |                           |      |                   |

| 0              | 1   | 2   | 3                  | 4    | 5    | 6                  |
|:---------------|:----|:----|:-------------------|:-----|:-----|:-------------------|
| σ              | σ   | σ   | σ                  | σ    | σ    | σ                  |
| 0.26 α,1       | α,1 | α,1 | γ,11               | γ,11 | γ,11 | τ,1                |
| σ )mpp(        | σ   | σ   | σ )s(              | σ    | σ    | σ )s(              |
| 0.24 α,2       | α,2 | α,2 | γ,12               | γ,12 | γ,12 | τ,2                |
| κ              | κ   | κ   | 10−10 σ srotamitse | σ    | σ    | 10−10 κ srotamitse |
| α,1 srotamitse | α,1 | α,1 | γ,21               | γ,21 | γ,21 | τ,2                |
| 0.22           | κ   | κ   | σ                  | σ    | σ    | yaled              |
| κ              | α,2 | α,2 | γ,22               | γ,22 | γ,22 | fo                 |
| α,2            |     |     | tesffo             |      |      | sdtS               |
| 0.2            |     |     | fo                 |      |      | 0 2 4 6 8 10       |
| 0.18 tfird     |     |     | sdtS               |      |      | N                  |
| 0.16 fo        |     |     | 0 2 4 6 8 1        |      |      |                    |
| sdtS           |     |     | N                  |      |      |                    |
| 0.14           |     |     |                    |      |      |                    |
| 0.12           |     |     |                    |      |      |                    |
| 2 4 6 8 1      |     |     |                    |      |      |                    |
| N              |     |     |                    |      |      |                    |

| 0   | 1   |
|:----|:----|
| σ   | σ   |
| τ,1 | τ,1 |
| σ   | σ   |
| τ,2 | τ,2 |
| κ   | κ   |
| τ,2 | τ,2 |