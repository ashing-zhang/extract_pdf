RunTensorFlowmodelsinc++withoutBazel,withoutTensorFlowinstallationandwithoutcompiling
Tensorflow. Perform tensor manipulation, use eager execution and run saved models directly from
C++.
1 // Read the graph
2 cppflow::model model("saved_model_folder");
3
4 // Load an image
5 auto input = cppflow::decode_jpeg(cppflow::read_file(std::string("image
.jpg")));
6
7 // Cast it to float, normalize to range [0, 1], and add batch_dimension
8 input = cppflow::cast(input, TF_UINT8, TF_FLOAT);
9 input = input / 255.f;
10 input = cppflow::expand_dims(input, 0);
11
12 // Run
13 auto output = model(input);
14
15 // Show the predicted class
16 std::cout << cppflow::arg_max(output, 1) << std::endl;
You can take a look to the examples to see a full example on how to load a deep network and feed it
with a sample image.
CppFlow uses Tensorflow C API to run the models, meaning you can use it without installing Tensor‑
flow and without compiling the whole Tensorflow repository with bazel, you just need to download
the C API. With this projectyou can manageand run yourmodels in C++ without worrying about void,
malloc or free. With CppFlow you easily can:
• Open saved models created with Python
• Execute Tensorflow neural networks in C++
• Perform tensor manipulation directly from C++
How To Run It
Since it uses TensorFlow 2 C API you just have to download it, check the docs to see a guide on how
to do it.
1

| 1 // Read the graph                                                       |
|:--------------------------------------------------------------------------|
| 2 cppflow::model model("saved_model_folder");                             |
| 3                                                                         |
| 4 // Load an image                                                        |
| 5 auto input = cppflow::decode_jpeg(cppflow::read_file(std::string("image |
| .jpg")));                                                                 |
| 6                                                                         |
| 7 // Cast it to float, normalize to range [0, 1], and add batch_dimension |
| 8 input = cppflow::cast(input, TF_UINT8, TF_FLOAT);                       |
| 9 input = input / 255.f;                                                  |
| 10 input = cppflow::expand_dims(input, 0);                                |
| 11                                                                        |
| 12 // Run                                                                 |
| 13 auto output = model(input);                                            |
| 14                                                                        |
| 15 // Show the predicted class                                            |
| 16 std::cout << cppflow::arg_max(output, 1) << std::endl;                 |

Afterwards, you can install the library:
1 git clone git@github.com:serizba/cppflow.git
2 cd cppflow/examples/load_model
3 mkdir build
4 cd build
5 cmake ..
6 make -j
7 make install
Now you can check the quickstart guide to run a program using cppflow.
Documentation
Check the docs at https://serizba.github.io/cppflow/.
There you can find quickstart guides and more information about how to install the library and run
the examples.
Development
CppFlowisbasicallyawrapperoverTensorflowCAPI.Thebasicclass,tensorisawrapperofaTFeager
tensor, and it just constains a pointer to its TF representation.
TheTFCAPIprovidesthetoolstocallalltheTFrawops,butusingthemisconfusing. CppFlowincludes
a facade over these functions, so they can be called easily as normal C++ functions. To achieve this,
the file ops contains (mostly) all the TF raw ops functions, but with a simple C++ interface. This file
has been generated automatically using a small script.
CppFlow also includes a wrapper on TF saved models, the model class, so they can be easily opened
and executed.
Contributors
If you are willing to contribute to this project, please go ahead an visit the development roadmap of
cppflow. Specially contributor_wanted labelled PR or issues are very welcome to new contrib‑
utors.
Citation
If you use this code or find this work useful in your research, please cite us:
2

| 1 git clone git@github.com:serizba/cppflow.git   |
|:-------------------------------------------------|
| 2 cd cppflow/examples/load_model                 |
| 3 mkdir build                                    |
| 4 cd build                                       |
| 5 cmake ..                                       |
| 6 make -j                                        |
| 7 make install                                   |

1 @software{
2 izquierdo2019cppflow,
3 author = {Izquierdo, Sergio},
4 doi = {10.5281/zenodo.7107618},
5 title = {{cppflow: Run TensorFlow models in C++ without
installation and without Bazel}},
6 url = {https://github.com/serizba/cppflow},
7 version = {2.0.0},
8 month = {5},
9 year = {2019}
10 }
Style guide
We use the Google’s C++ style guide using static code linker cpplint. We use the Google’s Python style
guide using static code linker pylint using attached pylintrc configuration.
Remark
CppFlow is not related with TensorFlow. The CppFlow icon is a modified version of the TensorFlow
logo. TensorFlow, the TensorFlow logo and any related marks are trademarks of Google Inc.
3

| 1 @software{                                              |
|:----------------------------------------------------------|
| 2 izquierdo2019cppflow,                                   |
| 3 author = {Izquierdo, Sergio},                           |
| 4 doi = {10.5281/zenodo.7107618},                         |
| 5 title = {{cppflow: Run TensorFlow models in C++ without |
| installation and without Bazel}},                         |
| 6 url = {https://github.com/serizba/cppflow},             |
| 7 version = {2.0.0},                                      |
| 8 month = {5},                                            |
| 9 year = {2019}                                           |
| 10 }                                                      |