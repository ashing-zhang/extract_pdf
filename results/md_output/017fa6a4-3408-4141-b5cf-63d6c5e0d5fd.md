POSITIVITY OF INTERSECTION MULTIPLICITY OVER A
TWO-DIMENSIONAL BASE
8102 luJ 13  ]CA.htam[  2v64150.0151:viXra
C. SKALIT
Abstract. We prove the positivity of Serre’s Intersection Multiplicity for reg-
ular local rings that are essentially smooth over a two-dimensional, regular
base. Afterward, we apply this result to prove a transversality theorem for
unramified regular local rings via a local analysis on the blowup.
1. Introduction
Given a regular local ring A and two finitely-generated A-modules M and N
whose supports intersect in a single point, Serre [Ser65] defines the intersection
multiplicity of M and N via the (necessarily finite) sum
χA(M,N) := (−1)iℓ(TorA (M,N)).
i
X
i≥0
This formula, which prescribes how to multiply properly intersecting algebraic cy-
cles, has served as the focal point for one of the long-standing conjectures in the
homological theory of commutative rings:
Conjecture 1.1 (Serre’s Conjecture). Let A be a regular local ring, and suppose
that M and N are finitely-generated A modules such that ℓ(M ⊗ N) < ∞. Then
A
(a) dimM + dimN ≤ dimA. (Decency of intersection)
(b) χA(M,N) ≥ 0. (Non-negativity)
(c) χA(M,N) = 0 if dimM + dimN < dimA. (Vanishing)
(d) χA(M,N) > 0 if dimM + dimN = dimA. (Positivity)
While part (a) was settled by Serre [ibid] using only the Cohen Structure Theo-
rem, the proofs of the other parts of the conjecture in full generality have borrowed
techniques from far outside the realm of commutative algebra. Part (b), which is
due to Gabber [Hoc97, Ber97], uses de Jong’s method of producing a generically-
finite resolution of singularities [dJ96] to reduce the non-negativity of χA to showing
that a certain vector-bundle is globally-generated. The vanishing in part (c) has
been deduced by Gillet-Soul´e [GS85, GS87] via K-theoretic techniques while a com-
pletely different proof by Paul Roberts [Rob85] uses his machinery of local Chern
characters.
The Main Theorem. The general case of (d), which we shall henceforth refer to
as Serre’s Positivity Conjecture, still remains open. While some low-dimensional
cases have been resolved, the most general result in this direction is Serre’s [Ser65],
which states that if (the completion of) A is a power series ring over a field or
2010 Mathematics Subject Classification. Primary: 13D22. Secondary: 14C17.
Keywords: Intersection multiplicity, Power-series, Blowup, Tangent cone.
1

2 C. SKALIT
complete discrete valuation ring, then positivity holds. The central aim of this
paper is to extend this result to power series over a two-dimensional base:
Theorem A. Let (R,m) be a complete, regular local ring of dimension two, and
let A = R[[X ,··· ,X ]]. If M and N are finitely-generated A-modules satisfying
1 m
dimM + dimN = dimA and ℓ(M ⊗ N) < ∞, then χA(M,N) > 0.
A
For R any complete, regular local ring and A = R[[X ,··· ,X ]], there is a
1 m
reduction to the diagonal spectral sequence
b R
E2 = TorA⊗ RA ((A⊗ A)/∆,Tor (M,N)) ⇒ TorA (M,N)
pq p R q p+q
where ∆ is the diagonal ideal givben by thedkernel of the multiplication map A⊗ A ։
R
A. When Serre proves the positivity for the case of R a DVR, he shows that one
b
can assume that M is R-flat, meaning that this spectral sequence degenerates to
give isomorphisms
b
A⊗ A ∼ A
Tor R ((A⊗ A)/∆,M⊗ N) = Tor (M,N),
p R R p
thus permitting us to realize χAb as e (M⊗bN), the Hilbert-Samuel multiplicity of
∆ R
M⊗ N with respect to ∆.
R
b
In our situation, when R is two-dimensional, we can no longer be assured that
b
the spectral sequence degenerates; and as a result, χA(M,N) sees contributions
R
from the Hilbert-Samuel multiplicities of each of the higher Tor (M,N) modules:
i
2 d
R
χA(M,N) = (−1)ie (Tor (M,N))
∆ i
X
i=0
d
R R
(where, by convention, e (Tor (M,N)) = 0 if dim(Tor (M,N)) < n). Reduction
∆ i i
R
to the case where Tor (M,N) = 0 is fairly routine (cf. Lemma 3.3 below); thus,
2 d d
R
the chief obstruction to the positivity of χA(M,N) is precisely the Tor (M,N)
d 1
term. Much of the proof of Theorem A is devoted to showing that this module
d
is sufficiently “small” in the appropriate sense. Somewhat surprisingly, Gabber’s
non-negativity theorem plays a crucial role in achieving this end (Corollary 2.5).
After recalling some generalities concerning completed Tor in Section 2, we prove
Theorem A over the course of Sections 3 and 4.
As an immediate application of Theorem A, we prove that Serre’s Positivity
Conjecture holds for the local rings of a smooth scheme over a two dimensional
base:
Corollary B. Let f : X → Y be a smooth morphism of schemes with Y regular
of dimension at most 2. Then every local ring O satisfies Serre’s Positivity
X,x
Conjecture.
The proof proceeds by reducing to the case of a power series ring. However, given
an essentially smooth map of local rings O → O , one cannot immediately
Y,f(x) X,x
conclude that O is a power series ring if the residue field extension k(x)/k(f(x))
X,x
is inseparable. Some care is required to modify O and O in such a way
Y,f(x) X,x
b
that introduces separability without losing too much information. We address this
technique in Section 5.

POSITIVITY OF INTERSECTION MULTIPLICITY OVER A TWO-DIMENSIONAL BASE 3
Detecting Transversality. Our second application is best phrased in geometric
language. Let X = SpecA where A is a regular local ring, and suppose that Y and
Z are closed, integral subschemes that meet in a single point and whose dimensions
add up to dimX. When A contains a field, Serre’s proof of positivity actually
shows that χO X(O ,O ) ≥ e(O )e(O ). (Here, e(O ) and e(O ) are just the
Y Z Y Z Y Z
Hilbert-Samuel multiplicities of O and O with respect to the maximal ideal.) In
Y Z
[Ska15] we show that this bound also holds when A is of mixed-characteristic and
unramified. Since e(O ) = 1 precisely when Y is regular (and likewise for Z), the
Y
inequality χO X(O ,O ) ≥ e(O )e(O ) is saying that intersection multiplicity is
Y Z Y Z
sensitive to the singularities on Y and Z.
With this lower bound established (at least in the unramified case), it is nat-
ural to ask under what circumstances the intersection multiplicity is minimized.
If we carry over the intuition from B´ezout-type theorems in Pn, we would expect
C
χO X(O ,O ) = e(O )e(O ) precisely when Y and Z meet “transversely” — that
Y Z Y Z
is, when their tangent cones intersect trivially.1 Algebraically, this amounts to
saying that grO ⊗ grO is zero-dimensional. One direction of this impli-
Y grO Z
X
cation, that a transverse intersection implies the equality, is a result of Tennison
[Ten79] and holds for any regular local ring A. In [Ska15] we put forth the following
conjecture which asserts that χO X alone is enough to detect transversality:
Conjecture 1.2 (Transversality Conjecture). Let A be a regular local ring, and let
X = SpecA with Y and Z be as above. Then χO X(O ,O ) ≥ e(O )e(O ) with
Y Z Y Z
equality if and only if the tangent cones of Y and Z intersect trivially.
As in [Ska15], we shall restrict our attention to the case were A is unramified (and
hence the inequality χO X(O ,O ) ≥ e(O )e(O ) is already known to hold). Our
Y Z Y Z
main technique for exploring this conjecture is to construct the blowup φ : X → X
of X along its closed point and then consider the strict transforms Y and Z on X.
e
Set-theoretically, Y ∩ Z agrees with the intersection of the projectivized tangent
e e e
cones of Y and Z, which can be measured quantitatively via the formula [Ful98,
e e
20.4.3]:
O O
χ X(O ,O Z) = e(O )e(O Z) + χ Xf(O Ye,O Ze)
Y Y
whose “error term” is given by
χO Xf(O e,O e) := (−1)i+jℓ(Hi(X,TorO Xf (O e,O e))).
Y Z j Y Z
X
i,j≥0
e
Proving our conjecture therefore amounts to showing that χO Xf(O e,O e) > 0 pre-
Y Z
cisely when Y ∩ Z 6= ∅. While blowing up simplifies our problem conceptually, it
introduces the algebraic obstacle of ramification. If (A,n) is an unramified regular
e e
local ring with p ∈ n − n2, then X the blowup along n will be ramified along a
certain two-dimensional subscheme (see Corollary 6.2). Nonetheless, as we show
e
in Proposition 6.4, each of these local rings completes to a power series over a
two-dimensional base, thereby allowing us to invoke Theorem A and conclude:
Corollary C. Let (A,n) be an unramified regular local ring. Put X = SpecA and
let X be the blowup along n. Then Serre’s Positivity Conjecture holds at every local
ring O .
e
e X,x
1 We are not assuming that Y, Z, or Y ∩ Z are non-singular; for us, “transverse” is solely a
condition on the dimension of the intersection of the tangent cones.

4 C. SKALIT
By our previous work in [Ska15], if A is an unramified regular local ring, Conjec-
ture 1.2 is known to hold in many circumstances (see Theorem 6.5 below). When
Y and Z meet properly (i.e. as a finite — possibly empty — set of points), we can
calculate χO Xf(O e,O e) in terms of intersection multiplicities on the stalks of O e.
e e Y Z X
Since Corollary C assures us that each of these multiplicities will be positive, we
now have
Corollary D. Let (A,n) be an unramified regular local ring. Let X = SpecA
and let Y and Z be closed, integral subschemes such that ℓ(O ⊗ O ) < ∞
Y O Z
X
and dimY + dimZ = dimX. Suppose that χO X(O ,O ) = e(O )e(O ). If
Y Z Y Z
dim(grO ⊗ grO ) ≤ 1, then, in fact, dim(grO ⊗ grO ) = 0.
Y grO Z Y grO Z
X X
2. Generalities for Complete Tensor Products
The basic reference for this section is [Ser65, V]. Let (R,m) be a complete regular
local ring and let A = R[[X ,··· ,X ]] and B = R[[Y ,··· ,Y ]]. For finitely-
1 m 1 n
generated A and B modules M and N, recall that we define the “completed-Tor
functors” via the formula:
R
limTorR (M/mp M,N/mq
Tor (M,N) := N)
i i A B
←−
p,q
d
where m and m denote the maximal ideals of A and B. When M is fixed, the
A B
R
functors Tor (M,−) define a δ-functor from the category of finitely-generated B-
i
modules to the category of finitely-generated A⊗ B-modules. Indeed, from the
R
d
Artin-Rees lemma, it is easy to deduce that a short exact sequence 0 → N′ →
b
N → N′′ → 0 of finitely-generated A modules gives rise to the expected long exact
sequence in Tor. Furthermore, the completed torsion functors exhibit the following
depth-sensitivity property that we shall repeatedly exploit:
d
Proposition 2.1. [Ser65, V-9(g)] With R, A, B, and M as above, suppose that
R
(x ,···x ) ⊂ m ⊂ R is an M-regular sequence. Then Tor (M,E) = 0 for all
1 r j
j > dimR − r and all finitely-generated B-modules E.
d
As an R-module, B admits a regular sequence of length equal to the dimension
R
of R. Thus, by Proposition 2.1, we see that Tor (M,P) vanishes for i > 0 and
i
P any projective B-module of finite rank. At once we see that our δ-functor is
d
coeffaceable and hence universal (cf. [Wei94, §2.4], [Gro57]):
Proposition 2.2. [Ser65, V-10] Let R, A, B, and M be as above. Then the
R
Tor (M,−) are the left-derived functors of M⊗ −.
i R
Ldemma 2.3. Let R, A, and B be as above andbput C = A⊗ B. Then for finitely-
R
generated A and B modules M and N, there are canonical identifications for all
b
p:
R
C ∼
Tor (M⊗ B,A⊗ N) = Tor (M,N).
p R R p
Proof. Let C = A⊗ B. Considber the fbunctors d
R
F : f.gb.B − mod −→ f.g.C − mod N 7→ A⊗ N
R
G : f.g.C − mod −→ f.g.C − mod E 7→ (M⊗ B) ⊗ E
R C
b
b

POSITIVITY OF INTERSECTION MULTIPLICITY OVER A TWO-DIMENSIONAL BASE 5
It is clear that F maps projectives to projectives and that G(F(N)) is naturally
isomorphic to M⊗ N. Invoking Proposition 2.2 and the spectral sequence for the
R
composition of functors, we have
b
R
E2 = L G(L F(N)) ⇒ L (GF)(N) = Tor (M,N).
pq p q p+q p+q
On the other hand, F is exact, so the spectral sequenceddegenerates to give isomor-
phisms
R
C ∼ ∼
Tor (M⊗ B,A⊗ N) = L G(F(N)) = Tor (M,N).
p R R p p
(cid:3)
b b d
Corollary 2.4. With the notations of Lemma 2.3, there are inclusions
R
Supp(Tor (M,N)) ⊂ Supp(M⊗ N)
i R
where the supports are regardded as subsets of SpecC =bSpecA⊗ RB.
Proof. This follows from Lemma 2.3 and the basic fact that bfor any two finitely-
C
generated C-modules E and E , the Tor (E ,E ) vanish outside of Supp(E ⊗
1 2 i 1 2 1 C
(cid:3)
E ).
2
We shall require finer information than merely knowing the supports of the
R
Tor (M,N). The next result, which follows from Gabber’s celebrated non-negativity
i
R
theorem [Hoc97], allows us to extract cycle-theoretic information about the Tor (M,N)
d i
in terms of the multiplicities with which their minimal components appear.
d
Corollary 2.5. Suppose that (R,m) be a complete, regular local ring. Let A =
R[[X ,··· ,X ]] and B = R[[Y ,··· ,Y ]]. Suppose M and N are finitely-generated
1 m 1 n
A and B modules respectively. Then for every prime p ⊂ A⊗ B minimal in the
R
support of M⊗ N, there is an inequality
R
b
∞
b R
(−1)iℓ(Tor (M,N)) ≥ 0
i p
X
i=0
d
Proof. From Corollary 2.4, we know that for any minimal p ∈ Supp(M⊗ N),
R
R
Tor (M,N) will be a finite-length (A⊗ B) -module. Thus, the alternating sum
i p R p b
defined above is a well-defined number. Now, by Lemma 2.3, we have, for i ≥ 0,
d b
isomorphisms
R
C ∼
Tor (M⊗ B,A⊗ N) = Tor (M,N)
i R R i
where C = A⊗ B. The advantage this perspective is that localizing the left-hand
R b b d
side at p is well-understood:
b
R
TorC p((M⊗ B) ,(A⊗ N) ) ∼ = Tor (M,N) .
i R p R p i p
Since the right-hand side is a bfinite-leng bth module,dthe supports of the C modules
p
(M⊗ B) and (A⊗ N) meet at a single point, so by Gabber’s non-negativity of
R p R p
intersection multiplicity, we have
b b
∞
R
(−1)iℓ(Tor (M,N) ) = χC p((M⊗ B) ,(A⊗ N) ) ≥ 0.
i p R p R p
X
i=0
d b b
(cid:3)

6 C. SKALIT
The last ingredient we shall need is the so-called “reduction to the diagonal”
spectral sequence. It appears in [Ser65, V-12] for the case when R is 1-dimensional,
but its derivation at no point uses any dimensionality assumption.
Proposition 2.6. Let R be as above and suppose that A = R[[X ,··· ,X ]]. Let
1 m
A⊗ A → A : x⊗y 7→ xy be the canonical surjection, and let ∆ be its kernel. Then
R
for any pair of finitely-generated A-modules M and N, there is a convergent spectral
b b
sequence
b R
E2 = TorA⊗ RA ((A⊗ A)/∆,Tor (M,N)) ⇒ TorA (M,N).
pq p R q p+q
b d
3. The Two-Dimensional Case
3.1. Geometry of Completed Tensor Products. We begin with a lemma which
is a mild generalization of a well-known flatness criterion for Cohen-Macaulay
schemes over a regular base (cf. [Mat86, 23.1]):
Lemma 3.1. Let R → O be a local homomorphism of Noetherian local rings where
(R,m) is regular of dimension 2 and O is normal. Then O is R-flat if and only if
dim(O/mO) = dimO − 2.
Proof. If O is R-flat, then the desired equality follows from the classical formula for
fibre-dimension of a flat morphism [Mat86, 15.1]. For the converse, let us suppose
that m = (s,t). Since R/(s,t) is a field, it will suffice, by invoking the local
flatness criterion [Har77, III.10.3.A], to show that (s,t) is an O-regular sequence.
Recall that a ring B satisfies Serre Condition S if for all p ∈ SpecB, depthB ≥
n p
min{n,dimB }. It follows that for n > 0, any ring satisfying S can have no
p n
embedded primes. Now, O is normal by assumption and therefore satisfies S . As
2
O/(s,t)O has dimension dimO − 2, we conclude that s lies outside every minimal
prime of O and hence, by the S condition, outside every associated prime. Thus,
2
s is a non-zerodivisor on O, and it is easily seen that O/sO satisfies S . It follows
1
(cid:3)
by the same reasoning that t is O/sO-regular, completing the proof.
Proposition 3.2. Let (R,m) be a complete 2-dimensional regular local ring and
suppose that A = R[[X ,··· ,X ]] and B = R[[Y ,··· ,Y ]]. Let O and O be
1 m 1 n 1 2
finite A and B-algebras which are domains. Then dim(O ⊗ O ) ≥ dim(O ) +
1 R 2 1
dim(O ) − 2.
2
b
Proof. First, observe that since each O is complete, it then follows that the nor-
i
∼
malization O is finite over O . From this, we obtain the isomorphism O ⊗ O =
i i 1 R 2
O ⊗ (O ⊗ O ) and the corresponding fibre diagram:
1 O1 1 R 2
e e b
e b
SpecO ⊗ O // SpecO
1 R 2 1
e b e
(cid:15)(cid:15) (cid:15)(cid:15)
SpecO ⊗ O // SpecO
1 R 2 1
Since the normalization SpecO b→ SpecO is finite and surjective, so too is
1 1
SpecO ⊗ O → SpecO ⊗ O . Similarly SpecO ⊗ O → SpecO ⊗ O is also
1 R 2 1 R 2 1 R 2 1 R 2
e
finite and surjective whence we obtain the equalities
e b b e b e e b
dimO ⊗ O = dimO ⊗ O = dimO ⊗ O .
1 R 2 1 R 2 1 R 2
b e b e b e

POSITIVITY OF INTERSECTION MULTIPLICITY OVER A TWO-DIMENSIONAL BASE 7
We are therefore free to assume that both O and O are normal.
1 2
Case 1: (Assume O is R-flat.) Let m = (s,t) and let R be the DVR R/sR.
1
We then have an isomorphism:
O ⊗ O O O
1 R 2 ∼ 1 2
= ⊗ .
s(O ⊗ O ) (cid:18)sO (cid:19) R (cid:18)sO (cid:19)
1b R 2 1 2
b
Since O 1/sO is flat over R,bit follows from [Ska15, 2.1(b)] that
1
O O O O O
1 2 1 2 2
dim ⊗ = dim +dim −1 = dimO +dim −2.
(cid:18)sO (cid:19) R (cid:18)sO (cid:19) (cid:18)sO (cid:19) (cid:18)sO (cid:19) 1 (cid:18)sO (cid:19)
1 2 1 2 2
b
By the flatness of O over R, we see that s either annihilates O ⊗ O or acts as a
1 1 R 2
non-zerodivisor, depending on how s acts on the domain O . In either case, we get
2
b
an equality
dim(O ⊗ O ) = dimO + dimO − 2.
1 R 2 1 2
Case 2: (Assume that neither O nor O is R-flat.) Since we are assuming that
b 1 2
the O are normal, we have that dim(O /mO ) ≥ dimO −1 for i = 1,2 by Lemma
i i i i
3.1. Putting k = R/m, we have the isomorphism
O ⊗ O O O
1 R 2 ∼ 1 2
= ⊗
k
m(O ⊗ O ) mO mO
1b R 2 1 2
b
and therefore
b
O ⊗ O
1 R 2
dim(O ⊗ O ) ≥ dim
1 R 2
(cid:18)m(O ⊗ O )(cid:19)
1b R 2
b O O
1 2
= dim + dim ≥ dimO + dimO − 2.
b 1 2
(cid:18)mO (cid:19) (cid:18)mO (cid:19)
1 2
(cid:3)
3.2. Some Additional Vanishing Results. The following vanishing result for
completed Tor uses a technique which is similar in spirit to Proposition 3.3 in
[Hoc75].
Lemma 3.3. Let (R,m) be a complete 2-dimensional regular local ring. Suppose
that A = R[[X ,···X ]] and B = R[[Y ,···Y ]]. Suppose that O and O are
1 m 1 n 1 2
domains, finite over A and B respectively. Let J = ker(R → O ).
i i
R R
(a) If J 6= m, then Tor (O ,−) = 0. Similarly, Tor (−,O ) = 0 if J 6= m.
1 2 1 2 2 2
R
(b) If J ,J 6= m and J 6= J , then Tor (O ,O ) = 0.
1 2 d1 2 1 1 2d
Proof. (a) If J 6= m and O is a domadin, we can choose some g ∈ m that is a
1 1
non-zerodivisor on O . The result now follows from Proposition 2.1.
1
(b) Without loss of generality, assume J 6⊂ J . Choose some nonzero f ∈ J − J
1 2 1 2
and consider the exact sequence
f
0 → O → O → O → 0
2 2 2
where O = O /(fO ). Applying O ⊗ − gives a long exact sequence in Tor
2 2 2 1 R
(Proposition 2.2):
b d
R R f R
··· → Tor (O ,O ) → Tor (O ,O ) → Tor (O ,O ) → ···
2 1 2 1 1 2 1 1 2
d d d

8 C. SKALIT
R R
From part (a), Tor (O ,O ) = 0. Hence, f is a non-zerodivisor on Tor (O ,O ).
2 1 2 1 1 2
R
On the other hand, f ∈ J must annihilate Tor (O ,O ), thereby forcing this
d 1 1 1 2 d
(cid:3)
module to be 0.
d
Lemma 3.4. Let (R,m) be a complete 2-dimensional regular local ring. Suppose
that A = R[[X ,···X ]] and B = R[[Y ,··· ,Y ]]. Suppose that O and O are
1 m 1 n 1 2
domains, finite over A and B respectively. Let J = ker(R → O ), and suppose
i i
that J = J = (0). Let φ : R → A⊗ B be the canonical map and let p ∈
1 2 R
R
Supp(O ⊗ O ) be a minimal prime. If φ−1(p) 6= (0), then p ∈/ Supp(Tor (O ,O )).
1 R 2 b 1 1 2
Proof. Lebt 0 6= f ∈ φ−1(p). As in the proof of Lemma 3.3, form the edxact sequence
f
0 → O → O → O → 0
2 2 2
and consider the long exact sequence
R R f R
··· → Tor (O ,O ) → Tor (O ,O ) → Tor (O ,O ) → ···
2 1 2 1 1 2 1 1 2
Rd d d
Once again, Tor (O ,O ) = 0 thanks to Lemma 3.3(a); so f is a non-zerodivisor
2 1 2
R R
on Tor (O ,O ). Since Supp(Tor (O ,O )) ⊂ Supp(O ⊗ O ) by Corollary 2.4,
1 1 d2 1 1 2 1 R 2
R
we see that if p ∈ Supp(Tor (O ,O )), then it would have to be minimal. Thus
d 1 d1 2 b
R
Tor (O ,O ) is Artinian (or zero). Since f ∈ φ−1(p), f is a non-unit in (A⊗ B)
1 1 2 p d R p
R R
and therefore must act nilpotently on Tor (O ,O ) . We conclude that Tor (O ,O ) =
d 1 1 2 p 1 b 1 2 p
(cid:3)
0.
d d
4. Proof of the Main Theorem
Lemma 4.1. Let (R,m) be a complete 2-dimensional regular local ring. Suppose
that A = R[[X ,···X ]]. Suppose that O and O are domains, finite over A, such
1 m 1 2
that dimO + dimO = dimA and ℓ(O ⊗ O ) < ∞. Put J = ker(R → O ).
1 2 1 A 2 i i
Then J = J if and only if J = J = (0).
1 2 1 2
Proof. Suppose that J = J 6= (0). Since the J are prime ideals and R is a UFD,
1 2 i
we can find a prime element 0 6= f ∈ J = J . Put S = R/fR and consider the
1 2
˜ ˜
integral closure S in its field of fractions. Since S is complete, S → S is a finite
˜ ˜
morphism, thereby forcing S to be a local domain. Since S has dimension 1, S is
a DVR.
Put B = S[[X ,···X ]]. By assumption, each O is a finite B-module. Let B′ =
1 m i
S˜ [[X ,··· ,X ]], which is finite over B; therefore, the extensions O′ := O ⊗ B′ are
1 m i i B
finite over O . Now, O′ ⊗ O′ is Artinian by virtue of being finite over O ⊗ O .
i 1 B′ 2 1 B 2
Since B′ is a regular local ring, we must have dimO′ + dimO′ ≤ dimB′ < dimA
1 2
by the decency condition (a) of Serre’s Conjecture (see [Ser65, V-18, Thm. 3]).
From the argument used in Proposition 3.2, SpecO′ → SpecO is finite-surjective
i i
because SpecB′ → SpecB is. Hence, dimO′ = dimO , thereby contradicting the
i i
(cid:3)
fact that dimO + dimO = dimA.
1 2
Theorem A. Let (R,m) be a complete regular local ring of dimension 2. Let
A = R[[X ,···X ]]. Suppose that M and N are finitely-generated A-modules such
1 m
that ℓ(M ⊗ N) < ∞ and dimM + dimN = dimA. Then χA(M,N) > 0.
A

POSITIVITY OF INTERSECTION MULTIPLICITY OVER A TWO-DIMENSIONAL BASE 9
Proof. Recall that if p ∈ Ass(M), we have a short exact sequence
′′
0 → A/p → M → M → 0
Proceeding inductively and using the biadditivity of χA(−,−), we are reduced to
proving the claim for M = A/p and N = A/q where p and q are primes. Next, we
observe that A/p is complete, making the map to the normalization A/p → A/p
finite. If we consider the exact sequence
g
0 → A/p → A/p → C → 0,
we see that dimC < dimA/p as A/p →gA/p is generically an isomorphism. Re-
peating the argument for N = A/q and invoking the vanishing result (c) of Serre’s
g
Conjecture shows that χA(A/p,A/q) = χA(A/p,A/q). It therefore suffices to prove
the theorem for M = O and N = O where each O has the structure of a normal
1 2 i
g g
integral domain. Of the two main cases to consider, let us first dispense with the
trivial one.
Case 1: (m · O = 0). For this, we let π ∈ m − m2 and put A = A/πA. Note
1
that π cannot annihilate O ; otherwise, both O and O would be supported on A.
2 1 2
Since part (a) of Conjecture 1.1 is known to hold in full generality, it would then
follow that dimO + dimO ≤ dimA < dimA. Since π is O -regular, the base
1 2 2
change-spectral sequence
E2 = TorA (O ,TorA (O ,A)) ⇒ TorA (O ,O )
pq p 1 q 2 p+q 1 2
degenerates to give isomorphisms
A ∼ A
Tor (O ,O ) = Tor (O ,O )
p 1 2 p 1 2
and therefore an equality χA(O ,O ) = χA(O ,O ). Since A is a power series over
1 2 1 2
the DVR R/πR, the right hand side is known to be positive from the work of Serre.
Case 2: (m·O 6= 0). Let ∆ be the kernel of the canonical surjection A⊗ A → A.
1 R
Clearly, ∆ is generated by the A⊗ A-regular sequence X ⊗1 − 1⊗X .
R i i
b (1≤i≤m)
(cid:8) (cid:9)
We therefore obtain, for any A⊗ A-module L, isomorphisms
R b b b
b
A⊗ A ∼
Tor R b((A⊗ A)/∆,L) = H (∆,L)
i R i
where the right-hand side is Koszul homology with respect to the sequence defining
b
∆. Recall that if ℓ(L/∆L) < ∞, then by a classical result of Serre [Ser65, IV-12],
m m
b
(−1)iℓ(TorA⊗ RA ((A⊗ A)/∆,L)) = (−1)iℓ(H (∆,L)) = e (L,m)
i R i ∆
X X
i=0 i=0
b
where e (L,m) is 0 when dimL < m and coincides with the Hilbert-Samuel multi-
∆
plicity of L with respect to ∆ otherwise.
We now consider the reduction to the diagonal spectral sequence (Proposition
2.6):
b R
E2 = TorA⊗ RA ((A⊗ A)/∆,Tor (O ,O )) ⇒ TorA (O ,O )
pq p R q 1 2 p+q 1 2
b
Note that TorA⊗ RA ((A⊗ A)/b∆,O ⊗ Od) = O ⊗ O and thus is Artinian. Since
0 R 1 R 2 1 A 2
we have by Corollary 2.4 that Supp(Tor (O ,O )) ⊂ Supp(O ⊗ O ), we conclude
i 1 2 1 R 2
b b
that every term on the E2 page of our spectral sequence has finite length. Further-
d b
more, the E∞ page is just the associated graded of TorA (O ,O ) with respect to
∗ 1 2

10 C. SKALIT
the filtration induced by the spectral sequence, so we can compute χA(O ,O ) by
1 2
summing over the E∞ page:
χA(O ,O ) = (−1)p+qℓ(E∞ )
1 2 pq
X
p,q≥0
= (−1)p+qℓ(E2 )
pq
X
p,q≥0
b R
= (−1)q (−1)pℓ(TorA⊗ RA ((A⊗ A)/∆,Tor (O ,O )))
p R q 1 2 .
X X
q≥0 p≥0
R b d
= (−1)q (−1)pℓ(H (∆,Tor (O ,O )))
p q 1 2
X X
q≥0 p≥0
d
R
= (−1)qe (Tor (O ,O ),m)
∆ q 1 2
X
q≥0
d
Once again, let J = ker(R → O ). By hypothesis J 6= m. We may assume
i i 1
that J 6= m; otherwise, we are back in the situation of Case 1. By Lemma 3.3(a),
2
R
Tor (O ,O ) = 0, so our formula for intersection multiplicity becomes
2 1 2
(d *) χA(O ,O ) = e (O ⊗ O ,m) − e (TorR (O ,O ),m).
1 2 ∆ 1 R 2 ∆ 1 1 2
b R d
If J 6= J , then by Lemma 3.3(b), Tor (O ,O ) = 0. Note that dim(O ⊗ O ) =
1 2 1 1 2 1 R 2
m: Lemma 3.2 shows the dimension is bounded below by dimO +dimO −2 = m;
1 2
d b
the reverse inequality follows from the fact that (O ⊗ O )/∆ is Artinian. In this
1 R 2
case, it follows that χA(O ,O ) = e (O ⊗ O ,m) > 0. We therefore need only
1 2 ∆ 1 R 2
b
consider what can happen when J = J , and by Lemma 4.1, we are reduced to the
1 2
b
case where J = J = (0).
1 2
R
Since Supp(Tor (O ,O )) ⊂ Supp(O ⊗ O ) by Corollary 2.4, we can apply the
1 1 2 1 R 2
associativity formula for Hilbert-Samuel multiplicity [Ser65, V-2] to (*) and obtain
d b
the formula:
R
χA(O ,O ) = ℓ((O ⊗ O ) ) − ℓ(Tor (O ,O ) ) e ((A⊗ A)/p,m).
1 2 1 R 2 p 1 1 2 p ∆ R
Xbh i
p∈Supp(O1⊗ RO2)
b d b
b
dim((A⊗ A)/p)=m
R
From Lemma 2.5, we know that for each p satisfying dim((A⊗ A)/p) = m,
R
R
b
ℓ((O ⊗ O ) ) − ℓ(Tor (O ,O ) ) ≥ 0.
1 R 2 p 1 1 2 p
It therefore suffices to showb that there dexists at least one m-dimensional prime
R
q ∈ Supp(O ⊗ O ) for which Tor (O ,O ) = 0. If either O or O is R-flat,
1 R 2 1 1 2 q 1 2
R
then, of course Tor (O ,O ) vanishes, and the positivity of χA(O ,O ) is obvious.
b 1 1 2 d 1 2
If neither are flat, then by invoking the normality of the O , we must have that
i
d
dim(O /mO ) = dimO − 1 (Lemma 3.1). Hence,
i i i
O ⊗ O O O
1 R 2 1 2
dim = dim + dim = dimO + dimO − 2 = m.
1 2
(cid:18)m(O ⊗ O )(cid:19) (cid:18)mO (cid:19) (cid:18)mO (cid:19)
1b R 2 1 2
Since O ⊗ Ob is also m-dimensional, we conclude that m(O ⊗ O ) lies within a
1 R 2 1 R 2
minimal prime q ∈ Supp(O ⊗ O ) such that dim((A⊗ A)/q) = m. By Lemma
1 R 2 R
b b
R
(cid:3)
3.4, it follows that Tor (O ,O ) = 0, and the proof is complete.
1 1 b2 q b
d

POSITIVITY OF INTERSECTION MULTIPLICITY OVER A TWO-DIMENSIONAL BASE 11
5. Positivity of Intersections over a Two-Dimensional Base
Suppose that X → Y is a smooth morphism of Noetherian schemes where Y is
regular of dimension two. We shall prove in this section for each x ∈ X, Serre’s
Positivity Conjecture holds for O . We note that the case of a one-dimensional
X,x
base has been settled by using Fulton-MacPherson intersection theory [Ful98, Ex-
ample 20.2.2]. We shall deduce the two-dimensional case from the corresponding
result for power series rings in the previous section.
Lemma 5.1. Let (A,m) be a regular local ring. Suppose that (B,n) is a regular
local ring for which Serre’s Positivity Conjecture is known to hold. If there is a flat,
local morphism A → B with dimA = dimB, then the conjecture must also hold for
A.
Proof. Note that dim(B/mB) = 0 by hypothesis; put r = ℓ (B/mB). Given an
B
Artinian A-module E, it follows from tensoring its composition series with B that
ℓ (E ⊗ B) = rℓ (E). Hence, for any finitely-generated A-module M, the Hilbert
B A A
functions ℓ (M/mnM) and ℓ ((M ⊗ B)/mn(M ⊗ B)) = ℓ (M/mnM ⊗ B) will
A B A A B A
differ by a factor of r. The corresponding Hilbert polynomials will have the same
degree, thereby showing that dimM = dimM ⊗ B.
A
Now let M and N be two finitely generated A-modules for which ℓ(M⊗ N) < ∞
A
and dimM + dimN = dimA. These two conditions will be preserved after base-
extension to B, so χB(M ⊗ B,N ⊗ B) > 0. On the other hand,
A A
A ∼ B
Tor (M,N) ⊗ B = Tor (M ⊗ B,N ⊗ B)
p A p A A
for all p, so we have χA(M,N) = (1/r)χB(M ⊗ B,N ⊗ B) > 0. (cid:3)
A A
5.1. Structure Theorems. It is well-known that if X is a smooth variety over a
field k, then by the Cohen Structure Theorem, O is a power series ring over the
X,x
residue field k(x). When the base is no longer a field, we have a similarly-flavored
b
structure theorem, provided that we include an additional separability hypothesis.
Proposition 5.2. [Gro61, 10.3.1] Let (R ,m ) be a Noetherian local ring. Let L
0 0
be an extension field of R /m . Then there is a local ring (R,m), flat over R , such
0 0 0
that m R = m and R/m = L.
0
Lemma 5.3. Let (R,m) → (A,n) be a flat, local morphism of local rings and that
the induced map on residue fields is separable.
(a) The standard map R → Aˆ factors through a complete local ring (R′,m′),
which is flat over R and satisfies R′/mR′ = R′/m′ = A/n.
(b) If R, A, and A/mA are regular, then Aˆ ∼ = R′[[X ,··· ,X ]] and d =
1 d
dim(A/mA).
Proof. By Proposition 5.2, we can find a flat, local extension R′ of R such that
R′/mR′ = A/n. Replace R′ by its completion if necessary. As R → R′ is flat and
R/m → R′/mR′ = A/n is separable (0-smooth), R → R′ is mR′-smooth by [Mat86,
28.10].
We claim that R → Aˆ factors through R′. R′ → A/n is obtained by quotienting
by the maximal ideal. If we inductively assume that a factorization R → R′ →
A/nj has been constructed, the definition of formal smoothness (cf. [Mat86, §28]

12 C. SKALIT
guarantees a lift:
R′ // A/nj
OO
OO
""
R // A/nj+1
Since Aˆ = limA/nj, we obtain a map R′ → Aˆ that extends R → Aˆ , and (a) is
←−
j
proved.
For (b), suppose that the maximal ideal of A/mA is generated by the regular
sequence x ,··· ,x . Let x ∈ A be lifts of x . We now define φ : R′[[X ,··· ,X ]] →
1 d i i 1 d
Aˆ via X 7→ x . R′[[X ,··· ,X ]] and Aˆ are regular local rings of the same dimension
i i 1 d
ˆ ˆ
and have the same residue field. Since nA = mA+(x ,··· ,x ), φ is surjective, and
1 d
(cid:3)
its kernel must be trivial for dimensional reasons.
An essentially smooth morphism of local rings can very often fail to be separable
at the level of residue fields. Take, for example, F (T) → F (T)[X] . In these
2 2 (X2−T)
situations, we can first enlarge the residue field of the base to its perfect closure to
“force” separability and put us into a situation where Lemma 5.3 may be applied.
Lemma 5.4. Let k be a field and suppose that E/k is a finitely-generated field
extension, and L/k is algebraic. Then E ⊗ L is an Artinian ring.
k
Proof. Since k → E is essentially of finite type, so too is L → E⊗ L; hence E⊗ L
k k
is Noetherian. Since k → L is algebraic, E → E ⊗ L will be an integral extension,
k
(cid:3)
which forces dimE ⊗ L = dimE = 0.
k
Corollary 5.5. Let (R ,m ) be a regular local ring and suppose that (R ,m ) →
0 0 0 0
(A ,n ) is an essentially smooth local morphism (i.e. the localization of a smooth,
0 0
finitely-generated R -algebra). Then there exist flat extensions (R,m) of (R ,m ),
0 0 0
(A,n) of (A ,n ), and an induced map R → A such that
0 0
(1) m R = m.
0
(2) A is essentially smooth over R.
(3) n A is n-primary in A.
0
(4) Aˆ is a power series ring over a complete regular ring R′ of dimension equal
to dimR .
0
Proof. Let L be the perfect closure of the field k = R /m . By Proposition 5.2,
0 0
there is a (necessarily regular) ring (R,m) which is flat over R, has residue field L
and satisfies condition (1). The ring A ⊗ R is essentially smooth over R and hence
0 R0
regular. Since Spec(A ⊗ R) → SpecA is faithfully flat, we can find a prime
0 R0 0
ideal p that maps to n ∈ SpecA . Setting A = (A ⊗ R) , we see that A clearly
0 0 0 R0 p
satisfies (2). Next observe that by assumption, E = A /n is a finitely-generated
0 0
field extension of k. To prove (3), we note that A/n A is just the localization at p
0
of
∼ ∼ ∼
(A ⊗ R)/n (A ⊗ R) = (A ⊗ R) ⊗ A /n = E ⊗ R = E ⊗ L,
0 R0 0 0 R0 0 R0 A0 0 0 R0 k
which by Lemma 5.4 is Artinian. Since R has a perfect residue field, we can apply
(cid:3)
Lemma 5.3 and obtain (4).

POSITIVITY OF INTERSECTION MULTIPLICITY OVER A TWO-DIMENSIONAL BASE 13
Corollary B. Let f : X → Y be a smooth morphism of schemes with Y regular
of dimension at most 2. Then every local ring O satisfies Serre’s Positivity
X,x
Conjecture.
Proof. If x maps to y ∈ Y , then O is essentially smooth over O . By Corollary
X,x Y,y
5.5, there is a flat local extension (A,n) of O inside of which the maximal ideal
X,x
ˆ
of O is n-primary. Furthermore, A is a power series ring over a complete regular
X,x
local ring R′ of dimension at most 2. The claim now follows from Lemma 5.1 and
(cid:3)
Theorem A.
6. Blowups and Transversality
6.1. The Locus of Ramification. For generalities concerning blowups, we refer
the reader to [Ful98, Appx. B.6] or [Har77, II.7]. In what follows, we shall confine
ourselves to the following setting: Let (A,n) be a regular local ring and let X =
SpecA. The blowup X of X along n may be realized via X = Proj(A[nT]) where
A[nT] is the Rees Algebra ∞ niTi. From the canonical morphism φ : X → X,
e i=0 e
we have the exceptional divLisor E = φ−1(SpecA/n) = Proj(gr A), which is just
n e
a projective space over the residue field having dimension one less than X. Fix
f ∈ n − n2 and consider f ∈ n/n2. We define the closed subscheme V (f) of E via
gr A
։ n
the surjection gr A .
n
f gr A
n
Each element g ∈ n−n2 defines an affine patch D (g) of X whose coordinate ring
+
is (A[nT]) , the degree-zero part of the Z-graded ring (A[nT]) (cf. [Har77, II.2]).
(g) g
e
Here, we write a bold g for the degree-one element in A[nT]. If n = (t ,··· ,t ),
1 d
then D (g) = SpecA[t /g,t /g,··· ,t /g]. We now give a local description of V (f)
+ 1 2 d
inside of X:
Lemma 6e.1. With the above notations, V (f)∩D (g) is defined by the ideal (g,f/g)
+
inside of D (g).
+
Proof. On D (g), it is clear from the construction that g generates the exceptional
+
divisor E. Since V (f) ֒→ E, it suffices to show the ideal of the closed immersion
V (f)∩D (g) ֒→ E∩D (g) is generated by (residue of) f/g. Consider the surjection
+ +
of graded rings
gr A
։ n
gr A
n
f gr A
n
Let g be the degree-one element in n/n2. Restricting to E ∩ D (g) = D (g)
+ +
amounts to looking at the surjection
gr A
։ n
(gr A)
n (g)
(cid:18)f gr A(cid:19)
n (g)
It’s clear that f/g maps to 0; we claim that it, in fact, generates the kernel. Suppose
h/gk ∈ (gr A) maps to 0. This means that in gr A, f divides gmh for some
n (g) n
m ∈ N. Since gr A is just a polynomial ring over a field, the element f is prime.
n
If f divides g, then f/g is a unit, meaning that D (g) ∩ V (f) = ∅. Otherwise, f
+
(cid:3)
divides h, meaning that f/g divides h/g as claimed.

14 C. SKALIT
From this lemma, we can compute the “ramification locus” of f in X, that is,
the collection of points x ∈ X for which f lies in the square of maximal ideal of
e
O .
e
X,x e
Corollary 6.2. For all x ∈ X, f lies in the square of the maximal ideal of O
e
X,x
if and only if x ∈ V (f).
e
Proof. Of course, for any p ∈ SpecA, we have f ∈/ (pA )2. Since X−E is isomorphic
p
to the punctured spectrum X − {n}, we only need to consider those points x ∈ E.
e
Choose some affine patch D (g) ⊂ X containing x. By Lemma 6.1, V (f) ∩ D (g)
+ +
is cut out by the ideal (g,f/g). If x ∈ V (f), then both g and f/g lie in the the
e
maximal ideal of O , meaning that f = g · f/g is in the square. Otherwise, if
e
X,x
x ∈ E − V (f), then only g, the local equation for E lies in the maximal ideal of
O while f/g is a unit. Hence, O = O /(g) = O /(f) and the result
Xe ,x E,x Xe ,x Xe ,x
(cid:3)
follows from the fact that O and O are both regular.
E,x Xe ,x
We now specialize to the case of an unramified regular local ring. We introduce
the following slightly generalized notion from [Ska15]:
Definition 6.3. Let (R ,π) be a DVR with perfect residue field. We call a regular
0
local ring (A,n) R -unramified if R ⊂ A and π ∈ n − n2.
0 0
When R = Z , the notion of R -unramified coincides with the traditional
0 pZ 0
definition of unramified. A regular local ring of mixed-characteristic can be ramified
at p ∈ Z yet R -unramified for an appropriate choice of R . Such rings arise
0 0
naturally when we take the ring of integers O of a number field K/Q and consider
K
the local rings of a smooth O -scheme Y . If A contains a field k, and π ∈ n − n2,
K
then by taking the prime field k ⊂ k, we see that A will be R -unramified over the
0 0
subring R = k [π] ⊂ A.
0 0 (π)
Proposition 6.4. Let (R ,π) be a DVR with perfect residue field and suppose
0
that (A,n) is an R -unramified regular local ring. Let X = SpecA, X the blowup
0
along n, and V (π) the closed subscheme of the exceptional divisor E defined via
e
։
gr A gr A/π gr A. Let x ∈ X.
n n n
(a) If x ∈/ V (π), then O is a power series ring over a field or DVR.
e e
X,x
(b) If x ∈ V (π), then there exists a complete DVR (S,π) for which O is a
b e
X,x
power series over S[[U,V ]]/(UV − π).
b
Proof. (a) If x ∈/ V (π), Corollary 6.2 affirms that π lies outside of the square of the
maximal ideal of O . If π is a unit, then O contains the fraction field of R .
Xe ,x Xe ,x 0
Otherwise, O is R -unramified. In either case the result follows by appealing to
Xe ,x 0
Lemma 5.3.
(b) By part (a) of Lemma 5.3, there is a complete DVR (S,π) whose residue
field coincides with that of O and is equipped with an R -algebra morphism
Xe ,x 0
։
S → O . From Lemma 6.1, the kernel of O O is generated by
Xe ,x Xe ,x V(π),x
(g,π/g) where g is the local equation for the exceptional divisor. We now de-
b
fine S[[U,V ]]/(UV − π) → O by mapping U 7→ g and V 7→ π/g. Since
e
X,x
∼
O Xe ,x/(U,V )O Xe ,x = O V(π),x is bregular, we can now apply part (b) of Lemma 5.3
(cid:3)
to deduce the result.
b b b

POSITIVITY OF INTERSECTION MULTIPLICITY OVER A TWO-DIMENSIONAL BASE 15
Corollary C. Let (R ,π) be a DVR with perfect residue field and let (A,n) be an
0
R -unramified regular local ring. Put X = SpecA and let X be the blowup along n.
0
Then Serre’s Positivity Conjecture holds at all stalks O .
e
X,xe
Proof. By Proposition 6.4, O is a power-seriesovera zero, one, or two-dimensional
e
X,x
(cid:3)
base. The result now follows immediately from Theorem A.
b
6.2. Transversality in the Unramified Case. We now fix (R ,π) a DVR with
0
perfect residue field and an R -unramified regular local ring (A,n). We let X =
0
SpecA suppose that Y and Z are two closed integral subschemes meeting (set-
theoretically) at a point and whose dimensions add up to that of X. In this situa-
tion, we are guaranteed that χO X(O ,O ) ≥ e(O )e(O ) (see [Ska15, Thm. A]).
Y Z Y Z
Conjecture 1.2 asserts that equality holds if and only if the tangent cones of Y and
Z meet at a point — that is, dim(grO ⊗ grO ) = 0. Using Rees’ Theorem
Y grO Z
X
to connect the notion of integral closure of ideals to Hilbert-Samuel multiplicity
theory, we have been able to show that Conjecture 1.2 has an affirmative answer in
many cases:
Theorem 6.5. [Ska15, Thm. B,C,D,E]With X, Y , and Z as above, assume that
χO X(O ,O ) = e(O )e(O ).
Y Z Y Z
(a) If A contains a field, then dim(grO ⊗ grO ) = 0.
Y grO Z
X
(b) If π annihilates either O or O , then dim(grO ⊗ grO ) = 0.
Y Z Y grO Y
X
(c) If π annihilates neither O nor O , then either e(O /πO ) = e(O ) or
Y Z Y Y Y
e(O /πO ) = e(O ). Furthermore, dim(grO ⊗ O ) = 0 if any one
Z Z Z Y grO Z
X
of the following conditions holds:
(i) e(O /πO ) = e(O ) and grO has no height-one embedded primes.
Y Y Y Y
(ii) e(O /πO ) = e(O ) and e(O /πO ) = e(O )
Y Y Y Z Z Z
(iii) Either Y or Z has codimension 1.
grO
(iv) grO ⊗ grO ⊗ X is zero-dimensional.
Y grO X Z grO X πgrO X
We now recast this transversality statement in the language of blowing up. For
a more detailed discussion, consult Section 3.2 of [Ska15]. Let X, Y , and Z be the
point-blowups (i.e. along n) of X, Y , and Z. We can realize Y and Z as subschemes
e e e
of X via the strict transforms of Y and Z under φ : X → X. As reduced schemes,
e e
e (Y ∩ Z) ⊂ φ−1((Y ∩ Z) ) = φ−1({n}) = Ee= Proj(grO ) = PN
red red X k
where Ne= edimX − 1 and k = A/n. Hence as sets, Y ∩ Z coincides with the
intersection of the projectivized tangent cones E ∩ Y = Proj(grO ) and
e e Y
E ∩ Z = Proj(O ). To say that the tangent cones of Y and Z intersect at a
Z e
point amounts to saying that Y ∩ Z = ∅. Condition (iv) in Theorem 6.5 says that
e
if χO X(O ,O ) = e(O )e(O ), then Y ∩ Z is guaranteed to be empty as soon
Y Z Y Ze e
as one can show that Y ∩ Z misses the hyperplane V (π) of E which defines the
e e
ramification locus of π (cf. Lemma 6.2). However, with Theorem A in hand, we
e e
have the following improvement, which is similar in flavor to [Dut13, Main Theorem
(iii)] and [Dut05].
Corollary D. Let (R ,π) be DVR with perfect residue field and let (A,n) be an R -
0 0
unramified regular local ring. Let X = SpecA and let Y and Z be closed, integral
subschemes such that ℓ(O ⊗ O ) < ∞ and dimY + dimZ = dimX. Suppose
Y O Z
X

16 C. SKALIT
that χO X(O ,O ) = e(O )e(O ). If dim(grO ⊗ grO ) ≤ 1, then, in fact,
Y Z Y Z Y grO Z
X
dim(grO ⊗ grO ) = 0.
Y grO Z
X
Proof. Let X, Y and Z be the blowups at the closed point n. From the above
discussion, the condition that dim(grO ⊗ grO ) ≤ 1 means that Y ∩ Z is a
Y grO Z
e e e X
finite (possibly empty) set of closed points x ,···x ∈ X. In this case, the sheaves
1 p e e
O
f
Tor X(O ,O ) are direct sums of skyscraper sheaves and therefore have no higher
j Ye Ze e
Zariski sheaf cohomology. The formula for χO f therefore reduces to
X
p
χO Xf(O e,O e) = (−1)i+jℓ(Hi(X,TorO Xf (O e,O e))) = χO Xf ,xi(O ,O )
e e
Y Z j Y Z Y,x Z,x
i i
X X
i,j≥0 i=1
e
Note that if x ∈ X is closed, then by Lemma 3.8 of [Ska15], there are equalities
dim(O ) = edimX, dim(O ) = dimY, and dim(O ) = dimZ.
e e e
X,x Y,x Z,x
By Corollary C, Serre’s Positivity Conjecture is known for every local ring of X, so
each term χO Xf ,xi(O ,O ) is positive. We therefore see that χO Xf(O e,O e) =
e e
Y,x Z,x Y eZ
i i
0 if and only if Y ∩ Z = ∅. On the other hand, since we have assumed that
χO X(O ,O ) = e(O )e(O ), Fulton’s formula [Ful98, 20.4.3]
Y Z Y Z
e e
O O
χ X(O ,O Z) = e(O )e(O Z) + χ Xf(O Ye,O Ze)
Y Y
forces χO Xf(O e,O e) = 0. (cid:3)
Y Z
Acknowledgments
The author wishes to thank M. V. Nori for many helpful discussions, particu-
larly during the early phases of this project. Additional thanks are owed to the
anonymous referee for thoroughly reading the manuscript, catching various mis-
prints, and offering a number of helpful suggestions to improve the overall read-
ability. This work was supported in part by an NSF Research and Training Grant
(DMS-1246844).
References
[Ber97] P. Berthelot. Alt´erations de vari´et´es alg´ebriques (d’apr`es A. J. de Jong). Ast´erisque,
(241):Exp. No. 815, 5, 273–311, 1997. S´eminaire Bourbaki, Vol. 1995/96.
[dJ96] A. J. de Jong. Smoothness, semi-stability and alterations. Inst. Hautes E´tudes Sci. Publ.
Math., (83):51–93, 1996.
[Dut05] S. P. Dutta. A special case of positivity. II. Proc. Amer. Math. Soc., 133(7):1891–1896
(electronic), 2005.
[Dut13] S. P. Dutta. Intersection multiplicity on blow-ups. J. Algebraic Geom., 22(1):85–103,
2013.
[Ful98] W. Fulton. Intersection theory, volume 2 of Ergebnisse der Mathematik und ihrer Gren-
zgebiete. 3. Folge. A Series of Modern Surveys in Mathematics [Results in Mathematics
and Related Areas. 3rd Series. A Series of Modern Surveys in Mathematics]. Springer-
Verlag, Berlin, second edition, 1998.
[Gro57] A. Grothendieck. Sur quelques points d’alg`ebrehomologique. Toˆhoku Math. J. (2), 9:119–
221, 1957.
´ ´
[Gro61] A. Grothendieck. El´ements de g´eom´etrie alg´ebrique. III. Etude cohomologique des fais-
´
ceaux coh´erents. I. Inst. Hautes Etudes Sci. Publ. Math., (11):167, 1961.
[GS85] H. Gillet and C. Soul´e. K-th´eorie et nullit´e des multiplicit´es d’intersection. C. R. Acad.
Sci. Paris S´er. I Math., 300(3):71–74, 1985.

POSITIVITY OF INTERSECTION MULTIPLICITY OVER A TWO-DIMENSIONAL BASE 17
[GS87] H. Gillet and C. Soul´e. Intersection theory using Adams operations. Invent. Math.,
90(2):243–277, 1987.
[Har77] R. Hartshorne. Algebraic geometry. Springer-Verlag, New York-Heidelberg, 1977. Gradu-
ate Texts in Mathematics, No. 52.
[Hoc75] M. Hochster. Topics in the homological theory of modules over commutative rings. Pub-
lished for the Conference Board of the Mathematical Sciences by the American Math-
ematical Society, Providence, R.I., 1975. Expository lectures from the CBMS Regional
Conference held at the University of Nebraska, Lincoln, Neb., June 24–28, 1974, Con-
ference Board of the Mathematical Sciences Regional Conference Series in Mathematics,
No. 24.
[Hoc97] M. Hochster. Nonnegativity of intersection multiplicities in ramified regular local rings
following Gabber/de Jong/Berthelot (Preprint). 1997.
[Mat86] H. Matsumura. Commutative ring theory, volume 8 of Cambridge Studies in Advanced
Mathematics. Cambridge University Press, Cambridge, 1986. Translated from the Japan-
ese by M. Reid.
[Rob85] P. Roberts. The vanishing of intersection multiplicities of perfect complexes. Bull. Amer.
Math. Soc. (N.S.), 13(2):127–130, 1985.
[Ser65] J-P. Serre. Alg`ebre locale. Multiplicit´es, volume 11 of Cours au Coll`ege de France, 1957–
1958, r´edig´e par Pierre Gabriel. Seconde ´edition, 1965. Lecture Notes in Mathematics.
Springer-Verlag, Berlin-New York, 1965.
[Ska15] C. Skalit. Intersection multiplicity of Serre in the unramified case. J. Algebra, 428:91–121,
2015.
[Ten79] B. R. Tennison. Intersection multiplicities and tangent cones. Math. Proc. Cambridge
Philos. Soc., 85(1):33–42, 1979.
[Wei94] C. A. Weibel. An introduction to homological algebra, volume 38 of Cambridge Studies
in Advanced Mathematics. Cambridge University Press, Cambridge, 1994.
Department of Mathematics, University of Illinois at Chicago, 851 S. Morgan St.,
Chicago, IL 60607, cskalit@gmail.com