(cid:73)
Flips in Edge-Labelled Pseudo-Triangulations
Prosenjit Bose, Sander Verdonschot
School of Computer Science, Carleton University, Ottawa
5102 ceD 4  ]GC.sc[  1v58410.2151:viXra
Abstract
We show that O(n2) exchanging flips suffice to transform any edge-labelled
pointed pseudo-triangulation into any other with the same set of labels. By using
insertion, deletion and exchanging flips, we can transform any edge-labelled
pseudo-triangulation into any other with O(nlogc+hlogh) flips, where c is the
number of convex layers and h is the number of points on the convex hull.
Keywords: edge flip, diagonal flip, pseudo-triangulation, edge label
1. Introduction
A pseudo-triangle is a simple polygon with three convex interior angles,
called corners, that are connected by reflex chains. Given a set P of n points
in the plane, a pseudo-triangulation of P is a subdivision of its convex hull into
pseudo-triangles, using all points of P as vertices (see Figure 1a). A pseudo-
triangulation is pointed if all vertices are incident to a reflex angle in some face
(including the outer face; see Figure 1b for an example). Pseudo-triangula-
tions find applications in areas such as kinetic data structures [1] and rigidity
theory [2]. More information on pseudo-triangulations can be found in a survey
by Rote, Santos, and Streinu [3].
(a) (b)
Figure 1: (a) A pseudo-triangulation with two non-pointed vertices. (b) A
pointed pseudo-triangulation.
(cid:73)
The results in this paper appeared in CCCG as an extended abstract, and are part of the
second author’s PhD thesis. This work was partially supported by NSERC.
Email addresses: jit@scs.carleton.ca (Prosenjit Bose), sander@cg.scs.carleton.ca
(Sander Verdonschot)
Preprint submitted to Computational Geometry November 6, 2018

Since a regular triangle is also a pseudo-triangle, pseudo-triangulations gen-
eralize triangulations (subdivisions of the convex hull into triangles). In a tri-
angulation, a flip is a local transformation that removes one edge, leaving an
empty quadrilateral, and inserts the other diagonal of that quadrilateral. Note
that this is only allowed if the quadrilateral is convex, otherwise the resulting
graph would be non-plane. Lawson [4] showed that any triangulation with n
vertices can be transformed into any other with O(n2) flips, and Hurtado, Noy,
and Urrutia [5] gave a matching Ω(n2) lower bound.
Figure 2: A flip in a pseudo-quadrilateral.
Pointed pseudo-triangulations support a similar type of flip, but before we
can introduce this, we need to generalize the concept of pseudo-triangles to
pseudo-k-gons: weakly simple polygons1 with k convex interior angles. A diag-
onal of a pseudo-k-gon is called a bitangent if the pseudo-k-gon remains pointed
after insertion of the diagonal. In a pointed pseudo-triangulation, flipping an
edge removes the edge, leaving a pseudo-quadrilateral, and inserts the unique
other bitangent of the pseudo-quadrilateral (see Figure 2). In contrast with tri-
angulations, all internal edges of a pointed pseudo-triangulation are flippable.
Bereg [6] showed that O(nlogn) flips suffice to transform any pointed pseudo-
triangulation into any other.
Aichholzer et al. [7] showed that the same result holds for all pseudo-triangu-
lations (including triangulations) if we allow two more types of flips: insertion
and deletion flips. As the name implies, these either insert or delete one edge,
provided that the result is still a pseudo-triangulation. To disambiguate, they
call the other flips exchanging flips. In a later paper, this bound was refined to
O(nlogc) [8], where c is the number of convex layers of the point set.
There is recent interest in edge-labelled triangulations: triangulations where
each edge has a unique label, and flips reassign the label of the flipped edge to
the new edge. Araujo-Pardo et al. [9] studied the flip graph of edge-labelled
triangulations of a convex polygon, proving that it is still connected and in fact
covers the regular flip graph. They also fully characterized its automorphism
group. Independently, Bose et al. [10] showed that it has diameter Θ(nlogn).
Bose et al. also considered edge-labelled versions of other types of trian-
gulations. In many cases, the flip graph is disconnected. For example, it is
easy to create a triangulation on a set of points with an edge that can never
1A weakly simple polygon is a plane graph with a bounded face that is incident to all
edges.
2

be flipped. Two edge-labelled triangulations in which such an edge has differ-
ent labels can therefore never be transformed into each other with flips. On the
other hand, Bose et al. showed that the flip graph of edge-labelled combinatorial
triangulations is connected and has diameter Θ(nlogn).
In this paper, we investigate flips in edge-labelled pseudo-triangulations:
pseudo-triangulations where each internal edge has a unique label in {1,...,3n−
3−2h}, where h is the number of vertices on the convex hull (3n−3−2h is the
number of internal edges in a triangulation). In the case of an exchanging flip,
the new edge receives the label of the old edge. For a deletion flip, the edge and
its label are removed, and for an insertion flip, the new edge receives an unused
label from the set of all possible labels.
In contrast with the possibly disconnected flip graph of edge-labelled geo-
metric triangulations, we show that O(n2) exchanging flips suffice to transform
any edge-labelled pointed pseudo-triangulation into any other with the same set
of labels. By using all three types of flips – insertion, deletion and exchanging
– we can transform any edge-labelled pseudo-triangulation into any other with
O(nlogc+hlogh) flips, where c is the number of convex layers of the point set,
and h is the number of vertices on the convex hull. In both settings, we have
an Ω(nlogn) lower bound, making the second result tight.
2. Pointed pseudo-triangulations
In this section, we show that every edge-labelled pointed pseudo-triangula-
tion can be transformed into any other with the same set of labels by O(n2)
exchanging flips. We do this by showing how to transform a given edge-labelled
pointed pseudo-triangulation into a canonical one. The result then follows by
the reversibility of flips.
Figure 3: A left-shelling pseudo-triangulation.
Before we can start the proof, we need a few more definitions. Given a
set of points in the plane, let v be the point with the lowest y-coordinate,
0
and let v ,...,v be the other points in clockwise order around v . The left-
1 n 0
shelling pseudo-triangulation is the union of the convex hulls of v ,...,v , for
0 i
all 2 ≤ i ≤ n (see Figure 3). Thus, every vertex after v is associated with
1
two edges: a bottom edge connecting it to v and a top edge that is tangent to
0
the convex hull of the earlier vertices. The right-shelling pseudo-triangulation
is similar, with the vertices added in counter-clockwise order instead.
As canonical pseudo-triangulation, we use the left-shelling pseudo-triangu-
lation, with the bottom edges labelled in clockwise order around v , followed
0
3

by the internal top edges in the same order (based on their associated vertex).
Since we can transform any pointed pseudo-triangulation into the left-shelling
pseudo-triangulation with O(nlogn) flips [6], the main part of the proof lies in
reordering the labels of a left-shelling pseudo-triangulation. We use two tools
for this, called a sweep and a shuffle, that are each implemented by a sequence
of flips. A sweep interchanges the labels of some internal top edges with their
respective bottom edges, while a shuffle permutes the labels on all bottom edges.
Lemma 1. We can transform any left-shelling pseudo-triangulation into the
canonical one with O(1) shuffle and sweep operations.
Proof. In the canonical pseudo-triangulation, we call the labels assigned to bot-
tom edges low, and the labels assigned to top edges high. In the first step, we
use a shuffle to line up every bottom edge with a high label with a top edge
with a low label. Then we exchange these pairs of labels with a sweep. Now all
bottom edges have low labels and all top edges have high labels, so all that is
left is to sort the labels. We can sort the low labels with a second shuffle. To
sort the high labels, we sweep them to the bottom edges, shuffle to sort them
there, then sweep them back.
The remainder of this section describes how to perform a sweep and a shuffle
with flips.
Lemma 2. We can interchange the labels of the edges incident to an internal
vertex v of degree two with three exchanging flips.
Proof. Consider what happens when we remove v. Deleting one of its edges
leaves a pseudo-quadrilateral. Removing the second edge then either merges
two corners into one, or removes one corner, leaving a pseudo-triangle T. There
are three bitangents that connect v to T, each corresponding to the geodesic
between v and a corner of T. Any choice of two of these bitangents results in a
pointed pseudo-triangulation. When one of them is flipped, the only new edge
that can be inserted so that the result is still a pointed pseudo-triangulation is
the bitangent that was not there before the flip. Thus, we can interchange the
labels with three flips (see Figure 4).
Figure 4: Interchanging the labels of the edges incident to a vertex of degree
two.
4

Lemma 3 (Sweep). In the left-shelling pseudo-triangulation, we can inter-
change the labels of any number of internal top edges and their corresponding
bottom edges with O(n) exchanging flips.
Proof. Let S be the set of vertices whose internal top edge should have its label
swapped with the corresponding bottom edge. Consider a ray L from v that
0
starts at the positive x-axis and sweeps through the point set to the negative
x-axis. We will maintain the following invariant: the graph induced by the
vertices to the left of L is their left-shelling pseudo-triangulation and the graph
induced by the vertices to the right of L is their right-shelling pseudo-triangu-
lation (both groups include v ). Furthermore, the labels of the top edges of
0
the vertices in S to the right of L have been interchanged with their respective
bottom edges. This invariant is satisfied at the start.
Suppose that L is about to pass a vertex v . If v is on the convex hull, its
k k
top edge is not internal and no action is required for the invariant to hold after
passing v . So assume that v is not on the convex hull and consider its incident
k k
edges. It is currently part of the left-shelling pseudo-triangulation of points to
the left of L, where it is the last vertex. Thus, v is connected to v and to one
k 0
vertex to its left. It is not connected to any vertex to its right, since there are
2n − 3 edges in total, and the left- and right-shelling pseudo-triangulations to
each side of L contribute 2(k + 1) − 3 + 2(n − k) − 3 = 2n − 4 edges. So the
only edge that crosses L is an edge of the convex hull. Therefore v has degree
k
two, which means that we can use Lemma 2 to swap the labels of its top and
bottom edge with three flips if v ∈ S.
k
Furthermore, the sides of the pseudo-triangle that remains if we were to
remove v , form part of the convex hull of the points to either side of L. Thus,
k
flipping the top edge of v results in the tangent from v to the convex hull of
k k
the points to the right of L – exactly the edge needed to add v to their right-
k
shelling pseudo-triangulation. Therefore we only need O(1) flips to maintain
the invariant when passing v .
k
At the end, we have constructed the right-shelling pseudo-triangulation and
swapped the desired edges. An analogous transformation without any swapping
can transform the graph back into the left-shelling pseudo-triangulation with
O(n) flips in total.
Lemma 4. In the left-shelling pseudo-triangulation, we can interchange the
labels of two consecutive bottom edges with O(1) exchanging flips.
Proof. When we remove the two consecutive bottom edges (say a and b), we
are left with a pseudo-pentagon X. A pseudo-pentagon can have up to five
bitangents, as each bitangent corresponds to a geodesic between two corners. If
X has exactly five bitangents, this correspondence is a bijection. This implies
that the bitangents of X can be swapped just like diagonals of a convex pentagon
(see Figure 6). On the other hand, if X has only four bitangents, it is impossible
to swap a and b without flipping an edge of X (see Figure 5).
Fortunately, we can always transform X into a pseudo-pentagon with five
bitangents. If the pseudo-triangle to the right of b is a triangle, X already has
5

Figure 5: A pseudo-pentagon with four bitangents. It is impossible to swap the
two diagonals without flipping an edge of the pseudo-pentagon, as they just flip
back and forth between the solid bitangents and the dotted ones, regardless of
the position of the other diagonal.
five bitangents (see Lemma 9 in Section 2.1). Otherwise, the top endpoint of b
is an internal vertex of degree two and we can flip its top edge to obtain a new
pseudo-pentagon that does have five bitangents (see Lemma 10 in Section 2.1).
After swapping the labels of a and b, we can flip this top edge back. Thus, in
either case we can interchange the labels of a and b with O(1) flips.
We can use Lemma 4 to reorder the labels of the bottom edges with insertion
or bubble sort, as these algorithms only swap adjacent values.
Corollary 5 (Shuffle). In the left-shelling pseudo-triangulation, we can reorder
the labels of all bottom edges with O(n2) exchanging flips.
Combining this with Lemmas 1 and 3, and the fact that we can transform any
pointed pseudo-triangulation into the left-shelling one with O(nlogn) flips [6],
gives the main result.
Theorem 6. We can transform any edge-labelled pointed pseudo-triangulation
with n vertices into any other with O(n2) exchanging flips.
The following lower bound follows from the Ω(nlogn) lower bound on the
flip distance between edge-labelled triangulations of a convex polygon [10].
Theorem 7. There are pairs of edge-labelled pointed pseudo-triangulations with
n vertices that require Ω(nlogn) exchanging flips to transform one into the
other.
Proof. When all vertices are in convex position, each vertex is pointed in the
outer face. As such, any triangulation of these vertices is, in fact, a pointed
pseudo-triangulation. Additionally, there is no difference between the standard
definition of a flip in a triangulation of a convex polygon and the flip in that same
setting, when interpreted as a pointed pseudo-triangulation. Thus, the lower
bound of Ω(nlogn) flips to transform between two edge-labelled triangulations
of a convex polygon applies to pointed pseudo-triangulations as well.
6

c
c 4
3
c
2
c c
3 4
c 1 c 2
c
1
Figure 6: Interchanging the labels of two bitangents of a pseudo-pentagon with
five bitangents. An edge in the pentagon corresponds to a geodesic between two
corners of the pseudo-pentagon.
2.1. Deferred proofs
This section contains a few technical lemmas that were omitted from the
previous section.
Lemma 8. Let a be a corner of a pseudo-triangle with neighbours x and y, and
let e be an edge on the chain opposite a. If all vertices of the other pseudo-
triangle containing e lie in the wedge formed by extending the edges ax and ay
into half-lines (see Figure 7a), then flipping e will result in an edge incident on
a.
Proof. Let T be the pseudo-triangle on the other side of e, and let b be the
corner of T opposite e. Then flipping e inserts the geodesic between a and b.
This geodesic must intersect e in a point s and then follow the shortest path
from s to a. If s lies strictly inside the wedge, nothing can block as, thus the
new edge will contain as and be incident on a.
Now, if all of e lies strictly inside the wedge, our result follows. But suppose
that e has x as an endpoint and the geodesic between a and b intersects e in
x. As a can see x and all of T lies inside the wedge, there is an ε > 0 such
that a can see the point X on the boundary of T at distance ε from x (see
Figure 7b). The line segment ap intersects the geodesic at a point s . By the
(cid:48)
triangle inequality, s a is shorter than following the geodesic from s via x to
(cid:48) (cid:48)
a. But then this would give a shorter path between a and b, by following the
geodesic to s and then cutting directly to a. As the geodesic is the shortest
(cid:48)
7

b
e e
a
x y s
0
p
x
a
(a) (b)
Figure 7: (a) A corner of a pseudo-triangle and an edge such that the entire
pseudo-triangle on the other side of the edge lies inside the corner’s wedge. (b)
If a can see a point past x, then the geodesic does not contain x.
path by definition, this is impossible. Thus, the geodesic cannot intersect e at
x and the new edge must be incident to a.
Lemma 9. Let a and b be two consecutive internal bottom edges in the left-
shelling pseudo-triangulation, such that the pseudo-triangle to the right of b is
a triangle. Then the pseudo-pentagon X formed by removing a and b has five
bitangents.
Proof. Let c ,...,c be the corners of X in counter-clockwise order around the
0 4
boundary. By Lemma 8, flipping b results in an edge b that intersects b and is
(cid:48)
incident on c . This edge is part of the geodesic between c and c , and as such
1 1 3
it is tangent to the convex chain v ,v ,...,c , where v is the top endpoint of
0 a 3 a
a (v could be c ). Therefore it is also the tangent from c to the convex hull
a 3 1
of {v ,...,v }. This means that the newly created pseudo-triangle with c as
0 a 1
corner and a on the opposite pseudo-edge also meets the conditions of Lemma 8.
Thus, flipping a results in another edge, a , also incident on c . As b separates
(cid:48) 1
c from all vertices in {v ,...,v }, a must also intersect b. This gives us four
1 0 a (cid:48)
bitangents, of which two are incident on v (a and b), and two on c (a and b ).
0 1 (cid:48) (cid:48)
Finally, flipping a before flipping b results in a bitangent that is not incident
on v (as v is a corner and cannot be on the new geodesic), nor on c (as b
0 0 1
separates a from c ). Thus, X has five bitangents.
1
Lemma 10. Let a and b be two consecutive internal bottom edges in the left-
shelling pseudo-triangulation, such that the pseudo-triangle to the right of b is
not a triangle. Then the pseudo-pentagon X formed by flipping the correspond-
ing top edge of b and removing a and b has five bitangents.
Proof. Let v and v be the top endpoints of a and b. By Lemma 8 and since b
a b
had degree two, flipping the top edge of b results in the edge v c . We get three
b 1
bitangents for free: a, b, and b – the old top edge of b and the result of flipping
(cid:48)
b.
8

X consists of a reflex chain C that is part of the convex hull of the points
to the left of a, followed by three successive tangents to C, v , or v . Since C
a b
lies completely to the left of a, it cannot significantly alter any of the geodesics
or bitangents inside the polygon, so we can reduce it to a single edge. Now, X
consists either of a triangle with two internal vertices, or a convex quadrilateral
with one internal vertex.
If X is a triangle with two internal vertices, the internal vertices are v and
a
v . Let its exterior vertices be v , x, and y. Then there are seven possible
b 0
bitangents: a = v v , b = v v , xv , xv , yv , yv , and v v . We know that
0 a 0 b a b a b a b
xv and yv are edges, so there are five possible bitangents left. As all vertices
a b
involved are either corners or have degree one in X, the only condition for an
edge to be a bitangent is that it does not cross the boundary of X. Since the
exterior boundary is a triangle, this reduces to it not crossing xv and yv . Two
a b
line segments incident to the same vertex cannot cross. Thus, xv , yv , and
b a
v v cannot cross xv and yv , and X has five bitangents.
a b a b
If X’s convex hull has four vertices, the internal vertex is v (otherwise the
b
pseudo-triangle to the right of b would be a triangle). Let its exterior vertices
be v , x, v , and y. Then there are six possible bitangents: a = v v , b = v v ,
0 a 0 a 0 b
xy, xv , yv , and v v , of which one (yv ) is an edge of X. Since a and b
b b a b b
are guaranteed to be bitangents, and xy, xv , and v v all share an endpoint
b a b
with yv , the arguments from the previous case apply and we again have five
b
bitangents.
3. General pseudo-triangulations
In this section, we extend our results for edge-labelled pointed pseudo-trian-
gulations to all edge-labelled pseudo-triangulations. Since not all pseudo-trian-
gulations have the same number of edges, we need to allow flips that change the
number of edges. In particular, we allow a single edge to be deleted or inserted,
provided that the result is still a pseudo-triangulation.
Since we are dealing with edge-labelled pseudo-triangulations, we need to
determine what happens to the edge labels. It is useful to first review the
properties we would like these flips to have. First, a flip should be a local
operation – it should affect only one edge. Second, a labelled edge should be
flippable if and only if the edge is flippable in the unlabelled setting. This allows
us to re-use the existing results on flips in pseudo-triangulations. Third, flips
should be reversible. Like most proofs about flips, our proof in the previous
section crucially relies on the reversibility of flips.
With these properties in mind, the edge-deletion flip is rather straightforward
– the labelled edge is removed, and other edges are not affected. Since the edge-
insertion flip needs to be the inverse of this, it should insert the edge and assign
it a free label – an unused label in {1,...,3n − 3 − 2h}, where h is the number
of vertices on the convex hull (3n − 3 − 2h is the number of internal edges in a
triangulation).
With the definitions out of the way, we can turn our attention to the number
of flips required to transform any edge-labelled pseudo-triangulations into any
9

other. In this section, we show that by using insertion and deletion flips, we can
shuffle (permute the labels on bottom edges) with O(n+hlogh) flips. Combined
with the unlabelled bound of O(nlogc) flips by Aichholzer et al. [8], this brings
the total number of flips down to O(nlogc + hlogh). When the points are
in convex position (h = n), all pseudo-triangulations are full triangulations,
and the O(nlogn) bound by Bose et al. [10] in this setting implies our bound.
Therefore, we assume for the remainder of this section that the points are not
in convex position (h < n). As before, we first build a collection of simple tools
that help prove the main result.
Lemma 11. With O(1) flips, we can interchange the label of an edge incident
to an internal vertex of degree two with a free label.
Proof. Let v be a vertex of degree two and let e be an edge incident to v.
Since v has degree two, its removal leaves an empty pseudo-triangle T. There
are three bitangents that connect v to T, one for each corner. Thus, we can
insert the third bitangent f with the desired free label, making v non-pointed
(see Figure 8). Flipping e now removes it and frees its label. Finally, flipping f
moves it into e’s starting position, completing the exchange.
Figure 8: Interchanging the label of an edge incident to a vertex of degree two
with a free label.
This implies that, using an arbitrary free label as placeholder, we can swap
any two edges incident to internal degree-two vertices – no matter where they
are in the pseudo-triangulation.
Corollary 12. We can interchange the labels of two edges, each incident to
some internal vertex of degree two, with O(1) flips.
Recall that during a sweep (Lemma 3), each internal vertex has degree two
at some point. Since the number of free labels for a pointed pseudo-triangu-
lation is equal to the number of internal vertices, this means that we can use
Lemma 11 to swap every label on a bottom edge incident to an internal vertex
with a free label by performing a single sweep. Afterwards, a second sweep can
replace these labels on the bottom edges in any desired order. Thus, permuting
the labels on bottom edges incident to internal vertices can be done with O(n)
flips. Therefore, the difficulty in permuting the labels on all bottom edges lies
in bottom edges that are not incident to an internal vertex, that is, chords of
the convex hull. If there are few such chords, a similar strategy (free them all
10

and replace them in the desired order) might work. Unfortunately, the number
of free labels can be far less than the number of chords.
We now consider operations on maximal groups of consecutive chords, which
we call fans. As the vertices of a fan are in convex position, fans behave in
many ways like triangulations of a convex polygon, which can be rearranged
with O(nlogn) flips [10]. The problem now becomes getting the right set of
labels on the edges of a fan.
Consider the internal vertices directly to the left (v ) and right (v ) of a
l r
fan F, supposing both exist. Vertex v has degree two and forms part of the
l
reflex chain of the first pseudo-triangle to the left of F. Thus, flipping v ’s top
l
edge connects it to the leftmost vertex of F (excluding v ). Vertex v is already
0 r
connected to the rightmost vertex of F, so we just ensure that it has degree
two. To do this, we flip all incident edges from vertices further to the right,
from the bottom to the top. Now the diagonals of F form a triangulation of
a convex polygon whose boundary consists of v , v , the top endpoints of the
0 l
chords, and v (see Figure 9a). It is possible that there is no internal vertex to
r
one side of F. In that case, there is only one vertex on that side of F, which is
part of the convex hull, and we can simply use that vertex in place of v or v
l r
without flipping any of its edges. Since there is at least one internal vertex by
assumption, either v or v is an internal vertex. This vertex is called the index
l r
of F. If a vertex is the index of two fans, it is called a shared index.
v
r
v
l
vl vl vl
(a) (b)
Figure 9: (a) An indexed fan. (b) Shifting the index (v ) from the yellow edge
l
to the red edge.
A triangulated fan is called an indexed fan if there is one edge incident to
the index, the indexed edge, and the remaining edges are incident to one of
the neighbours of the index on the boundary. Initially, all diagonals of F are
incident to v , so we transform it into an indexed fan by flipping the diagonal
0
of F closest to the index. Next, we investigate several operations on indexed
fans that help us move labels between fans.
Lemma 13 (Shift). In an indexed fan, we can shift the indexed edge to the next
diagonal with O(1) flips.
Proof. Suppose that v is the index (the proof for v is analogous). Let e be
l r
the current indexed edge, and f be the leftmost diagonal incident to v . Then
0
flipping f followed by e makes f the only edge incident to the index and e
11

incident to the neighbour of the index (see Figure 9b). Since flips are reversible,
we can shift the index the other way too.
Figure 10: Changing which side a shared index indexes.
Lemma 14. We can switch which fan a shared index currently indexes with
O(1) flips.
Proof. Flipping the current indexed edge “parks” it by connecting it to the two
neighbours of the index, and reduces the degree of the index to two (see Fig-
ure 10). Now, flipping the top edge of the index connects it to the other fan,
where we parked the previously indexed edge. Flipping that edge connects it to
the index again.
Lemma 15. In a pointed pseudo-triangulation, we can always decrease the
degree of a vertex v of degree three by flipping one of the edges incident to its
reflex angle.
Proof. Consider the geodesic from v to the opposite corner c of the pseudo-
triangle v is pointed in. The line supporting the part of the geodesic when it
reaches v splits the edges incident to v into two groups. As there are three edges,
one of these groups must contain multiple edges. Flipping the edge incident to
its reflex angle in the group with multiple edges results in a geodesic to c. If this
geodesic passed through v, it would insert the missing edges along the geodesic
from v to c (otherwise we could find a shorter path). But inserting this geodesic
would make v non-pointed. Thus, v cannot be on this geodesic. Therefore the
new edge is not incident to v and the flip reduces the degree of v.
Since the index always has degree three, this allows us to extend the results
from Lemmas 11 and 2 regarding vertices of degree two to indexed edges.
Corollary 16. In an indexed fan, we can interchange the label of the indexed
edge with a free label in O(1) flips.
12

Corollary 17. Given two indexed fans, we can interchange the labels of the two
indexed edges with O(1) flips.
Now we have enough tools to shuffle the bottom edges.
Lemma 18 (Shuffle). In the left-shelling pseudo-triangulation, we can reorder
the labels of all bottom edges with O(n+hlogh) flips, where h is the number of
vertices on the convex hull.
Proof. In the initial pseudo-triangulation, let B and F be the sets of labels on
bottom edges and free labels, respectively. Let F be the set of labels on the
i
i-th fan (in some fixed order), and let F be the set of labels on non-fan bottom
edges. Let F and F(cid:48) be these same sets in the target pseudo-triangulation. As
i(cid:48)
we are only rearranging the bottom labels, we have that B = F ∪...∪F ∪F =
1 k
F ∪ ... ∪ F ∪ F(cid:48), where k is the number of fans.
1(cid:48) k(cid:48)
We say that a label (cid:96) belongs to fan i if (cid:96) ∈ F . At a high level, the reordering
i(cid:48)
proceeds in four stages. In stage one, we free all labels in F. In stage two, we
place each label from B \ F(cid:48) in the fan it belongs to, leaving the labels in F(cid:48)
free. Then, in stage three, we correct the order of the labels within each fan.
Finally, we place the labels in F(cid:48) correctly.
Since each internal vertex contributes exactly one top edge, one bottom edge,
and one free label, we have that |F| = |F|. To free all labels in F, we perform
a sweep (see Lemma 3). As every internal vertex has degree two at some point
during the sweep, we can exchange the label on its bottom edge with a free
label at that point, using Lemma 11. This requires O(n) flips. The labels in F
remain on the bottom edges incident to internal vertices throughout stage two
and three, as placeholders.
To begin stage two, we index all fans with O(n) flips and shift these indices
to the first ‘foreign’ edge: the first edge whose label does not belong to the
current fan. If no such edge exists, we can ignore this fan for the remainder of
stage two, as it already has the right set of labels. Now suppose that there is a
fan F whose indexed edge e is foreign: (cid:96) ∈/ F . Then either (cid:96) ∈ F for some
i e i(cid:48) e j(cid:48)
j (cid:54)= i, or (cid:96) ∈ F(cid:48). In the first case, we exchange (cid:96) with the label on the indexed
e e
edge of F , and shift the index of F to the next foreign edge. In the second
j j
case, we exchange (cid:96) with a free label in B \ F(cid:48). If this label belongs to F , we
e i
shift its index to the next foreign edge. In either case, we increased the number
of correctly placed labels by at least one. Thus n−1 repetitions suffice to place
all labels in the fan they belong to, wrapping up stage two. Since we perform
a linear number of swaps and shifts, and each takes a constant number of flips,
the total number of flips required for stage two is O(n).
For stage three, we note that each indexed fan corresponds to a triangulation
of a convex polygon. As such, we can rearrange the labelled diagonals of a fan
F into their desired final position with O(|F |log|F |) flips [10]. Thus, if we let
i i i
h be the number of vertices on the convex hull, the total number of flips for this
13

step is bounded by
(cid:88) (cid:88)
O(|F |log|F |) ≤ O(|F |logh) = O(hlogh).
i i i
i i
For stage four, we first return to a left-shelling pseudo-triangulation by un-
indexing each fan, using O(n) flips. After stage two, the labels in F(cid:48) are all
free, so all that is left is to place these on the correct bottom edges, which
we can do with a final sweep. Thus, we can reorder all bottom labels with
O(n + hlogh).
This leads to the following bound.
Theorem 19. We can transform any edge-labelled pseudo-triangulation with n
vertices into any other with O(nlogc + hlogh) flips, where c is the number of
convex layers and h is the number of vertices on the convex hull.
Proof. Using the technique by Aichholzer et al. [8], we first transform the pseu-
do-triangulation into the left-shelling pseudo-triangulation T with O(nlogc)
flips. Our canonical pseudo-triangulation contains the labels {1,...,2n−h−3},
but it is possible for T to contain a different set of labels. Since all labels are
drawn from {1,...,3n − 2h − 3}, at most n − h labels differ. This is exactly
the number of internal vertices. Thus, we can use O(n + hlogh) flips to shuffle
(Lemma 18) all non-canonical labels on fan edges to bottom edges incident
to an internal vertex. Once there, we use a sweep (Lemma 3) to ensure that
every internal vertex has degree two at some point, at which time we replace
its incident non-canonical labels with canonical ones with a constant number of
flips (Lemma 11). Once our left-shelling pseudo-triangulation has the correct
set of labels, we use a constant number of shuffles and sweeps to sort the labels
(Lemma 1). Since we can shuffle and sweep with O(n+hlogh) and O(n) flips,
respectively, the total number of flips reduces to O(nlogc + n + hlogh) =
O(nlogc + hlogh).
The correspondence between triangulations of a convex polygon and pseu-
do-triangulations, proven in Theorem 7, also gives us the following lower bound,
as no insertion or deletion flips are possible in this setting.
Theorem 20. There are pairs of edge-labelled pseudo-triangulations with n
vertices such that any sequence of flips that transforms one into the other has
length Ω(nlogn).
Acknowledgments
We would like to thank Anna Lubiw and Vinayak Pathak for helpful discus-
sions.
14

References
[1] D. Kirkpatrick, J. Snoeyink, B. Speckmann, Kinetic collision detection for
simple polygons, International Journal of Computational Geometry & Ap-
plications 12 (1-2) (2002) 3–27. doi:10.1142/S0218195902000724.
[2] I. Streinu, Pseudo-triangulations, rigidity and motion planning, Dis-
crete & Computational Geometry. 34 (4) (2005) 587–635. doi:10.1007/
s00454-005-1184-0.
[3] G. Rote, F. Santos, I. Streinu, Pseudo-triangulations—a survey, in: Sur-
veys on discrete and computational geometry, Vol. 453 of Contemporary
Mathematics, 2008, pp. 343–410. doi:10.1090/conm/453/08807.
[4] C. L. Lawson, Transforming triangulations, Discrete Mathematics 3 (4)
(1972) 365–372.
[5] F. Hurtado, M. Noy, J. Urrutia, Flipping edges in triangulations, Dis-
crete & Computational Geometry. 22 (3) (1999) 333–346. doi:10.1007/
PL00009464.
[6] S. Bereg, Transforming pseudo-triangulations, Information Processing Let-
ters 90 (3) (2004) 141–145. doi:10.1016/j.ipl.2004.01.021.
[7] O. Aichholzer, F. Aurenhammer, H. Krasser, P. Brass, Pseudotrian-
gulations from surfaces and a novel type of edge flip, SIAM Jour-
nal on Computing 32 (6) (2003) 1621–1653 (electronic). doi:10.1137/
S0097539702411368.
[8] O. Aichholzer, F. Aurenhammer, C. Huemer, H. Krasser, Transforming
spanning trees and pseudo-triangulations, Information Processing Letters
97 (1) (2006) 19–22. doi:10.1016/j.ipl.2005.09.003.
[9] G. Araujo-Pardo, I. Hubard, D. Oliveros, E. Schulte, Colorful associahedra
and cyclohedra, Journal of Combinatorial Theory, Series A 129 (2015) 122–
141. doi:10.1016/j.jcta.2014.09.001.
[10] P. Bose, A. Lubiw, V. Pathak, S. Verdonschot, Flipping edge-labelled tri-
angulations (2013). arXiv:1310.1166.
15