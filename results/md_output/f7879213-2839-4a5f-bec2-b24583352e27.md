SOME CONVOLUTION IDENTITIES AND AN INVERSE RELATION
INVOLVING PARTIAL BELL POLYNOMIALS
2102 voN 02  ]OC.htam[  1v1884.1121:viXra
DANIEL BIRMAJER, JUAN B. GIL, AND MICHAEL D. WEINER
Abstract. We prove an inverse relation and a family of convolution formulas involving
partial Bell polynomials. Known and some presumably new combinatorial identities of
convolution type are discussed. Our approach relies on an interesting multinomial formula
for the binomial coefficients. The inverse relation is deduced from a parametrization of
suitable identities that facilitate dealing with compositions of Bell polynomials.
1. Introduction
The main goal of this paper is to obtain the inverse relation (Theorem 4.6):
n
an + bk
y = (k − 1)!B (x),
n n,k
k − 1
k=1 (cid:18) (cid:19)
X (1.1)
n
an + bk −an − b
x = (k − 1)!B (y),
n n,k
an + b k − 1
k=1 (cid:18) (cid:19)
X
where a and b are integers (not both equal to 0), x and y stand for x = (x ,x ,...) and
1 2
y = (y ,y ,...), and B (z) denotes the (n,k)th partial Bell polynomial in the variables
1 2 n,k
z ,z ,...,z . There is a vast literature about Bell polynomials and their applications,
1 2 n−k+1
see e.g. [1, 2, 5, 8]. Recall that
n! z i1 z i2
1 2
B (z) = ··· ,
n,k
i !i !··· 1! 2!
1 2
i∈ Xπ(n,k) (cid:16) (cid:17) (cid:16) (cid:17)
where π(n,k) is the set of all sequences i = (i ,i ,... ) of nonnegative integers such that
1 2
i + i + ··· = k and i + 2i + 3i + ··· = n.
1 2 1 2 3
The above relation generalizes similar inverse relations available in the literature. For
instance, with b = 1 we recover a result by Comtet [5, Theorem F, p. 151], which he obtained
by means of the inversion formula of Lagrange. Moreover, for a = 0 and b = 1, the inverse
pair (1.1) fits into the Fa`a di Bruno relations given by Chou, Hsu, and Shiue [3].
To achieve (1.1) we develop an alternative approach. We consider a parametrization of
suitable identities (Theorem 4.4) that allow us to deal with nested compositions of partial
Bell polynomials. This approach seems novel and relies on interesting (presumably new)
convolution formulas for partial Bell polynomials, see Section 3.
Key words and phrases. Inverse relations, partial Bell polynomials, convolution identities.
1

2 DANIEL BIRMAJER, JUAN B. GIL, AND MICHAEL D. WEINER
In particular, if α(ℓ,m) is a polynomial in ℓ and m of degree at most one, then for any
sequence x = (x ,x ,...) we get (Corollary 3.4):1
1 2
k n α(ℓ,m) τ−α(ℓ,m) n
τ τ
k−ℓ ℓ m τ−α(0,0)+α(k,n)
B (x)B (x) = B (x).
α(ℓ,m) τ − α(ℓ,m) k m,ℓ n−m,k−ℓ α(k,n)(τ−α(0,0)) k n,k
(cid:0) (cid:1)(cid:0) (cid:1)(cid:0) (cid:1)
ℓ=0 m=ℓ ℓ (cid:18) (cid:19)
X X
A general convolution identity is presented in Theorem 3.2, and cases of particular interest
(cid:0) (cid:1)(cid:0) (cid:1)
are given in Corollary 3.3. For the special case when α(ℓ,m) = r is a positive integer r ≤ k,
we recover the identity
n−r
k n
B (x) = B (x)B (x),
n,k m,k−r n−m,r
r m
(cid:18) (cid:19) m=k−r(cid:18) (cid:19)
X
recently discovered by Cvijovi´c [6, Eqn. (1.4)]. Identities involving Bell polynomials have
of course the usual direct consequences for the Stirling numbers of first and second kind.
This paper is essentially self-contained. We start with a multi-variable version of the
well known identity n (−1)j n P(j) = 0 for any polynomial P(x) of degree less than n,
j=0 j
and use it to prove Theorem 2.3. This theorem provides core identities for the convolution
P (cid:0) (cid:1)
formulas of Bell polynomials given in Section 3. In Section 4, we prove the inverse relation
(1.1) and discuss some special cases.
It is worth noting that the results of Section 2 can be viewed as a template for a variety of
combinatorial identities of convolution type. For instance, special choices of the parameters
in equations (2.4), (2.5), and (2.7) give us the famous Hagen–Rothe identities.
2. Convolution identities
N
Given n ∈ it is known that, for any polynomial P(x) of degree less than n,
n
n
j
(−1) P(j) = 0.
j
j=0 (cid:18) (cid:19)
X
For several variables, we have:
Lemma 2.1. Given nonnegative integers v ,... ,v ,
1 d
v v
(−1)i1+···+i 1 d
d ··· P(i ,...,i ) = 0.
1 d
i i
1 d
i1,. X..,i d≥0 (cid:18) (cid:19) (cid:18) (cid:19)
for any polynomial P(x ,... ,x ) of degree less than k = v + ··· + v .
1 d 1 d
This lemma, which can be proved by reduction to the one-variable case, is the base of
our theorem below.
Z
For a given v = (v ,v ,... ,v ) with 0 ≤ v ∈ , and such that v 6= 0, define
1 2 d i
v v
1 d
W (v) = ··· , (2.2)
m,ℓ
i i
1 d
i∈π (m,ℓ)(cid:18) (cid:19) (cid:18) (cid:19)
Xd
1
Throughout this paper, the choice of parameters is restricted to those for which the expressions are
defined.

CONVOLUTION AND INVERSE RELATIONS FOR PARTIAL BELL POLYNOMIALS 3
Nd
where π (m,ℓ) is the set of all i = (i ,i ,...,i ) ∈ such that
d 1 2 d 0
i + ··· + i = ℓ and i + 2i + ··· + di = m.
1 d 1 2 d
For those values of (m,ℓ) for which π (m,ℓ) is empty, we set W (v) = 0. In particular,
d m,ℓ
W (v) = 0 unless m = 0.
m,0
Theorem 2.3. Let v = (v ,v ,...,v ) be any finite sequence of nonnegative integers with
1 2 d
v + ··· + v = k > 0 and v + 2v + ··· + dv = n. Let α(ℓ,m) be a polynomial in ℓ and m
1 d 1 2 d
C
of degree at most one. For any τ ∈ , we have
k n α(ℓ,m) τ−α(ℓ,m)
α(k,n) τ
k−ℓ ℓ
W (v) = , and (2.4)
m,ℓ
α(ℓ,m) k k
(cid:0) (cid:1)(cid:0) (cid:1)
ℓ=0 m=ℓ ℓ (cid:18) (cid:19)
X X
k n τ−α(ℓ,m) α(ℓ,m)
α(0,0) (cid:0) (cid:1) τ
k−ℓ ℓ
W (v) = . (2.5)
m,ℓ
α(ℓ,m) k k
(cid:0) (cid:1)(cid:0) (cid:1)
ℓ=0 m=ℓ ℓ (cid:18) (cid:19)
X X
Proof. For simplicity, we will write α = α(cid:0)(ℓ,(cid:1)m). At first, we assume τ to be an integer with
0 ≤ τ ≤ k − 1. For such τ we have
α τ−α α α−τ+ℓ−1
ℓ
1 (−1)
k−ℓ ℓ k−ℓ ℓ
=
α k α k
(cid:0) (cid:1)(cid:0) (cid:1) (cid:0) (cid:1)(cid:0) (cid:1)
ℓ ℓ
(−1)ℓ τ!(k − τ − 1)! α − 1 α − τ + ℓ − 1
(cid:0) (cid:1) (cid:0) (cid:1)
= ,
k! τ k − τ − 1
(cid:18) (cid:19)(cid:18) (cid:19)
and so
k n α τ−α
1
k−ℓ ℓ
W (v)
m,ℓ
α k
(cid:0) (cid:1)(cid:0) (cid:1)
ℓ=0 m=ℓ ℓ
X X
k n
(cid:0) (cid:1) (−1)ℓ τ!(k − τ − 1)! α − 1 α − τ + ℓ − 1
= W (v)
m,ℓ
k! τ k − τ − 1
ℓ=0 m=ℓ (cid:18) (cid:19)(cid:18) (cid:19)
X X
k n
τ!(k − τ − 1)! α − 1 α − τ + ℓ − 1
ℓ
= (−1) W (v).
m,ℓ
k! τ k − τ − 1
ℓ=0 m=ℓ (cid:18) (cid:19)(cid:18) (cid:19)
X X
α−1 α−τ+ℓ−1
Since α = α(ℓ,m) is a polynomial in ℓ and m of degree at most one, the term
τ k−τ−1
is a polynomial in ℓ and m of degree at most k − 1. Hence by Lemma 2.1,
(cid:0) (cid:1)(cid:0) (cid:1)
k n
α − 1 α − τ + ℓ − 1
ℓ
(−1) W (v) = 0,
m,ℓ
τ k − τ − 1
ℓ=0 m=ℓ (cid:18) (cid:19)(cid:18) (cid:19)
X X
and so
k n α(ℓ,m) τ−α(ℓ,m)
α(k,n)
k−ℓ ℓ
W (v) = 0 for τ = 0,1,... ,k − 1.
m,ℓ
α(ℓ,m) k
(cid:0) (cid:1)(cid:0) (cid:1)
ℓ=0 m=ℓ ℓ
X X
Now, both sides of equation (2.4) (cid:0)ar(cid:1)e polynomials in τ of degree k, having the same k roots
0,1,... ,k − 1. The principal coefficient of τ is 1 , and for the left hand side, the only
k k!
term invoving τk is obtained when ℓ = k (impliying m = n), that is τ−α(k,n) . Thus its
(cid:0) (cid:1) k
(cid:0) (cid:1)

4 DANIEL BIRMAJER, JUAN B. GIL, AND MICHAEL D. WEINER
principal coefficient is also 1 . This gives (2.4) for every τ ∈ C . The identity (2.5) can be
k!
(cid:3)
verified using the same argument; this is left to the reader.
Corollary 2.6. Let α(ℓ,m) be as in Theorem 2.3. For any v ∈ π (n,k),
d
k n α(ℓ,m) τ−α(ℓ,m)
τ τ − α(0,0) + α(k,n) τ
k−ℓ ℓ
W (v) = . (2.7)
m,ℓ
α(ℓ,m) τ − α(ℓ,m) k α(k,n) τ − α(0,0) k
(cid:0) (cid:1)(cid:0) (cid:1)
ℓ=0 m=ℓ ℓ (cid:18) (cid:19)
X X
Proof. Replacing α by τ −(cid:0)α in (2.5), w(cid:1)(cid:0) e o(cid:1) btain (cid:0) (cid:1)
k n α(ℓ,m) τ−α(ℓ,m)
τ − α(0,0) τ
k−ℓ ℓ
W (v) = .
m,ℓ
τ − α(ℓ,m) k k
(cid:0) (cid:1)(cid:0) (cid:1)
ℓ=0 m=ℓ ℓ (cid:18) (cid:19)
X X
This identity together with (2.4) give the clai(cid:0)me(cid:1)d formula. (cid:3)
In the case when α(ℓ,m) = α(ℓ), the left-hand side of (2.5) can be written as
k n τ−α(ℓ,m) α(ℓ,m) k
α(0,0) α(0) τ − α(ℓ) α(ℓ)
k−ℓ ℓ
W (v) =
m,ℓ
α(ℓ,m) k α(ℓ) k − ℓ ℓ
(cid:0) (cid:1)(cid:0) (cid:1)
ℓ=0 m=ℓ ℓ ℓ=0 (cid:18) (cid:19)(cid:18) (cid:19)
X X X
n k (cid:0) (cid:1)
since W (v) = for any v ∈ π (n,k). Thus (2.5) becomes
m=ℓ m,ℓ ℓ d
P (cid:0) (cid:1) k
α(0) τ − α(ℓ) α(ℓ) τ
= , (2.8)
α(ℓ) k − ℓ ℓ k
ℓ=0 (cid:18) (cid:19)(cid:18) (cid:19) (cid:18) (cid:19)
X
and similarly, (2.7) turns into
k α(ℓ) τ−α(ℓ)
τ τ − α(0) + α(k) τ
k−ℓ ℓ
= . (2.9)
α(ℓ)(τ − α(ℓ)) α(k) τ − α(0) k
(cid:0) (cid:1)(cid:0) (cid:1)
ℓ=0 (cid:18) (cid:19)
X
(cid:0) (cid:1)
Example 2.10. With appropriate choices of τ and α(ℓ), the above equations give the well-
known Hagen–Rothe identities. For instance, with τ = x + y + kz and α(ℓ) = y + (k − ℓ)z,
the identity (2.9) gives
k
x x + ℓz y y + (k − ℓ)z x + y x + y + kz
= ,
x + ℓz ℓ y + (k − ℓ)z k − ℓ x + y + kz k
ℓ=0 (cid:18) (cid:19) (cid:18) (cid:19) (cid:18) (cid:19)
X
and with τ = x + y + kz and α(ℓ) = x + ℓz, identity (2.8) leads to
k
x x + ℓz y + (k − ℓ)z x + y + kz
= .
x + ℓz ℓ k − ℓ k
ℓ=0 (cid:18) (cid:19)(cid:18) (cid:19) (cid:18) (cid:19)
X
The special case when z = 0 is known as the Chu–Vandermonde identity:
k
x y x + y
= .
ℓ k − ℓ k
ℓ=0 (cid:18) (cid:19)(cid:18) (cid:19) (cid:18) (cid:19)
X

CONVOLUTION AND INVERSE RELATIONS FOR PARTIAL BELL POLYNOMIALS 5
Example 2.11. For τ = −1, identity (2.5) gives
k n −1−α(ℓ,m) α(ℓ,m)
α(0,0)
k−ℓ ℓ k
W (v) = (−1) .
m,ℓ
α(ℓ,m) k
(cid:0) (cid:1)(cid:0) (cid:1)
ℓ=0 m=ℓ ℓ
X X
Now, since (cid:0) (cid:1)
−1 − α(ℓ,m) α(ℓ,m) α(ℓ,m) + k − ℓ k
k−ℓ
= (−1) ,
k − ℓ ℓ k ℓ
(cid:18) (cid:19)(cid:18) (cid:19) (cid:18) (cid:19)(cid:18) (cid:19)
we then get
k n
α(0,0) α(ℓ,m) + k − ℓ
ℓ
(−1) W (v) = 1. (2.12)
m,ℓ
α(ℓ,m) k
ℓ=0 m=ℓ (cid:18) (cid:19)
X X
n k
Choosing α(ℓ,m) = z − k + ℓ with z > k, and since W (v) = , we get
m=ℓ m,ℓ ℓ
k Pk (cid:0) (cid:1)
z − k z k z k ℓ
(−1)ℓ (−1)ℓ−1
1 = = .
z − k + ℓ k ℓ k ℓ z − k + ℓ
ℓ=0 (cid:18) (cid:19)(cid:18) (cid:19) (cid:18) (cid:19) ℓ=0 (cid:18) (cid:19)
X X
In other words, we recover the known formula
k
1 k ℓ
(−1)ℓ−1
= .
z ℓ z − k + ℓ
k ℓ=1 (cid:18) (cid:19)
X
Example 2.13. Let 0 ≤ z ≤(cid:0) (cid:1)k and γ ∈ N . Choose v = (v ,v ,... ) such that v = z,
1 2 γ
v = k − z, and v = 0 for every other j. Then
γ+1 j
z k − z
W (v) =
m,ℓ
(γ + 1)ℓ − m m − γℓ
(cid:18) (cid:19)(cid:18) (cid:19)
and (2.12) turns into
k (γ+1)ℓ
α(0,0) α(ℓ,m) + k − ℓ z k − z
ℓ
(−1) = 1.
α(ℓ,m) k (γ + 1)ℓ − m m − γℓ
ℓ=0 m=γℓ (cid:18) (cid:19)(cid:18) (cid:19)(cid:18) (cid:19)
X X
Other identities can be obtained by choosing a different v.
We finish this section with a simple and straightforward abstraction of Theorem 2.3.
Theorem 2.14. Let v = (v ,v ,... ,v ) be any finite sequence of nonnegative integers with
1 2 d
v +···+v = k > 0 and v +2v +···+dv = n. Let p (τ) be polynomials in τ of degree
1 d 1 2 d m,ℓ
at most ℓ, and such that for every τ ∈ {0,1,... ,k − 1}, the function (m,ℓ) 7→ p (τ ) is
0 m,ℓ 0
a polynomial in m and ℓ of degree at most k − 1. If p (τ) has degree k in τ, then
n,k
k n
(−1)ℓ τ
p (τ)W (v) = γ ,
m,ℓ m,ℓ k
k! k
ℓ=0 m=ℓ (cid:18) (cid:19)
X X
where γ is the coefficient of τk in (−1)kp (τ).
k n,k

6 DANIEL BIRMAJER, JUAN B. GIL, AND MICHAEL D. WEINER
For example, in equation (2.4) we have
α(ℓ,m) τ−α(ℓ,m)
α(k,n)
ℓ k−ℓ ℓ
p (τ) = (−1) k! ,
m,ℓ
α(ℓ,m) k
(cid:0) (cid:1)(cid:0) (cid:1)
ℓ
(cid:0) (cid:1)
which for τ ∈ {0,1,... ,k − 1} can be written (cf. proof of Thm. 2.3) as
0
α(ℓ,m) − 1 α(ℓ,m) − τ + ℓ − 1
0
p (τ ) = τ!(k − τ − 1)!α(k,n) .
m,ℓ 0 0
τ k − τ − 1
0 0
(cid:18) (cid:19)(cid:18) (cid:19)
Recall that α(ℓ,m) is a polynomial in ℓ and m of degree at most one, thus (m,ℓ) 7→ p (τ )
m,ℓ 0
is a polynomial in ℓ and m of degree at most k − 1.
3. Identities for partial Bell polynomials
In this section we derive some convolution formulas for the partial Bell polynomials:
n! x i1 x i2
1 2
B (x ,x ,...) = ...,
n,k 1 2
i !i !··· 1! 2!
1 2
i∈ Xπ(n,k) (cid:16) (cid:17) (cid:16) (cid:17)
where π(n,k) is the set of all sequences i = (i ,i ,... ) of nonnegative integers such that
1 2
i + i + ··· = k and i + 2i + 3i + ··· = n.
1 2 1 2 3
Lemma 3.1. For any x = (x ,x ,...) and integers 0 ≤ ℓ ≤ k and 0 ≤ m ≤ n, we have
1 2
n n! x v1 x v2
1 2
B (x)B (x) = W (v) ··· ,
m,ℓ n−m,k−ℓ m,ℓ
m v !v !··· 1! 2!
1 2
(cid:18) (cid:19) v∈ Xπ(n,k) (cid:16) (cid:17) (cid:16) (cid:17)
where W (v) is defined as in (2.2).
m,ℓ
x
Proof. This is a straightforward consequence of the definitions. For simplicity, we let z = j
j
j!
and use the convenient multinomial notation
n n!
zv zv1zv2
= , = ..., and so on.
v v !v !··· 1 2
1 2
(cid:18) (cid:19)
Thus
n
B (x)B (x)
m,ℓ n−m,k−ℓ
m
(cid:18) (cid:19)
n m n − m
i j
= z z
m  i  j 
(cid:18) (cid:19) i∈π(m,ℓ)(cid:18) (cid:19) j∈π(n−m,k−ℓ)(cid:18) (cid:19)
X X
n  m n − m 
v
= z
m i v − i
(cid:18) (cid:19)v∈π(n,k)i∈π(m,ℓ)(cid:18) (cid:19)(cid:18) (cid:19)
X X

CONVOLUTION AND INVERSE RELATIONS FOR PARTIAL BELL POLYNOMIALS 7
n! v v
1 2 v
= ··· z
v !v !···  i i 
1 2 1 2
v∈π(n,k) i∈π(m,ℓ)(cid:18) (cid:19)(cid:18) (cid:19)
X X
n!  x v1 x v2 
1 2
= W (v) ···
m,ℓ
v !v !··· 1! 2!
1 2
v∈ Xπ(n,k) (cid:16) (cid:17) (cid:16) (cid:17)
(cid:3)
As a consequence of Theorem 2.14 and the previous lemma, we obtain the following
convolution formula:
Theorem 3.2. Let p (τ) be polynomials in τ with deg(p ) ≤ ℓ, and such that for every
m,ℓ m,ℓ
τ ∈ {0,1,... ,k − 1}, the function (m,ℓ) 7→ p (τ ) is a polynomial in m and ℓ of degree
0 m,ℓ 0
at most k − 1. If p (τ) has degree k in τ, then for any sequence x = (x ,x ,...),
n,k 1 2
k n
(−1)ℓ n τ
p (τ) B (x)B (x) = γ B (x),
m,ℓ m,ℓ n−m,k−ℓ k n,k
k! m k
ℓ=0 m=ℓ (cid:18) (cid:19) (cid:18) (cid:19)
X X
where γ is the coefficient of τk in (−1)kp (τ).
k n,k
Proof. By Lemma 3.1, we have
k n
(−1)ℓ n
p (τ) B (x)B (x)
m,ℓ m,ℓ n−m,k−ℓ
k!γ m
k
ℓ=0 m=ℓ (cid:18) (cid:19)
X X
k n
(−1)ℓ n! x v1 x v2
1 2
= p (τ) W (v) ···
m,ℓ m,ℓ
k!γ v !v !··· 1! 2!
k 1 2
Xℓ=0 m X=ℓ v∈ Xπ(n,k) (cid:16) (cid:17) (cid:16) (cid:17)
k n
n! (−1)ℓ x v1 x v2
1 2
= p (τ)W (v) ···
m,ℓ m,ℓ
v !v !··· k!γ 1! 2!
1 2   k !
v∈ Xπ(n,k) Xℓ=0 m X=ℓ (cid:16) (cid:17) (cid:16) (cid:17)
which by Theorem 2.14 becomes
τ n! x v1 x v2 τ
1 2
= ··· = B (x).
n,k
k v !v !··· 1! 2! k
1 2
(cid:18) (cid:19)v∈ Xπ(n,k) (cid:16) (cid:17) (cid:16) (cid:17) (cid:18) (cid:19)
(cid:3)
For the special cases in Theorem 2.3, we obtain:

8 DANIEL BIRMAJER, JUAN B. GIL, AND MICHAEL D. WEINER
Corollary 3.3. Let α(ℓ,m) be a polynomial in ℓ and m of degree at most one. For any
C
sequence x = (x ,x ,... ) and any τ ∈ , we have
1 2
k n α(ℓ,m) τ−α(ℓ,m) n
α(k,n) τ
k−ℓ ℓ m
B (x)B (x) = B (x),
m,ℓ n−m,k−ℓ n,k
α(ℓ,m) k k
(cid:0) (cid:1)(cid:0) (cid:1)(cid:0) (cid:1)
ℓ=0 m=ℓ ℓ (cid:18) (cid:19)
X X
k n τ−α(ℓ,m) α(ℓ,m) n
α(0,0) (cid:0) (cid:1) τ
k−ℓ ℓ m
B (x)B (x) = B (x).
m,ℓ n−m,k−ℓ n,k
α(ℓ,m) k k
(cid:0) (cid:1)(cid:0) (cid:1)(cid:0) (cid:1)
ℓ=0 m=ℓ ℓ (cid:18) (cid:19)
X X
And from Corollary 2.6, we ded(cid:0)u(cid:1)ce:
Corollary 3.4. For any sequence x = (x ,x ,...), we have
1 2
k n α(ℓ,m) τ−α(ℓ,m) n
τ τ
k−ℓ ℓ m τ−α(0,0)+α(k,n)
B (x)B (x) = B (x).
α(ℓ,m) τ − α(ℓ,m) k m,ℓ n−m,k−ℓ α(k,n)(τ−α(0,0)) k n,k
(cid:0) (cid:1)(cid:0) (cid:1)(cid:0) (cid:1)
ℓ=0 m=ℓ ℓ (cid:18) (cid:19)
X X
Example 3.5. Let(cid:0)r be an inte(cid:1) g(cid:0) er(cid:1) with 0 < r ≤ k. In the special case when α(ℓ,m) = r
and τ = k, the first identity in Corollary 3.3 gives
k n r k−r n
k−ℓ ℓ m
B (x) = B (x)B (x),
n,k m,ℓ n−m,k−ℓ
k
(cid:0) (cid:1)(cid:0) (cid:1)(cid:0) (cid:1)
ℓ=0 m=ℓ ℓ
X X
r k−r (cid:0) (cid:1)
and since = 0 unless ℓ = k − r, we arrive at
k−ℓ ℓ
(cid:0) (cid:1)(cid:0) (cid:1) n−r
k n
B (x) = B (x)B (x). (3.6)
n,k m,k−r n−m,r
r m
(cid:18) (cid:19) m=k−r(cid:18) (cid:19)
X
Observe that when r = 1, we get the basic recurrence formula
n−1
1 n
B (x) = x B (x), (3.7)
n,k n−m m,k−1
k m
m=k−1(cid:18) (cid:19)
X
see Comtet [5] (relation [3k], p. 136). In particular, since the Stirling numbers of second
kind satisfy S(n,k) = B (1,1,... ), formula (3.6) gives the known recurrence
n,k
n−r
k n
S(n,k) = S(m,k − r)S(n − m,r).
r m
(cid:18) (cid:19) m=k−r (cid:18) (cid:19)
X
The same recurrence holds for the unsigned Stirling numbers of first kind.
The identity (3.6) can also be found in a recent paper by Cvijovi´c [6]. There the author
gives furthermore a recurrence relation for B (see [6, equation (1.3)]) which, combined
n,k
with (3.7), leads to the interesting identity
n−1
1 n n − 1
− x B (x) = 0. (3.8)
n−m m,k−1
k m m
m=k−1(cid:20) (cid:18) (cid:19) (cid:18) (cid:19)(cid:21)
X

CONVOLUTION AND INVERSE RELATIONS FOR PARTIAL BELL POLYNOMIALS 9
4. Inverse relations
N Z C
For n ∈ , b ∈ , λ ∈ , and a sequence z = (z ,z ,... ), we define
1 2
n
λ + bk
Q (λ,z) = (k − 1)!B (z).
n,b n,k
k − 1
k=1(cid:18) (cid:19)
X
These functions appear naturally in certain compositions of formal power series. For in-
tn
stance, if Z(t) = 1 + z , then
n≥1 n n!
tn
P
log(Z(t)) = L
n
n!
n≥1
X
with L = n (−1)k−1(k − 1)!B (z) (logarithmic polynomials), see Section 3.5 in the
n k=1 n,k
book by Comtet [5]. Moreover, for any complex number r,
P
tn
Z(t)r P(r)
= 1 +
n
n!
n≥1
X
P(r) n (−1)k−1 −1
with = (r) B (z) (potential polynomials). Now, since = and
n k=1 k n,k k−1
r−1
since (r) = r (k − 1)!, we can write
k Pk−1 (cid:0) (cid:1)
(cid:0) (cid:1)L (z) = Q (−1,z) and P(r) (z) = rQ (r − 1,z). (4.1)
n n,0 n n,0
Lemma 4.2. For λ ∈ N we have
λ n−1
i n
Q (λ,z) = z + z Q (i − 1,z)
n,0 n n−m m,0
λ + 1 m
i=1 m=1(cid:18) (cid:19)
X X
Proof. Using the identity (3.7), and since B (z) = z , we have
n,1 n
n n−1
λ 1 n
Q (λ,z) − z = (k − 1)! z B (z)
n,0 n n−m m,k−1
k − 1 k m
k=2(cid:18) (cid:19) (cid:18) m=k−1(cid:18) (cid:19) (cid:19)
X X
n−1 n−1
λ k! n
= z B (z)
n−m m,k
k k + 1 m
k=1 m=k (cid:18) (cid:19) (cid:18) (cid:19)
X X
n−1 m
n k! λ + 1
= z B (z)
n−m m,k
m λ + 1 k + 1
m=1(cid:18) (cid:19) k=1 (cid:18) (cid:19)
X X
n−1 m λ
n k! i
= z B (z)
n−m m,k
m λ + 1 k
m=1(cid:18) (cid:19) k=1 (cid:18) i=1 (cid:18) (cid:19)(cid:19)
X X X
λ n−1 m
i n i − 1
= z (k − 1)!B (z).
n−m m,k
λ + 1 m k − 1
i=1 m=1(cid:18) (cid:19) k=1(cid:18) (cid:19)
X X X
(cid:3)
At last, replace the interior sum over k by Q (i − 1,z) and solve for Q (λ,z).
m,0 n,0
The next lemma is straightforward.

10 DANIEL BIRMAJER, JUAN B. GIL, AND MICHAEL D. WEINER
Lemma 4.3. Given any sequence z = (z ,z ,...), the following product formula holds:
1 2
Q (λ ,z) Q (λ ,z)
n1,b1 1 n2,b2 2
n1+n2 n2 λ1+b1(k−ℓ)+1 λ2+b2ℓ+1
k!
k−ℓ ℓ
= B (z)B (z).
n1,k−ℓ n2,ℓ
k
(λ + b (k − ℓ) + 1)(λ + b ℓ + 1)
k=2 ℓ=1 1 1(cid:0) (cid:1)(cid:0)2 2 (cid:1) ℓ
X X
(cid:0) (cid:1)
Theorem 4.4. Let a,b ∈ Z . Given x = (x ,x ,... ), define y = (y ,y ,... ) by
1 2 1 2
n
an + bk
y = Q (an,x) = (k − 1)!B (x)
n n,b n,k
k − 1
k=1(cid:18) (cid:19)
X
N C
for every n ∈ . Then, for any λ ∈ , we have
n n
λ λ + an + bk
(k − 1)!B (y) = (k − 1)!B (x). (4.5)
n,k n,k
k − 1 k − 1
k=1(cid:18) (cid:19) k=1(cid:18) (cid:19)
X X
In other words, for any λ,
Q (λ,y) = Q (λ + an,x).
n,0 n,b
Proof. At first, we assume λ to be a positive integer. As both sides of (4.5) are polynomials
C
in λ, the statement will then be valid for any λ ∈ .
We proceed by induction in n. For n = 1,
Q (λ,y) = B (y) = y = B (x) = Q (λ + a,x) for every λ.
1,0 1,1 1 1,1 1,b
N
Assume Q (λ,y) = Q (λ+am,x) for every 1 ≤ m < n and any λ ∈ . By Lemma 4.2,
m,0 m,b
λ n−1
i n
Q (λ,y) = y + y Q (i − 1,y).
n,0 n n−m m,0
λ + 1 m
i=1 m=1(cid:18) (cid:19)
X X
Since m < n, we use the induction hypothesis on Q (i − 1,y) to obtain
m,0
λ n−1
i n
Q (λ,y) − y = y Q (i − 1 + am,x)
n,0 n n−m m,b
λ + 1 m
i=1 m=1(cid:18) (cid:19)
X X
λ n−1
i n
= Q (a(n − m),x)Q (i − 1 + am,x),
n−m,b m,b
λ + 1 m
i=1 m=1(cid:18) (cid:19)
X X
which by Lemma 4.3 becomes
λ n−1 n m ̺−δ+1 δ+i
i n k!
k−ℓ ℓ
= B (x)B (x)
n−m,k−ℓ m,ℓ
λ + 1 m (̺ − δ + 1)(δ + i) k
(cid:0) (cid:1)(cid:0) (cid:1)
i=1 m=1(cid:18) (cid:19)k=2 ℓ=1 ℓ
X X XX
λ n k−1 n−1 ̺−δ+1 δ+i n
ik! (cid:0) (cid:1)
k−ℓ ℓ m
= B (x)B (x)
n−m,k−ℓ m,ℓ
λ + 1 (̺ − δ + 1)(δ + i) k
(cid:0) (cid:1)(cid:0) (cid:1)(cid:0) (cid:1)
i=1 k=2 ℓ=1 m=ℓ ℓ
XX X X
(cid:0) (cid:1)

CONVOLUTION AND INVERSE RELATIONS FOR PARTIAL BELL POLYNOMIALS 11
with ̺ = an+ bk and δ = am + bℓ. Now, with α = ̺ −δ + 1 and τ = ̺ + i + 1, the identity
from Corollary 3.4 becomes
k n ̺−δ+1 δ+i n
(̺ + i + 1) i + 1 ̺ + i + 1
k−ℓ ℓ m
B B = B .
m,ℓ n−m,k−ℓ n,k
(̺ − δ + 1)(δ + i) k i k
(cid:0) (cid:1)(cid:0) (cid:1)(cid:0) (cid:1)
ℓ=0 m=ℓ ℓ (cid:18) (cid:19)
X X
Hence
(cid:0) (cid:1)
k n ̺−δ+1 δ+i n
i + 1 ̺ + i + 1
k−ℓ ℓ m
B B = B ,
m,ℓ n−m,k−ℓ n,k
(̺ − δ + 1)(δ + i) k (̺ + i + 1)i k
(cid:0) (cid:1)(cid:0) (cid:1)(cid:0) (cid:1)
ℓ=0 m=ℓ ℓ (cid:18) (cid:19)
X X
and so the sum from ℓ = 1 to ℓ =(cid:0)k (cid:1)− 1 (as needed above) is equal to
i + 1 ̺ + i + 1 1 ̺ + i 1 ̺ + 1
− − B (x).
n,k
(̺ + i + 1)i k ̺ + i k (̺ + 1)i k
(cid:18) (cid:18) (cid:19) (cid:18) (cid:19) (cid:18) (cid:19)(cid:19)
Therefore,
Q (λ,y) − y
n,0 n
λ n ̺+i+1 ̺+i ̺+1
ik! (i + 1)
k k k
= − − B (x)
n,k
λ + 1 (̺ + 1 + i)i ̺ + i (̺ + 1)i
  (cid:0) (cid:1) (cid:0) (cid:1) (cid:0) (cid:1) !
i=1 k=2
XX
n λ ̺+i+1 ̺+i ̺+1
k! (i + 1) i
k k k
= − − B (x)
n,k
λ + 1 (̺ + i + 1) ̺ + i ̺ + 1
  (cid:0) (cid:1) (cid:0) (cid:1) (cid:0) (cid:1)!
k=2 i=1
X X
n ̺+λ+1 ̺+1
k k
= k! − B (x)
n,k
(̺ + λ + 1) ̺ + 1
  (cid:0) (cid:1) (cid:0) (cid:1)!
k=2
X
n
1 ̺ + λ 1 ̺
= k! − B (x)
n,k
k k − 1 k k − 1
k=1 (cid:18) (cid:18) (cid:19) (cid:18) (cid:19)(cid:19)
X
n
λ + an + bk an + bk
= (k − 1)! − B (x)
n,k
k − 1 k − 1
k=1 (cid:18)(cid:18) (cid:19) (cid:18) (cid:19)(cid:19)
X
= Q (λ + an,x) − Q (an,x).
n,b n,b
(cid:3)
Since y = Q (an,x), we get Q (λ,y) = Q (λ + an,x) as desired.
n n,b n,0 n,b
Remark. The identity (4.5) is also valid in the form
n n
λ λ + an + bk
(k − 1)!B (y) = (k − 1)!B (x).
n,k n,k
k − k k − k
0 0
k=k0 (cid:18) (cid:19) k=k0 (cid:18) (cid:19)
X X
λ λ+1 λ
For instance, for k = 2, this follows from the identity = − together with
0 k−2 k−1 k−1
the fact that (4.5) holds for every λ.
(cid:0) (cid:1) (cid:0) (cid:1) (cid:0) (cid:1)
Theorem 4.6. Let a,b ∈ Z , not both equal to 0. Given any sequence x = (x ,x ,... ), we
1 2
consider the sequence y = (y ,y ,... ) defined by
1 2
n
an + bk
y = (k − 1)!B (x). (4.7)
n n,k
k − 1
k=1(cid:18) (cid:19)
X

12 DANIEL BIRMAJER, JUAN B. GIL, AND MICHAEL D. WEINER
N
Then, for every n ∈ , we have
n
an + bk −an − b
x = (k − 1)!B (y). (4.8)
n n,k
an + b k − 1
k=1 (cid:18) (cid:19)
X
Proof. For k > 1 we rewrite
an + bk −an − b −an − b −an − b − 1
= − b
an + b k − 1 k − 1 k − 2
(cid:18) (cid:19) (cid:18) (cid:19) (cid:18) (cid:19)
and split the right-hand side of (4.8) as
n n
−an − b −an − b − 1
(k − 1)!B (y) − b (k − 1)!B (y).
n,k n,k
k − 1 k − 2
k=1(cid:18) (cid:19) k=2(cid:18) (cid:19)
X X
Using (4.5) with λ = −an − b we obtain
n n
−an − b b(k − 1)
(k − 1)!B (y) = (k − 1)!B (x)
n,k n,k
k − 1 k − 1
k=1 (cid:18) (cid:19) k=1(cid:18) (cid:19)
X X
n
b(k − 1)
= x + (k − 1)!B (x).
n n,k
k − 1
k=2(cid:18) (cid:19)
X
Using again the identity (4.5) now with λ = −an − b − 1, and starting at k = 2, we get
n n
−an − b − 1 b(k − 1)
b (k − 1)!B (y) = (k − 1)!B (x).
n,k n,k
k − 2 k − 1
k=2(cid:18) (cid:19) k=2(cid:18) (cid:19)
X X
(cid:3)
The statement then follows by taking the difference.
Remark. Note that equations (4.7) and (4.8) give an inverse relation: It is also true that
for any given sequence y = (y ,y ,... ), the sequence x = (x ,x ,...) defined by (4.8)
1 2 1 2
satisfies the relation (4.7).
Example 4.9. For b = 1, Theorem 4.6 gives the inverse relation
n
an + k
y = (k − 1)!B (x),
n n,k
k − 1
k=1(cid:18) (cid:19)
X
n
−an − 2
x = (k − 1)!B (y),
n n,k
k − 1
k=1(cid:18) (cid:19)
X
which can be found in [5, Theorem F, p. 151]. In particular, if x is replaced by −x, we
arrive at the symmetric relation (cf. [7, Theorem 10]):
n
an + k
k
y = (−1) (k − 1)!B (x),
n n,k
k − 1
k=1 (cid:18) (cid:19)
X
n
an + k
k
x = (−1) (k − 1)!B (y).
n n,k
k − 1
k=1 (cid:18) (cid:19)
X

CONVOLUTION AND INVERSE RELATIONS FOR PARTIAL BELL POLYNOMIALS 13
Example 4.10 (Generating function). Consider the formal power series
tn
Y (t) = 1 + y
n
n!
n≥1
X
with y as in (4.7) for any given sequence x = (x ,x ,...).
n 1 2
As mentioned at the beginning of the section, the logarithmic polynomials associated
with Y (t) are given by Q (−1,y), see (4.1). By means of Theorem 4.4, these polynomials
n,0
can then be written in terms of x, namely L (y) = Q (−1 + an,x), and so
n n,b
tn
log Y (t) = Q (−1 + an,x) .
n,b
n!
n≥1
(cid:0) (cid:1) X
(r)
Similarly, for any r, P (y) = rQ (r − 1,y) = rQ (r − 1 + an,x), thus
n n,0 n,b
tn
r
Y (t) = 1 + rQ (r − 1 + an,x) .
n,b
n!
n≥1
X
In particular, for any polynomial F(z) = m c zℓ , we have
ℓ=0 ℓ
m
tn
P
F(Y (t)) = F(1) + c · ℓQ (ℓ − 1 + an,x) .
ℓ n,b
n!
  !
n≥1 ℓ=1
X X
References
[1] E.T. Bell, Exponential polynomials, Ann. of Math., 35 (1934), pp. 258–277.
[2] C.A. Charalambides, Enumerative Combinatorics, Chapman and Hall/CRC, Boca Raton, 2002.
[3] W.S. Chou, L.C. Hsu, P.J.S. Shiue, Application of Fa`a di Bruno’s formula in characterization of inverse
relations, J. Comput. Appl. Math. 190 (2006), 151–169.
[4] W. Chu, Elementary proofs for convolution identities of Abel and Hagen–Rothe, Electron. J. Combin.
17
(2010), no. 1, Note 24, 5 pp.
[5] L. Comtet, Advanced Combinatorics: The Art of Finite and Infinite Expansions, D. Reidel Publishing
Co., Dordrecht, 1974.
[6] D. Cvijovi´c, New identities for the partial Bell polynomials, Appl. Math. Lett. 24 (2011), no. 9, 1544–
1547.
[7] M. Mihoubi, Partial Bell polynomials and inverse relations, J. Integer Seq. 13 (2010), no. 4, Article
10.4.5, 8 pp.
[8] W. Wang and T. Wang, General identities on Bell polynomials, Comput. Math. Appl. 58 (2009), no.
1, 104–118.
Department of Mathematics, Nazareth College, 4245 East Ave., Rochester, NY 14618
Penn State Altoona, 3000 Ivyside Park, Altoona, PA 16601