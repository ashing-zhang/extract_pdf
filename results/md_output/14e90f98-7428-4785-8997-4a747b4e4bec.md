Geometric Scattering on Manifolds
Michael Perlmutter∗ Guy Wolf‡ Matthew Hirn§
Dept. of CMSE† Dept. of Math. and Stat. Dept. of CMSE†
Michigan State University Université de Montréal Dept. of Mathematics
East Lansing, MI, USA Montreal, QC, Canada Michigan State University
perlmut6@msu.edu guy.wolf@umontreal.edu East Lansing, MI, USA
mhirn@msu.edu
Abstract
9102 nuJ 5  ]LM.tats[  4v86960.2181:viXra The Euclidean scattering transform was introduced nearly a decade ago
to improve the mathematical understanding of the success of convolu-
tional neural networks (ConvNets) in image data analysis and other tasks.
Inspired by recent interest in geometric deep learning, which aims to gener-
alize ConvNets to manifold and graph-structured domains, we generalize
the scattering transform to compact manifolds. Similar to the Euclidean
scattering transform, our geometric scattering transform is based on a
cascade of designed filters and pointwise nonlinearities, which enables rig-
orous analysis of the feature extraction provided by scattering layers. Our
main focus here is on theoretical understanding of this geometric scattering
network, while setting aside implementation aspects, although we remark
that application of similar transforms to graph data analysis has been stud-
ied recently in related work. Our results establish conditions under which
geometric scattering provides localized isometry invariant descriptions of
manifold signals, and conditions in which the filters used in our network
are stable to families of diffeomorphisms formulated in intrinsic manifolds
terms. These results not only generalize the deformation stability and local
roto-translation invariance of Euclidean scattering, but also demonstrate
the importance of linking the used filter structures (e.g., in geometric deep
learning) to the underlying manifold geometry, or the data geometry it
represents.
1 Introduction
Characterizing variability in data is one of the most fundamental aspects of modern data
analysis, which appears at the core of both supervised and unsupervised learning tasks.
In particular, a crucial part of typical machine learning methods is to separate informa-
tive sources of variability from disruptive sources, which are considered via deformation
groups or noise models. For example, linear classification methods aim to find a separating
hyperplane that captures undesired (i.e., irrelevant for discriminating between classes)
variance, and then eliminate it by projecting the data on normal directions of the hyperplane.
Principal component analysis (PCA), on the other hand, aims to find a hyperplane that
maximizes the captured variance, while treating directions of minimal variance as noise
directions. Nonlinear methods extend such notions to consider richer models (beyond linear
hyperplanes and projections) for capturing or eliminating variability - either task dependent
or following an assumed model for the data.
In the past decade, deep learning methods have shown impressive potential in capturing
complex nonlinear variability by using a cascade of linear transformations and simple
nonlinear activations that together form approximations of target functions. While there
∗
Corresponding author
†Computational Mathematics, Science & Engineering
‡http://guywolf.org/
§https://matthewhirn.com/
NeurIPS 2018, Integration of Deep Learning Theories Workshop, Montréal, Canada (ExtendedVersion).

is a multitude of applications where such methods are effective, some of their most pop-
ular achievements are in fields traditionally associated with signal processing in general,
and image processing (i.e., computer vision) in particular. In such settings, the data has
an inherent spatial (or temporal) structure, and collected observations form signals over
it. Convolutional neural networks (ConvNets) utilize this structure to treat their linear
transformations as convolutions of input signals with filters that are learned in the training
process. In classification applications, the resulting deep cascade of convolutional filters (and
nonlinearities) eliminates intra-class heterogeneity and results in high accuracy classifiers.
Furthermore, hidden ConvNet layers yield coefficients that isolate semantic features and
can be utilized for unsupervised feature extraction, e.g., as part of dimensionality reduction
or generative models.
In an effort to improve mathematical understanding of deep convolutional networks and
their learned features, Mallat [2010, 2012] presented the scattering transform. This transform
has an architecture similar to ConvNets, based on a cascade of convolutional filters and
simple pointwise nonlinearities in the form of complex modulus or absolute value. However,
unlike deep learning methods, this transform does not learn its filters from data, but rather
has them designed to provide guaranteed stability to a given family of deformations. As
shown in Mallat [2012], under some admissibility conditions, one can use appropriate
wavelet filter banks in the scattering transform to provide invariance to the actions of Lie
groups. Moreover, the resulting scattering features also provide Lipschitz stability to small
diffeomorphisms, where the size of a diffeomorphism is quantified by its deviation from
a translation. These notions were made concrete in Bruna and Mallat [2011, 2013], Sifre
and Mallat [2012, 2013, 2014] and Oyallon and Mallat [2015] using groups of translations,
rotations, and scaling operations, with applications in image and texture classification.
Further applications of the scattering transform and its deep filter bank approach were
shown effective in several fields, such as audio processing [Andén and Mallat, 2011, 2014,
Wolf et al., 2014, 2015, Andén et al., 2018], medical signal processing [Chudácek et al., 2014],
and quantum chemistry [Hirn et al., 2017, Eickenberg et al., 2017, 2018, Brumwell et al.,
2018].
Another structure often found in modern data is that of a graph between collected obser-
vations or features. Such structure naturally arises, for example, in transportation and
social networks, where weighted edges represent connections between locations (e.g., roads
or other routes) or user profiles (e.g., friendships or exchanged communications). They
are also common when representing molecular structures in chemical data, or biological
interactions in biomedical data. Relatedly, signals supported on manifolds or manifold
valued data is also becoming increasing prevalent, in particular in shape matching and
computer graphics. Manifold models for high dimensional data also arise in the field of
manifold learning [e.g., Tenenbaum et al., 2000, Coifman and Lafon, 2006a, van der Maaten
and Hinton, 2008], in which unsupervised algorithms infer data-driven geometries and use
them to capture intrinsic structure and patterns in data. As such, a large body of work has
emerged to explore the generalization of spectral and signal processing notions to manifolds
[e.g., Coifman and Lafon, 2006b] and graphs [Shuman et al., 2013, and references therein]. In
these settings, functions are supported on the manifold or the vertices of the graph, and the
eigenfunctions of the Laplace-Beltrami operator or the eigenvectors of the graph Laplacian
serve as the Fourier harmonics.
This increasing interest in non-Euclidean data, particularly graphs and manifolds, has led
to a new research direction known as geometric deep learning, which aims to generalize
convolutional networks to graph and manifold structured data [Bronstein et al., 2017, and
references therein]. Unlike classical ConvNets, in which filters are learned on collected data
features (i.e., in spatial or temporal domain), many geometric deep learning approaches for
manifolds learn spectral coefficients of their filters [Bruna et al., 2014, Defferrard et al., 2016,
Levie et al., 2017, Yi et al., 2017]. The frequency spectrum is defined by the eigenvalues of
the Laplace-Beltrami operator on the manifold, which links geometric deep learning with
manifold and graph signal processing.
Inspired by geometric deep learning, recent works have also proposed an extension of
the scattering transform to graph domains. These mostly focused on finding features that
represent a graph structure (given a fixed set of signals on it) while being stable to graph
2

perturbations. In Gama et al. [2018], a cascade of diffusion wavelets from Coifman and
Maggioni [2006] was proposed, and its Lipschitz stability was shown with respect to a
global diffusion-inspired distance between graphs. A similar construction discussed in Zou
and Lerman [2018] was shown to be stable to permutations of vertex indices, and to small
perturbations of edge weights. Finally, Gao et al. [2018] established the viability of scattering
coefficients as universal graph features for data analysis tasks (e.g., in social networks and
biochemistry data).
In this paper, we take the less charted path and consider the manifold aspect of geometric
deep learning. In this setting, one needs to process signals over a manifold, and in particular,
torepresentthemwithfeaturesthatarestabletoorientations, noise, ordeformationsoverthe
manifold geometry. In order to work towards these aims, we define a scattering transform
on compact smooth Riemannian manifolds without boundary, which we call geometric
scattering. Our construction is based on convolutional filters defined spectrally via the
eigendecomposition of the Laplace-Beltrami operator over the manifold, as discussed in
Section 3. We show that these convolutional operators can be used to construct a frame,
which, with appropriately chosen low-pass and high-pass filters, forms a wavelet frame
similar to the diffusion wavelets constructed in Coifman and Maggioni [2006]. Then,
in Section 4, a cascade of these generalized convolutions and pointwise absolute value
operations is used to map signals on the manifold to scattering coefficients that encode
approximate local invariance to isometries, which correspond to translations, rotations, and
reflections in Euclidean space. In Section 5, we analyze the commutators of the filters used
in our network with the action of diffeomorphisms. We believe that the results presented
there will allow us to study the stability of our scattering network to these diffeomorphisms
in future work using a notion of stability that analogous to the Lipschitz stability considered
in Mallat [2012] on Euclidean space. As we discuss in Section 5, this requires a quantitative
notion of deformation size. We consider three formulations of such a notion, which measure
how far a given diffeomorphism is from being an isometry, and explore the type of stability
that can be achieved for the geometric scattering transform with respect to each of them.
Our results provide a path forward for utilizing the scattering mathematical framework
to analyze and understand geometric deep learning, while also shedding light on the
challenges involved in such generalization to non-Euclidean domains.
1.1 Notation
Let M be a smooth, compact, and connected, d-dimensional Riemannian manifold without
boundary contained in Rn . Let r : M × M → R denote the geodesic distance between
two points, and let ∆ be the Laplace-Beltrami operator on M. The eigenfunctions and
non-unique eigenvalues of −∆ are denoted by ϕ and λ , respectively. Since M is compact,
k k
the spectrum of −∆ is countable and we may assume that {ϕ k} k∈N forms an orthonormal
basis for L2(M). We define the Fourier transform of f ∈ L2(M) as the sequence f(cid:98) ∈ (cid:96)2
defined by f(cid:98)(k) = (cid:104)f, ϕ (cid:105). The set of unique eigenvalues of −∆ is denoted by Λ , and for
k
λ ∈ Λ we let m(λ) and E denote the corresponding multiplicities and eigenspaces. The
λ
diffeomorphism group of M is Diff(M), and the isometry group is Isom(M) ⊂ Diff(M).
For a diffeomorphism ζ ∈ Diff(M), we let V be the operator V f(x) = f(ζ−1(x)), and
ζ ζ
let (cid:107)ζ(cid:107) ∞ = sup r(x,ζ(x)). We let C(M) denote a constant which depends only on the
x∈M
manifold M, and for two operators A and B defined on L2(M), we let [A,B] := AB − BA
denote their commutator.
2 Problem Setup
We consider signals f ∈ L2(M) and representations Θ : L2(M) → (cid:96)2(L2(M)), which
encode information about the signal, often referred to as the “features” of f. A common
goal in machine learning tasks is to classify or cluster signals based upon these features.
However, we often want to consider two signals, or even two manifolds, to be equivalent
if they differ by the action of a global isometry. Therefore, we seek to construct a family
of representations, (Θ ) , which are invariant to isometric transformations of any
t t∈(0,∞)
3

f ∈ L2(M) up to the scale t. Such a representation should satisfy a condition similar to,
(cid:107)Θ (f) − Θ (V f)(cid:107) ≤ α(ζ)β(t)(cid:107)f(cid:107) , ∀ f ∈ L2(M), ζ ∈ Isom(M), (1)
t t ζ 2,2 2
where α(ζ) measures the size of the isometry with α(id) = 0, and β(t) decreases to zero as
the scale t grows to infinity.
Along similar lines, it is desirable that the action of small diffeomorphisms on f, or on
the underlying manifold M, should not have a large impact on the representation of the
inputted signal for tasks such as classification or regression. However, the set of Diff(M)
is a large group and invariance over Diff(M) would collapse the variability even between
vastly different signals. Thus, in this case, we want a family (Θ ) that is stable to
t t∈(0,∞)
diffeomorphism actions on f, but not invariant. This leads to a condition such as:
(cid:107)Θ (f) − Θ (V f)(cid:107) ≤ A(ζ)(cid:107)f(cid:107) , ∀t ∈ (0,∞), f ∈ L2(M), ζ ∈ Diff(M), (2)
t t ζ 2,2 2
where A(ζ) measures how much ζ differs from being an isometry, with A(ζ) = 0 if ζ ∈
Isom(M) and A(ζ) > 0 if ζ ∈/ Isom(M).
Combining (1) and (2), we have the following goal:
(cid:107)Θ (f) − Θ (V f)(cid:107) ≤ [α(ζ)β(t)+A(ζ)](cid:107)f(cid:107) , (3)
t t ζ 2,2 2
∀t ∈ (0,∞), f ∈ L2(M), ζ ∈ Diff(M).
At the same time, the representations (Θ ) should not be trivial. Indeed, distinguish-
t t∈(0,∞)
ing different classes or types of signals often requires leveraging subtle information in
the signals. This information is often stored in the high frequencies, i.e., f(cid:98)(k) for large k.
Our problem is thus to find a family of representations that are stable to diffeomorphisms,
discriminative between different types of signals, which allow one to control the scale of
isometric invariance, and do so for data that is supported on a manifold. The wavelet
scattering transform of Mallat [2012] achieves goals analogous to the ones presented here,
but for Euclidean supported signals. Therefore, we seek to construct a geometric version of
the scattering transform, using filters corresponding to the spectral geometry of M, and to
show that it has similar properties to its Euclidean counterpart.
3 Spectral Integral Operators
Similar to traditional ConvNets, the Euclidean scattering transform constructed in Mallat
[2012] consists of an alternating cascade of convolutions and nonlinearities. In the manifold
setting, it is not immediately clear how to define convolution operators, because translation
is not well defined. In this section, we introduce a family of operators on L2(M) that
are analogous to convolution operators on Euclidean space due to the characterization of
Euclidean convolution operators as Fourier multipliers. These operators will then be used
in Sec. 4 to construct the geometric scattering transform.
For a function η : Λ → R , we define a spectral kernel K by
η
∑
K (x,y) = η(λ )ϕ (x)ϕ (y) (4)
η k k k
k∈N
and refer to the integral operator T , with kernel K , as a spectral integral operator. Grouping
η η
together the ϕ belonging to each eigenspace E , we write
k λ
∑ η(λ)K(λ)
K (x,y) = (x,y), (5)
η
λ∈Λ
where K(λ)(x,y) = ∑ λ =λ ϕ k(x)ϕ k(y). Using the fact that {ϕ k} k∈N is an orthonormal basis
k
for L2(M), a simple calculation shows that
∑
(cid:107)T f(cid:107)2 = |η(λ )|2|(cid:104)f, ϕ (cid:105)|2 ≤ (cid:107)η(cid:107)2 (cid:107)f(cid:107)2 , (6)
η 2 k k ∞
k∈N
4

∞
and so, if η ∈ L , then T is a bounded operator of L2(M) with operator norm (cid:107)η(cid:107) ∞. In
η
particular, if (cid:107)η(cid:107) ∞ ≤ 1, then T is nonexpansive. Operators of this form are analogous to
η
Rd
convolution operators defined on since the latter are diagonalized in the Fourier basis.
To further emphasize this connection, we note the following theorem, which shows that
spectral integral operators are equivariant with respect to isometries.
Theorem 3.1. For every spectral integral operator T , and for every f ∈ L2(M),
η
T V f = V T f, ∀ζ ∈ Isom(M).
η ζ ζ η
Proof. Let ζ be an isometry and let ψ (x) = ϕ (ζ(x)). For λ ∈ Λ and x ∈ M, we define
k k
(cid:126)ϕ (x) ∈ Cm(λ) and ψ(cid:126) (x) ∈ Cm(λ) by
λ λ
(cid:126)ϕ (x) = (ϕ (x)) and ψ(cid:126) (x) = (ψ (x)) .
λ k k:λ =λ λ k k:λ =λ
k k
Since ζ is an isometry, {ϕ } and {ψ } are both orthonormal bases for E . There-
k k:λ =λ k k:λ =λ λ
k k
fore, there exists an m(λ) × m(λ) unitary matrix A (that does not depend upon x) such
λ
that ψ(cid:126) (x) = A (cid:126)ϕ (x). Using this fact, we see
λ λ λ
K(λ) (ζ(x),ζ(y)) = ∑ ϕ (ζ(x)) ϕ (ζ(y)) = ∑ ψ (x)ψ (y) = (cid:104)ψ(cid:126) (x),ψ(cid:126) (y)(cid:105)
k k k k λ λ
k:λ =λ k:λ =λ
k k
K(λ)
= (cid:104)A (cid:126)ϕ (x), A (cid:126)ϕ (y)(cid:105) = (cid:104)(cid:126)ϕ (x),(cid:126)ϕ (y)(cid:105) = (x,y).
λ λ λ λ λ λ
Therefore, by (5), we see that K (ζ(x),ζ(y)) = K (x,y) for all (x,y) ∈ M×M. Now letting
η η
x = ζ(x) and changing variables y = ζ(z), we have
(cid:101)
(cid:90) (cid:16) (cid:17) (cid:90)
ζ−1(y)
T V f(x) = K (x,y)f dV(y) = K (x,ζ(z)) f(z)dV(z)
η ζ η η
M M
(cid:90) (cid:90)
= K (ζ(x),ζ(z))f(z)dV(z) = K (x,z) f(z)dV(z)
η (cid:101) η (cid:101)
M M
(cid:16) (cid:17)
ζ−1(x)
= T f(x) = T f = V T f(x)
η (cid:101) η ζ η
as desired.
We will consider frame analysis operators that are constructed using a countable family of
spectral integral operators. We call a spectral function g : [0,∞) → R a low-pass filter if
|g(λ)| ≤ g(0) = 1, ∀λ ≥ 0, and lim g(λ) = 0. (7)
λ→∞
Similarly, we call h : [0,∞) → R a high-pass filter if
h(0) = 0 and (cid:107)h(cid:107) ∞ ≤ 1.
Figure 1(a) illustrates a low-pass operator T , via its impulse responses, on the popular
g
Stanford bunny [Turk and Levoy, 2005] manifold.
We will assume that we have a low-pass filter g, and a family of high-pass filters {h γ} γ∈Γ,
which satisfy a Littlewood-Paley type condition
(cid:34) (cid:35)
A ≤ m(λ) |g(λ)|2 + ∑ |h (λ)|2 ≤ B, ∀λ ∈ Λ (8)
γ
γ∈Γ
for some 0 < A ≤ B. A frame analysis operator Φ : L2(M) → (cid:96)2(L2(M)) is then defined
by
(cid:110) (cid:111)
Φ f = T f, T f : γ ∈ Γ ,
g h
γ
where T and T are the spectral integral operators corresponding to g and h , respectively.
g h γ
γ
Φ
The Littlewood-Paley type condition (8) implies that the filters used to define evenly
cover the frequencies of M. The following proposition shows that if g and {h γ} γ∈Γ satisfy
Φ
(8), then has corresponding upper and lower frame bounds.
5

2J=1 2J=2 2J=4
raewapliat
(a) (b)
Figure 1: (a) Illustration of T δ over the Stanford bunny manifold [Turk and Levoy, 2005], with g a Gaussian
g x
restricted to [0,∞) at scale 2J for three log -scales J, and three Diracs δ centered at different regions of the
2 x
manifold. (b) The geometric scattering transform. Black: Equivariant intermediate layers. Blue: Invariant
output coefficients at each layer.
Proposition 3.2. Under the Littlewood-Paley condition (8), Φ is a bounded operator from L2(M)
to (cid:96)2(L2(M)) and
A(cid:107)f(cid:107)2 ≤ (cid:107)Φ f(cid:107)2 := (cid:107)T f(cid:107)2 + ∑ (cid:107)T f(cid:107)2 ≤ B(cid:107)f(cid:107)2 , ∀ f ∈ L2(M).
2 2,2 g 2 h γ 2 2
γ∈Γ
In particular, if A = B = 1, then Φ is an isometry.
Proposition 3.2 is proved by using (6) to write
(cid:107)Φ f(cid:107)2 = (cid:107)T f(cid:107)2 + ∑ (cid:107)T f(cid:107)2 = ∑ |g(λ )|2|(cid:104)f, ϕ (cid:105)|2 + ∑ ∑ |h (λ )|2|(cid:104)f, ϕ (cid:105)|2 .
2,2 g 2 h γ 2 k k γ k k
γ∈Γ k∈N γ∈Γ k∈N
We then group together the terms corresponding to each eigenspace, E , apply (8), and then
λ
use Parseval’s Identity. Note that for each λ ∈ Λ , |g(λ)|2 and |h(λ)|2 each appear m(λ)
times in the above sum. It is for this reason that the term m(λ) is needed in (8). For full
details of the proof, see Appendix A.
3.1 Geometric Wavelet Transforms
Φ
As an important example of the frame analysis operator , we define a geometric wavelet
transform in terms of a single low-pass filter. Given a spectral function, η : [0,∞) → R , we
j
define the dilation at scale 2 by
η (λ) = η(2j λ),
j
and a normalized spectral function η : Λ → R by
(cid:101)j
η (λ)
j
η (λ) = . (9)
(cid:101)j (cid:112)
m(λ)
√ 1
The normalization factor of will ensure that the wavelet frame constructed below
m(λ)
satisfies the Littlewood-Paley condition (8).
Let g : [0,∞) → R , be a nonincreasing low-pass filter, and let J ∈ Z . In a manner analogous
to classical wavelet constructions, [see for example, Meyer, 1993], we define a high-pass
filter h : [0,∞) → R by
(cid:104) (cid:105)1
h(λ) = |g(λ/2)|2 − |g(λ)|2 2 (10)
and observe that
(cid:104) (cid:105)1
h (λ) = |g (λ)|2 − |g (λ)|2 2 . (11)
j j−1 j
6

To emphasize the connection with classical wavelet transforms, we denote T = A and
g˜ J
J
T = W . The geometric wavelet transform W : L2(M) → (cid:96)2(L2(M)) is then defined as
h˜ j J
j
W f = {A f, W f} .
J J j j≤J
The following proposition can be proved by observing that
(cid:34) (cid:35)
(cid:20) (cid:21)
m(λ) (cid:12) (cid:12)g (λ)(cid:12) (cid:12)2 + ∑ (cid:12) (cid:12) (cid:101)h (λ)(cid:12) (cid:12)2 = (cid:12) (cid:12) g(cid:16) 2J λ(cid:17)(cid:12) (cid:12)2 + ∑ (cid:12) (cid:12) g(cid:16) 2j−1 λ(cid:17)(cid:12) (cid:12)2 − (cid:12) (cid:12) g(cid:16) 2j λ(cid:17)(cid:12) (cid:12)2
(cid:101)J (cid:12) j (cid:12) (cid:12) (cid:12) (cid:12) (cid:12) (cid:12) (cid:12)
j≤J j≤J
forms a telescoping sum, and that therefore, {A ,W } satisfies the Littlewood-Paley
J j j≤J
condition (8) with A = B = 1. We give a complete proof in Appendix B.
Proposition 3.3. For all J ∈ Z , the geometric wavelet transform W is an isometry from L2(M)
J
to (cid:96)2(L2(M)), i.e.,
(cid:107)W f(cid:107) = (cid:107)f(cid:107) , ∀ f ∈ L2(M).
J 2,2 2
Animportantexampleis g(λ) = e−λ. Inthiscasethelow-passkernel G (x,y) corresponding
J
to T is the heat kernel on M at time t = 2J , the kernel G(cid:101) (x,y) corresponding to A = T
g J J g˜
J J
is a normalized version, and the corresponding wavelet operators W are similar to the
j
diffusion wavelets introduced in Coifman and Maggioni [2006]. The key difference between
the construction presented here and the original diffusion wavelet construction is the
normalization of the spectral function according to the multiplicity of each eigenvalue,
which is needed to obtain an isometric wavelet transform.
4 The Geometric Scattering Transform
The geometric scattering transform is a nonlinear operator S : L2(M) → (cid:96)2(L2(M)) con-
structed through an alternating cascade of spectral integral operators and nonlinearities. Let
M : L2(M) → L2(M) be the modulus operator, Mf(x) = |f(x)|, and for each γ ∈ Γ , we let
U f(x) = MT f(x) = |T f(x)|.
γ h h
γ γ
For m ≥ 1, let Γ m be the set of all paths of the form (cid:126)γ = (γ 1,...,γ m), and let Γ ∞ = ∪∞ m=1Γ m
denote the set of a all finite paths. For (cid:126)γ ∈ Γ , m ≥ 1 let
m
U f(x) = U ···U f(x), (cid:126)γ = (γ ,...,γ ).
(cid:126)γ γ m γ 1 1 m
We define an operator U : L2(M) → (cid:96)2(L2(M)), called the scattering propagator, by
Uf = {U f : (cid:126)γ ∈ Γ ∞}.
(cid:126)γ
Γ
In a slight abuse of notation, we include the “empty-path” of length zero in ∞, and define
U to be the identity if γ is the empty path.
γ
The scattering transform S (cid:126)γ over a path (cid:126)γ ∈ Γ ∞ is defined as the integration of U γ against
the low-pass integral operator T , i.e., S f(x) = T U f(x) . The operator S : L2(M) →
g (cid:126)γ g (cid:126)γ
(cid:96)2(L2(M)) given by
Sf = {S f : (cid:126)γ ∈ Γ ∞},
(cid:126)γ
is referred to as the geometric scattering transform. It is a mathematical model for geometric
ConvNets that are constructed out of spectral filters. The following proposition shows that
S is nonexpansive if the Littlewood-Paley condition holds with B = 1, which we assume for
the rest of the paper. The proof is nearly identical to Proposition 2.5 of Mallat [2012], and is
thus omitted.
Proposition 4.1. If the Littlewood-Paley condition (8) holds with B = 1, then
(cid:107)Sf − Sf (cid:107) ≤ (cid:107)f − f (cid:107), ∀ f , f ∈ L2(M).
1 2 2,2 1 2 1 2
7

The scattering transform is invariant to the action of the isometry group on the inputted
signal f up to a factor that depends upon the decay of the low-pass spectral function g. If
|g(λ)| ≤ C e−tλ for some constant C and t > 0 (e.g., the heat kernel), then the following
0 0
td
theorem establishes isometric invariance up to the scale .
Theorem 4.2. Let ζ ∈ Isom(M) and |g(λ)| ≤ C e−tλ for some constant C and t > 0. Then
0 0
there exists a constant C(M) < ∞ , such that
(cid:107)Sf − SV f(cid:107) ≤ C C(M)t−d(cid:107)ζ(cid:107) ∞(cid:107)Uf(cid:107) , ∀ f ∈ L2(M).
ζ 2,2 0 2,2
Proof. We rewrite Sf − SV f = [V ,S]f + Sf − V Sf. Theorem 3.1 proves that spectral
ζ ζ ζ
integral operators commute with isometries. Since the modulus operator does as well, it
follows that [V ,S]f = 0 and
ζ
(cid:107)Sf − SV f(cid:107) = (cid:107)Sf − V Sf(cid:107) .
ζ 2,2 ζ 2,2
Since S = T U, we see that
g
(cid:107)Sf − V Sf(cid:107) = (cid:107)T Uf − V T Uf(cid:107) ≤ (cid:107)T − V T (cid:107)(cid:107)Uf(cid:107) , (12)
ζ 2,2 g ζ g 2,2 g ζ g 2,2
Since |g(λ)| ≤ C e−tλ, Lemma 4.3 stated below shows that
0
0C(M)t−d(cid:107)ζ(cid:107)
(cid:107)T − V ζT g(cid:107) ≤ C ∞,
g
which completes the proof.
Lemma 4.3. There exists a constant C(M) > 0, such that for every spectral integral operator, T ,
η
and for every ζ ∈ Diff(M),
(cid:32) (cid:33)
(cid:107)T f − V T f(cid:107) ≤ C(M) ∑ η(λ )λd/2 (cid:107)ζ(cid:107) ∞(cid:107)f(cid:107) , ∀ f ∈ L2(M).
η ζ η k k 2
k∈N
Moreover, if |η(λ)| ≤ C e−tλ for some constant C and some t > 0, then there exists a constant
0 0
C(cid:48)(M) > 0 such that for any ζ ∈ Diff(M),
(cid:107)T f − V T f(cid:107) ≤ C C(cid:48) (M)t−d(cid:107)ζ(cid:107) ∞(cid:107)f(cid:107) , ∀ f ∈ L2(M).
η ζ η 0 2
We give the proof of Lemma 4.3 in Appendix C.
5 Stability to Diffeomorphisms
In the previous section, we showed that the scattering transform is invariant to the action
of isometries up to a factor depending on the scale t. In Mallat [2012], it is shown that
the Euclidean scattering transform is stable to the action of certain diffeomorphisms that
are close to being translations. In an effort to prove analogous results for the geometric
scattering transform, we introduce three quantities A , A , and A , which measure how far
1 2 3
away a diffeomorphism is from being an isometry. If ζ is an isometry, then by definition
r(ζ(x),ζ(y)) = r(x,y) for all x and y in M. This motivates us to define
(cid:12) (cid:12)
(cid:12)r (ζ(x),ζ(y)) − r(x,y) (cid:12)
A (ζ) := sup (cid:12) (cid:12). (13)
1
(cid:12) r(x,y) (cid:12)
x,y∈M
x(cid:54)=y
It is also known [see for example, Kobayashi and Nomizu, 1963] that isometries are volume
preserving in the sense that |det[Dζ(x)]| = 1 for all x ∈ M. Therefore, we introduce the
quantity
(cid:32) (cid:33)(cid:32) (cid:33)
(cid:12) (cid:12) (cid:12) (cid:12)
A (ζ) := sup (cid:12)|det[Dζ(x)]| − 1(cid:12) sup (cid:12) det[Dζ−1(x)](cid:12) , (14)
2 (cid:12) (cid:12) (cid:12) (cid:12)
x∈M x∈M
which measures how much a ζ distorts volumes. Lastly,
A (ζ) := inf{sup{r(ζ(x),ζ (x))} : ζ ∈ Isom(M)}
3 1 1
x
8

measures the distance from ζ to the isomtery group in the sup norm. We note that
A (ζ) = inf{sup{r (ζ(x),ζ (x))} : ζ ∈ Isom(M)}
3 1 1
x
(cid:16) (cid:17)
(ζ−1
= inf{sup{r ◦ ζ)(x),x } : ζ ∈ Isom(M)}
1 1
x
(cid:110) (cid:111)
(cid:107)ζ−1
= inf ◦ ζ(cid:107) ∞ : ζ ∈ Isom(M)
1 1
= inf{(cid:107)ζ (cid:107) ∞ : ζ = ζ ◦ ζ , ζ ∈ Isom(M)}.
2 1 2 1
Thus, A (ζ) will be small if ζ can be factored into a global isometry ζ and a small perturba-
3 1
tion ζ .
2
A key step to showing that the Euclidean scattering transform S is stable to the action of
Euc
certain diffeomorphisms is a bound on the commutator norm (cid:107)[S ,V ]f(cid:107) . This bound
Euc ζ 2,2
is then combined with a bound on (cid:107)S f − V S f(cid:107) , which is obtained by methods
Euc ζ Euc 2,2
similar to those used to prove Theorem 4.2, and the triangle inequality to produce a bound
on (cid:107)S f − V S f(cid:107) . This motivates us to study the commutator of spectral integral
Euc ζ Euc 2,2
operators with V for diffeomorphisms that are close to being isometries. To this end, in the
ζ
two theorems below, we show that (cid:107)[T ,V ](cid:107) can be controlled in terms of the quantities
η ζ
A , A , and A , as well η-dependent quantities.
1 2 3
Theorem 5.1. There exists a constant C(M) > 0 such that if T is a spectral integral operator and
η
ζ ∈ Diff(M), then for all f ∈ L2(M),
 
(cid:32) (cid:33)1 (cid:32) (cid:33)
2
(cid:107)[T ,V ]f(cid:107) ≤ C(M)  ∑ η(λ )2 A (ζ) + ∑ η(λ )λd/2 A (ζ) (cid:107)f(cid:107) . (15)
η ζ 2 k 2 k k 3 2
k∈N k∈N
On certain manifolds, we can prove a modified version of Theorem 5.1 that replaces the
term A (ζ) with A (ζ).
3 1
Definition 1. A manifold M is said to be homogeneous (with respect to the action of the
isometry group), if for any two points, x,y ∈ M, there exists an isometry ζ˜ : M → M such
that ζ˜(x) = y.
Definition 2. A manifold M is said to be two-point homogeneous, if for any two pairs of
points, (x ,x ), (y ,y ) such that r(x ,x ) = r(y ,y ), there exists an isometry ζ˜ : M → M
1 2 1 2 1 2 1 2
such that ζ˜(x ) = y and ζ˜(x ) = y .
1 1 2 2
Theorem 5.2. If M is two-point homogeneous, then there exists a constant C(M) > 0 such that if
T is spectral integral operator and ζ ∈ Diff(M), then for all f ∈ L2(M),
η
 
(cid:32) (cid:33) (cid:32) (cid:33)1
2
∑ )λ(d+1)/4 ∑
(cid:107)[T ,V ]f(cid:107) ≤ C(M) A (ζ) η(λ + A (ζ) η(λ )2 (cid:107)f(cid:107) .
η ζ 2 1 k k 2 k 2
k∈N k∈N
The proofs of Theorems 5.1 and 5.2 are in Appendices D and E. The keys to these proofs
are Lemmas 5.3, 5.4, and 5.5 below, as well as the fact that spectral kernels are radial on
two-point homogeneous manifolds. For proofs of these lemmas, please see Appendices F,
G, and H. We note that the assumption that K is radial, made in Lemma 5.4, is equivalent to
the assumption (16), made in Lemma 5.3, on two-point homogeneous manifolds, but is a
stronger assumption in general.
Lemma 5.3. There exists a constant C(M) > 0 such that if ζ ∈ Diff(M) and T is a kernel
integral operator on L2(M) with a kernel that is invariant to the action of isometries, i.e.,
(cid:0) (cid:1)
K ζ˜(x),ζ˜(y) = K(x,y), ∀ζ˜ ∈ Isom(M), (16)
then
(cid:104) (cid:105)
(cid:107)[T,V ]f(cid:107) ≤ C(M) (cid:107)K(cid:107) A (ζ) + (cid:107)∇K(cid:107) ∞A (ζ) (cid:107)f(cid:107) , ∀ f ∈ L2(M).
ζ 2 L2(M×M) 2 3 2
9

Lemma 5.4. There exists a constant C(M) > 0 such that if T is a kernel integral operator with a
radial kernel K(x,y) = κ(r(x,y)), κ ∈ C1(R), and ζ ∈ Diff(M), then
(cid:104) (cid:105)
(cid:107)[T,V ]f(cid:107) ≤ C(M) (cid:107)∇K(cid:107) ∞A (ζ) + (cid:107)K(cid:107) A (ζ) (cid:107)f(cid:107) , ∀ f ∈ L2(M).
ζ 2 1 L2(M×M) 2 2
(cid:13) (cid:13)
Lemma 5.5. There exists a constant C(M) > 0 such that (cid:13)∇K(λ)(cid:13) ≤ C(M)m(λ)λd/2 for all
(cid:13) (cid:13)
∞
λ ∈ Λ . As a consequence, if K is a spectral kernel, then
η
(cid:107)∇K (cid:107) ∞ ≤ C(M) ∑ η(λ)m(λ)λd/2 = C(M) ∑ η(λ )λd/2 .
η k k
λ∈Λ k∈N
(cid:13) (cid:13)
Furthermore, if M is homogeneous, then (cid:13)∇K(λ)(cid:13) ≤ C(M)m(λ)λ(d+1)/4 and (cid:107)∇K (cid:107) ∞ ≤
(cid:13) (cid:13) η
∞
k(d+1)/4
C(M)∑ k∈N η(λ k)λ .
6 Conclusion
The generalization of convolutional neural networks to non-Euclidean domains has been the
focus of a significant body of work recently, generally referred to as geometric deep learning.
In the process, various challenges have arisen, both computational and mathematical, with
the fundamental question being whether the success of ConvNets on traditional signals
can be replicated on more complicated geometric settings such as graphs and manifolds.
We have presented geometric scattering as a mathematical framework for analyzing the
theoretical potential of deep convolutional networks in such settings, in a manner analogous
to the approach used by Mallat [2010, 2012] in the Euclidean setting. Our construction is
also closely related to recent attempts at defining finite-graph scattering [Gama et al., 2018,
Zou and Lerman, 2018, Gao et al., 2018]. Our construction is defined in a continuous setting
and therefore, we view it is a more direct generalization of the original Euclidean scattering
transform. Datasets defined on certain graphs can then be viewed as finite subsamples of
the underlying manifold, and the graph scattering transform presented in Gao et al. [2018]
can be viewed as a discretized version of the construction presented here. Finally, our
stability results provided here not only establish the potential of deep cascades of designed
filters to enable rigorous analysis in geoemtric deep learning; they also provide insights into
the challenges that arise in non-Euclidean settings, which we expect will motivate further
investigation in future work.
Acknowledgments
This research was partially funded by: IVADO (l’institut de valorisation des données) [G.W.];
the Alfred P. Sloan Fellowship (grant FG-2016-6607), the DARPA Young Faculty Award
(grant D16AP00117), and NSF grant 1620216 [M.H.].
References
Joakim Andén and Stéphane Mallat. Multiscale scattering for audio classification. In
Proceedings of the 12th International Conference on Music Information Retrieval (ISMIR 2011),
pages 657–662, 2011.
Joakim Andén and Stéphane Mallat. Deep scattering spectrum. IEEE Transactions on Signal
Processing, 62(16):4114–4128, August 2014.
Joakim Andén, Vincent Lostanlen, and Stéphane Mallat. Classification with joint time-
frequency scattering. arXiv:1807.08869, 2018.
Pierre Bérard, Gérard Besson, and Sylvestre Gallot. Embedding Riemannian manifolds by
their heat kernel. Geometric and Functional Analysis, 4(4):373–398, 1994.
Michael M. Bronstein, Joan Bruna, Yann LeCun, Arthur Szlam, and Pierre Vandergheynst.
Geometric deep learning: Going beyond Euclidean data. IEEE Signal Processing Magazine,
34(4):18–42, 2017.
10

Xavier Brumwell, Paul Sinz, Kwang Jin Kim, Yue Qi, and Matthew Hirn. Steerable wavelet
scattering for 3D atomic systems with application to Li-Si energy prediction. In NeurIPS
Workshop on Machine Learning for Molecules and Materials, 2018. arXiv:1812.02320.
Joan Bruna and Stéphane Mallat. Classification with scattering operators. In 2011 IEEE
Conference on Computer Vision and Pattern Recognition (CVPR), pages 1561–1566, 2011.
Joan Bruna and Stéphane Mallat. Invariant scattering convolution networks. IEEE Transac-
tions on Pattern Analysis and Machine Intelligence, 35(8):1872–1886, August 2013.
Joan Bruna, Wojciech Zaremba, Arthur Szlam, and Yann LeCun. Spectral networks and
deep locally connected networks on graphs. In International Conference on Learning Repre-
sentations (ICLR), 2014.
Václav Chudácek, Ronen Talmon, Joakim Andén, Stéphane Mallat, Ronald R Coifman,
Patrice Abry, and Muriel Doret. Low dimensional manifold embedding for scattering co-
efficients of intrapartum fetale heart rate variability. In 36th Annual International Conference
of the IEEE Engineering in Medicine and Biology Society, pages 6373–6376, 2014.
Ronald R. Coifman and Stéphane Lafon. Diffusion maps. Applied and Computational Harmonic
Analysis, 21:5–30, 2006a.
Ronald R. Coifman and Stéphane Lafon. Geometric harmonics: A novel tool for multiscale
out-of-sample extension of empirical functions. Applied and Computational Harmonic
Analysis, 21(1):31–52, July 2006b.
Ronald R. Coifman and Mauro Maggioni. Diffusion wavelets. Applied and Computational
Harmonic Analysis, 21(1):53–94, 2006.
Michaël Defferrard, Xavier Bresson, and Pierre Vandergheynst. Convolutional neural
networks on graphs with fast localized spectral filtering. In Advances in Neural Information
Processing Systems 29, pages 3844–3852, 2016.
Michael Eickenberg, Georgios Exarchakis, Matthew Hirn, and Stéphane Mallat. Solid
harmonic wavelet scattering: Predicting quantum molecular energy from invariant de-
scriptors of 3D electronic densities. In Advances in Neural Information Processing Systems 30
(NIPS 2017), pages 6540–6549, 2017.
Michael Eickenberg, Georgios Exarchakis, Matthew Hirn, Stéphane Mallat, and Louis Thiry.
Solid harmonic wavelet scattering for predictions of molecule properties. Journal of
Chemical Physics, 148:241732, 2018.
Fernando Gama, Alejandro Ribeiro, and Joan Bruna. Diffusion scattering transforms on
graphs. arXiv:1806.08829, 2018.
Feng Gao, Guy Wolf, and Matthew Hirn. Graph classification with geometric scattering.
arXiv:1810.03068, 2018.
Evarist Giné. The addition formula for the eigenfunctions of the Laplacian. Advances in
Mathematics, 18(1):102–107, 1975.
Matthew Hirn, Stéphane Mallat, and Nicolas Poilvert. Wavelet scattering regression of
quantum chemical energies. Multiscale Modeling and Simulation, 15(2):827–863, 2017.
Lars Hörmander. The spectral function of an elliptic operator. Acta Mathematica, 121:193–218,
1968.
Shoshichi Kobayashi and Katsumi Nomizu. Foundations of Differential Geometry, Volume 1.
Number 15 in Interscience Tracts in Pure and Applied Math. John Wiley and Sons Inc.,
New York, 1963.
Ron Levie, Federico Monti, Xavier Bresson, and Michael M. Bronstein. Cayleynets: Graph
convolutional neural networks with complex rational spectral filters. arXiv:1705.07664,
2017.
11

Stéphane Mallat. Recursive interferometric representations. In 18th European Signal Process-
ing Conference (EUSIPCO-2010), Aalborg, Denmark, 2010.
StéphaneMallat. Groupinvariantscattering. CommunicationsonPureandAppliedMathematics,
65(10):1331–1398, October 2012.
Yves Meyer. Wavelets and Operators, volume 1. Cambridge University Press, 1993.
Edouard Oyallon and Stéphane Mallat. Deep roto-translation scattering for object classifica-
tion. In 2015 IEEE Conference on Computer Vision and Pattern Recognition (CVPR), pages
2865–2873, 2015.
Yiqian Shi and Bin Xu. Gradient estimate of an eigenfunction on a compact Riemannian
manifold without boundary. Annals of Global Analysis and Geometry, 38:21–26, 2010.
David I. Shuman, Sunil K. Narang, Pascal Frossard, Antonio Ortega, and Pierre Van-
dergheynst. The emerging field of signal processing on graphs: Extending high-
dimensional data analysis to networks and other irregular domains. IEEE Signal Processing
Magazine, 30(3):83–98, 2013.
Laurent Sifre and Stéphane Mallat. Combined scattering for rotation invariant texture
analysis. In Proceedings of the 20th European Symposium on Artificial Neural Networks
(ESANN 2012), 2012.
LaurentSifreandStéphaneMallat. Rotation, scalinganddeformationinvariantscatteringfor
texture discrimination. In The IEEE Conference on Computer Vision and Pattern Recognition
(CVPR), June 2013.
Laurent Sifre and Stéphane Mallat. Rigid-motion scattering for texture classification.
arXiv:1403.1687, 2014.
Joshua B. Tenenbaum, Vin de Silva, and John C. Langford. A global geometric framework
for nonlinear dimensionality reduction. Science, 290(5500):2319–2323, 2000.
Greg Turk and Marc Levoy. The Stanford bunny, 2005.
Laurens van der Maaten and Geoffrey Hinton. Visualizing high-dimensional data using
t-SNE. Journal of Machine Learning Research, 9:2579–2605, 2008.
Guy Wolf, Stephane Mallat, and Shihab A. Shamma. Audio source separation with time-
frequency velocities. In 2014 IEEE International Workshop on Machine Learning for Signal
Processing (MLSP), Reims, France, 2014.
Guy Wolf, Stephane Mallat, and Shihab A. Shamma. Rigid motion model for audio source
separation. IEEE Transactions on Signal Processing, 64(7):1822–1831, 2015.
Li Yi, Hao Su, Xingwen Guo, and Leonidas Guibas. Syncspeccnn: Synchronized spectral cnn
for 3d shape segmentation. In The Conference on Computer Vision and Pattern Recognition
(CVPR), 2017.
Dongmian Zou and Gilad Lerman. Graph convolutional neural networks via scattering.
arXiv:1804:00099, 2018.
A Proof of Proposition 3.2
We note that
∑
(cid:107)π f(cid:107)2 = |(cid:104)f, ϕ (cid:105)|2 ,
λ 2 k
k:λ =λ
k
12

where π denotes projection onto the eigenspace E . Therefore, applying (6) to (cid:107)T f(cid:107)2 and
λ λ g 2
(cid:107)T f(cid:107)2, we see that
h γ 2
(cid:107)Φ f(cid:107)2 = (cid:107)T f(cid:107)2 + ∑ (cid:107)T f(cid:107)2
2,2 g 2 h γ 2
γ∈Γ
∑ ∑ ∑
= |g(λ )|2|(cid:104)f, ϕ (cid:105)|2 + |h (λ )|2|(cid:104)f, ϕ (cid:105)|2
k k γ k k
k∈N γ∈Γ k∈N
(cid:34) (cid:35)
∑ ∑
= |g(λ )|2 + |h (λ )|2 |(cid:104)f, ϕ (cid:105)|2
k γ k k
k∈N γ∈Γ
(cid:34) (cid:35)
∑ ∑ ∑
= m(λ) |g(λ)|2 + |h (λ)|2 |(cid:104)f, ϕ (cid:105)|2
γ k
λ∈Λ γ∈Γ k:λ =λ
k
(cid:34) (cid:35)
∑ ∑
= m(λ) |g(λ)|2 + |h (λ)|2 (cid:107)π f(cid:107)2 .
γ λ 2
λ∈Λ γ∈Γ
Therefore, the result follows from Parseval’s Identity and the assumption that
A(cid:107)f(cid:107)2 ≤ (cid:107)Φ f(cid:107)2 = (cid:107)T f(cid:107)2 + ∑ (cid:107)T f(cid:107)2 ≤ B(cid:107)f(cid:107)2 .
2 2,2 g 2 h γ 2 2
γ∈Γ
B Proof of Proposition 3.3
We will show that
(cid:34) (cid:35)
m(λ) |g (λ)|2 + ∑ |(cid:101)h (λ)|2 = 1, ∀λ ∈ Λ . (17)
(cid:101)J j
j≤J
The result will then follow from Proposition 3.2.
We recall from (11) that
(cid:104) (cid:105)1
h (λ) = |g (λ)|2 − |g (λ)|2 2 ,
j j−1 j
where g is a low-pass filter assumed by (7) to satisfy
|g(λ)| ≤ g(0) = 1 for all λ ≥ 0 and lim g(λ) = 0.
λ→∞
Therefore, recalling that for any spectral function η, the corresponding normalized spectral
(cid:104) (cid:105)
√η(λ) (cid:12) (cid:12)g(cid:0) 2Jλ(cid:1)(cid:12) (cid:12)2
filter is defined by η˜(λ) = , we see m(λ) |g (λ)|2 + ∑ |(cid:101)h (λ)|2 = +
(cid:101)J j≤J j
m(λ)
(cid:104) (cid:105)
∑ j≤J (cid:12) (cid:12)g(cid:0) 2j−1λ(cid:1) |2 − |g(cid:0) 2jλ(cid:1)(cid:12) (cid:12)2 = lim j→−∞ |g(cid:0) 2jλ(cid:1) |2 = g(0) = 1, ∀λ ∈ Λ .
C Proof of Lemma 4.3
Let K be the kernel of T . Then by the Cauchy-Schwartz inequality and the fact that
η η
(cid:0) (cid:1)
V f(x) = f ζ−1(x) ,
ζ
(cid:12) (cid:12)
(cid:90) (cid:104) (cid:16) (cid:17)(cid:105)
(cid:12) ζ−1(x),y f(y)dV(y)(cid:12)
|T f(x) − V T f(x)| = (cid:12) K (x,y) − K (cid:12)
η ζ η η η
(cid:12) M (cid:12)
(cid:18)(cid:90) (cid:19)1/2
(cid:12) (cid:16) (cid:17)(cid:12)2
≤ (cid:107)f(cid:107) (cid:12) K (x,y) − K ζ−1(x),y (cid:12) dV(y)
2 (cid:12) η η (cid:12)
M
(cid:18)(cid:90) (cid:19)1/2
(cid:12) (cid:16) (cid:17)(cid:12)2
≤ (cid:107)f(cid:107) (cid:107)∇K (cid:107) ∞ (cid:12) r x,ζ−1(x) (cid:12) dV(y)
2 η (cid:12) (cid:12)
M
(cid:113)
≤ (cid:107)f(cid:107) vol(M)(cid:107)∇K (cid:107) ∞(cid:107)ζ(cid:107) ∞.
2 η
13

It follows that
(cid:107)T f − V T f(cid:107) ≤ vol(M)(cid:107)∇K (cid:107) ∞(cid:107)ζ(cid:107) ∞(cid:107)f(cid:107) . (18)
η ζ η 2 η 2
Lemma 5.5 shows
(cid:107)∇K (cid:107) ∞ ≤ C(M) ∑ η(λ )λd/2 ,
η k k
k∈N
and therefore
(cid:32) (cid:33)
(cid:107)T f − V T f(cid:107) ≤ C(M) ∑ η(λ )λd/2 (cid:107)ζ(cid:107) ∞(cid:107)f(cid:107) .
η ζ η 2 k k 2
k∈N
Now suppose that |η(λ)| ≤ C e−tλ for some constant C and t > 0. Theorem 2.4 of Bérard
0 0
et al. [1994] proves that for any x ∈ M, α ≥ 0, and t > 0,
∑ λα e−tλ k|ϕ (x)|2 ≤ C(M)(α + 1)t−(d+2α)/2 .
k k
k≥1
Integrating both sides over M yields:
∑ λα e−tλ k ≤ C(M)(α + 1)t−(d+2α)/2 . (19)
k
k≥1
Using the assumption that that |η(λ)| ≤ C e−tλ, (18), and (19) with α = d/2, gives
0
(cid:32) (cid:33)
(cid:107)Tf − V Tf(cid:107) ≤ C C(M) ∑ λd/2 e−tλ k (cid:107)ζ(cid:107) ∞(cid:107)f(cid:107) ≤ C C(M)t−d(cid:107)ζ(cid:107) ∞(cid:107)f(cid:107) .
ζ 2 0 k 2 0 2
k≥1
D Proof of Theorem 5.1
Let K be the kernel of T . As shown in the proof of Theorem 4.2,
η η
(cid:0) (cid:1)
K ζ˜(x),ζ˜(y) = K (x,y) (20)
η η
for all x and y in M and for all isometries ζ˜ . Therefore, we may apply Lemma 5.3, to see that
(cid:104) (cid:105)
(cid:107)[T ,V ]f(cid:107) ≤ C(M) (cid:107)∇K(cid:107) ∞A (ζ) + (cid:107)K(cid:107) A (ζ) (cid:107)f(cid:107) .
η ζ 2 3 L2(M×M) 2 2
Lemma 5.5 implies that
(cid:107)∇K (cid:107) ∞ ≤ C(M) ∑ η(λ )λd/2 ,
η k k
k∈N
∞
and since {ϕ } forms an orthonormal basis for L2(M), we may verify that
k k=0
(cid:32) (cid:33)1/2
∞
∑
(cid:107)K (cid:107) = |η(λ )|2 .
η L2(M×M) k
k=0
Combining the above results completes the proof.
E Proof of Theorem 5.2
Let K be the kernel of T . For any two pairs of points, (x,y) and (x(cid:48) ,y(cid:48)) such that
η η
r(x,y) = r(x(cid:48) ,y(cid:48)), the definition of two-point homogeneity says that there exists an isom-
˜ (cid:48) (cid:48)
etry ζ mapping x to x and y to y . As shown in the proof of Theorem 3.1, this implies
K (x(cid:48) ,y(cid:48)) = K (x,y). Therefore, K (x,y) is radial and we may write K (x,y) = κ(r(x,y))
η η η η
for some κ ∈ C1.
By definition, any two-point homogeneous manifold is homogeneous, and so applying
Lemma 5.4, we see that
(cid:104) (cid:105)
(cid:107)[T ,V ]f(cid:107) ≤ C(M) (cid:107)∇K (cid:107) ∞A (ζ) + (cid:107)K (cid:107) A (ζ) (cid:107)f(cid:107) .
η ζ 2 η 1 η L2(M×M) 2 2
14

Lemma 5.5 implies that
∑ (d+1)/4
(cid:107)∇K (cid:107) ∞ ≤ C(M) η(λ )λ ,
η k k
k∈N
∞
and since {ϕ } forms an orthonormal basis for L2(M), it can be checked that
k k=0
(cid:32) (cid:33)1/2
∞
∑
(cid:107)K (cid:107) = |η(λ )|2 .
η L2(M×M) k
k=0
The proof follows from combining the above inequalities.
F Proof of Lemma 5.3
We first compute
(cid:12) (cid:12)
(cid:90) (cid:16) (cid:17) (cid:90) (cid:16) (cid:17)
(cid:12) ζ−1(y) ζ−1(x),y f(y)dV(y)(cid:12)
|[T,V ]f(x)| = (cid:12) K(x,y)f dV(y) − K (cid:12)
ζ
(cid:12) M M (cid:12)
(cid:12) (cid:12)
(cid:90) (cid:90) (cid:16) (cid:17)
(cid:12) ζ−1(x),y f(y)dV(y)(cid:12)
= (cid:12) K(x,ζ(y))f(y)|det[Dζ(y)]|dV(y) − K (cid:12)
(cid:12) M M (cid:12)
(cid:12) (cid:12)
(cid:90) (cid:104) (cid:16) (cid:17)(cid:105)
(cid:12) ζ−1(x),y dV(y)(cid:12)
= (cid:12) f(y) K(x,ζ(y))|det[Dζ(y)]| − K (cid:12)
(cid:12) M (cid:12)
(cid:12) (cid:12)
(cid:90)
(cid:12) (cid:12)
≤ (cid:12) f(y)K(x,ζ(y))[|det[Dζ(y)]| − 1] dV(y)(cid:12)
(cid:12) M (cid:12)
(cid:12) (cid:12)
(cid:90) (cid:104) (cid:16) (cid:17)(cid:105)
(cid:12) ζ−1(x),y dV(y)(cid:12)
+ (cid:12) f(y) K(x,ζ(y)) − K (cid:12)
(cid:12) M (cid:12)
(cid:12) (cid:12)
(cid:90)
(cid:12) (cid:12)
≤ (cid:107)|det[Dζ(y)]| − 1(cid:107) ∞ (cid:12) f(y)K(x,ζ(y))dV(y)(cid:12)
(cid:12) M (cid:12)
(cid:12) (cid:12)
(cid:90) (cid:104) (cid:105)
(cid:12) K(ζ−1(x),y) dV(y)(cid:12)
+ (cid:12) f(y) K(x,ζ(y)) − (cid:12).
(cid:12) M (cid:12)
Therefore, by the Cauchy-Schwartz inequality,
(cid:34) (cid:18)(cid:90) (cid:90) (cid:19)1
2
(cid:107)[T,V ]f(cid:107) ≤ (cid:107)f(cid:107) (cid:107)|det[Dζ(y)]| − 1(cid:107) |K(x,ζ(y))|2 dV(y)dV(x)
∞
ζ 2 2
M M
(cid:18)(cid:90) (cid:90) (cid:12) (cid:16) (cid:17)(cid:12)2 (cid:19)1 2(cid:35)
+ (cid:12) K(x,ζ(y)) − K ζ−1(x),y (cid:12) dV(y)dV(x) .
(cid:12) (cid:12)
M M
We may bound the first integral by observing
(cid:90) (cid:90) (cid:90) (cid:90)
|K(x,ζ(y))|2 dV(y)dV(x) ≤ (cid:107)det[Dζ−1(y)](cid:107)2 |K(x,y)|2 dV(y)dV(x).
∞
M M M M
To bound the second integral, let ζ = ζ ◦ ζ be a factorization of ζ into an isometry ζ and a
1 2 1
diffeomorphism ζ such that (cid:107)ζ (cid:107) ∞ ≤ 2A (ζ). Then
2 2 3
(cid:90) (cid:90) (cid:12) (cid:16) (cid:17)(cid:12)2
(cid:12) K(x,ζ(y)) − K ζ−1(x),y (cid:12) dV(y)dV(x)
(cid:12) (cid:12)
M M
(cid:90) (cid:90) (cid:12) (cid:16) (cid:16) (cid:17) (cid:17)(cid:12)2
= (cid:12) K(x,ζ (ζ (y))) − K ζ−1 ζ−1(x) ,y (cid:12) dV(y)dV(x)
(cid:12) 1 2 2 1 (cid:12)
M M
(cid:90) (cid:90) (cid:12) (cid:16) (cid:16) (cid:17) (cid:17)(cid:12)2
= (cid:12) K(ζ−1(x),ζ (y)) − K ζ−1 ζ−1(x) ,y (cid:12) dV(y)dV(x)
(cid:12) 1 2 2 1 (cid:12)
M M
15

where the last equality uses the assumption (16). Now,
(cid:90) (cid:90) (cid:12) (cid:16) (cid:17) (cid:16) (cid:17)(cid:12)2
(cid:12) K ζ−1(x),ζ (y) − K ζ−1(ζ−1(x)),y (cid:12) dV(y)dV(x)
(cid:12) 1 2 2 1 (cid:12)
M M
(cid:90) (cid:90) (cid:12) (cid:16) (cid:17) (cid:16) (cid:17)(cid:12)2
≤ 2 (cid:12) K ζ−1(x),ζ (y) − K ζ−1(x),y (cid:12) dV(y)dV(x)
(cid:12) 1 2 1 (cid:12)
M M
(cid:90) (cid:90)
|K(ζ−1(x),y) K(ζ−1(ζ−1(x)),y)|2
+ 2 − dV(y)dV(x)
1 2 1
M M
≤ 4(cid:107)ζ (cid:107)2 (cid:107)∇K(cid:107)2 vol(M)2 .
2 ∞ ∞
Combining the above inequalities completes the proof.
G Proof of Lemma 5.4
We repeat the proof of Lemma 5.3, to see that it suffices to show
(cid:90) (cid:90) (cid:12) (cid:16) (cid:17)(cid:12)2
(cid:12) K(x,ζ(y)) − K ζ−1(x),y (cid:12) dV(y)dV(x) ≤ [(cid:107)∇K(cid:107) ∞A (ζ)diam(M)vol(M)]2 .
(cid:12) (cid:12) 1
M M
By the assumption that K(x,y) = κ(r(x,y)) is radial, we see
(cid:90) (cid:90) (cid:16) (cid:17)(cid:12)2
|K(x,ζ(y)) K ζ−1(x),y (cid:12) dV(y)dV(x)
(cid:12)
M M
(cid:90) (cid:90) (cid:12) (cid:16) (cid:16) (cid:17)(cid:17)(cid:12)2
= (cid:12) κ(r(x,ζ(y))) − κ r ζ−1(x),y (cid:12) dV(y)dV(x)
(cid:12) (cid:12)
M M
(cid:90) (cid:90) (cid:12) (cid:16) (cid:17)(cid:12)2
≤ (cid:107)κ(cid:48) (cid:107)2 (cid:12) r(x,ζ(y)) − r ζ−1(x),y (cid:12) dV(y)dV(x)
∞ (cid:12) (cid:12)
M M
(cid:90) (cid:90)
≤ (cid:2) (cid:107)κ(cid:48) (cid:107) ∞A (ζ)(cid:3)2 |r(x,ζ(y))|2 dV(y)dV(x)
1
M M
(cid:2) (cid:48) (cid:3)2
≤ (cid:107)κ (cid:107) ∞A (ζ)diam(M)vol(M) .
1
Since K(x,y) = κ(r(x,y)), we see that (cid:107)∇K(cid:107) ∞ = (cid:107)κ(cid:48)(cid:107) ∞, which completes the proof.
H Proof of Lemma 5.5
For any λ = λ, it is a consequence of Hörmander’s local Weyl law (Hörmander, 1968; see
k
also Shi and Xu, 2010) that
C(M)λ(d−1)/4
(cid:107)ϕ (cid:107) ∞ ≤ . (21)
k
Theorem 1 of Shi and Xu [2010] shows that
√
(cid:107)∇ϕ (cid:107) ∞ ≤ C(M) λ(cid:107)ϕ (cid:107) ∞. (22)
k k
Therefore,
(cid:12) (cid:12)2 (cid:32) (cid:33)(cid:32) (cid:33)
(cid:12) (cid:12)2 (cid:12) (cid:12)
(cid:12)∇K(λ) (x,y)(cid:12) = (cid:12) ∑ ∇ϕ (x)ϕ (y)(cid:12) ≤ ∑ |∇ϕ (x)|2 ∑ |ϕ (y)|2
(cid:12) (cid:12) (cid:12) k k (cid:12) k k
(cid:12) (cid:12)
k:λ =λ k:λ =λ k:λ =λ
k k k
≤ C(M)m(λ)λ(d−1)/2 ∑ |∇ϕ (x)|2 ≤ C(M)m(λ)λ(d+1)/2 ∑ (cid:107)ϕ (cid:107)2
k k ∞
k:λ =λ k:λ =λ
k k
≤ C(M)m(λ)2 λd .
Furthermore, if we assume that M is homogeneous, then Theorem 3.2 of Giné [1975] shows
that ∑ |ϕ (y)|2 = C(M)m(λ). Substituting this into the above string of inequalities
k:λ =λ k
k
yields
(cid:12) (cid:12)2
(cid:12)∇K(λ) (x,y)(cid:12) ≤ C(M)m(λ)2 λ(d+1)/2 .
(cid:12) (cid:12)
The bounds on (cid:107)K η(cid:107) ∞ follow from recalling that K η(x,y) = ∑ λ∈Λ η(λ)K(λ)(x,y) and ap-
plying the triangle inequality.
16