Decoding the Encoding of Functional Brain Networks: an fMRI
Classification Comparison of Non-negative Matrix Factorization
(NMF), Independent Component Analysis (ICA), and Sparse
Coding Algorithms
6102 luJ 1  ]CN.oib-q[  1v53400.7061:viXra Jianwen Xie1, Pamela K. Douglas2, Ying Nian Wu1, Arthur L. Brody2 and Ariana E. Anderson ∗ 2
1Department of Statistics, University of California, Los Angeles
2Department of Psychiatry and Biobehavioral Sciences, University of California, Los Angeles
∗DepartmentofPsychiatryandBiobehavioralSciences,UniversityofCalifornia,LosAngeles,760WestwoodPlaza,LosAngeles,CA90095
arianaanderson@mednet.ucla.edu
1

2 Xie et al.
Abstract
Brain networks in fMRI are typically identified using spatial independent component analysis (ICA), yet math-
ematical constraints such as sparse coding and positivity both provide alternate biologically-plausible frameworks
for generating brain networks. Non-negative Matrix Factorization (NMF) would suppress negative BOLD signal by
enforcingpositivity. Spatial sparsecodingalgorithms (L1Regularized LearningandK-SVD) wouldimposelocal spe-
cialization and a discouragement of multitasking, where the total observed activity in a single voxel originates from a
restricted number of possible brain networks.
The assumptions of independence, positivity, and sparsity to encode task-related brain networks are compared; the
resulting brain networks for different constraints are used as basis functions to encode the observed functional activity
at a given time point. These encodings are decoded using machine learning to compare both the algorithms and their
assumptions, using the time series weights to predict whether a subject is viewing a video, listening to an audio cue,
or at rest, in 304 fMRI scans from 51 subjects.
For classifying cognitive activity, the sparse coding algorithm of L1 Regularized Learning consistently outper-
formed 4 variations of ICA across different numbers of networks and noise levels (p<0.001). The NMF algorithms,
which suppressed negative BOLD signal, had the poorest accuracy. Within each algorithm, encodings using sparser
spatial networks (containing more zero-valued voxels) had higher classification accuracy (p<0.001). The success
of sparse coding algorithms may suggest that algorithms which enforce sparse coding, discourage multitasking, and
promote local specialization may capture better the underlying source processes than those which allow inexhaustible
local processes such as ICA.

3 Xie et al.
1 Introduction
Although functional MRI (fMRI) data contain numerous spatio-temporal observations, these data putatively reflect
changes in a relatively small number of functional networks in the brain. These underlying processes can be modeled
using any number of blind source separation (BSS) algorithms, with Independent Component Analysis (ICA) being the
most commonly used. Other mathematical constraints, such as positivity or sparsity, provide alternative interpretations
for how the brain generates and encodes functional brain networks. Comparing how BSS algorithms capture task-
related activations will simultaneously compare these interpretations of functional encoding.
The observed fMRI volume at a given time instance can be modeled as a linear combination of weighted spatial
networks X according to y = dX. This linear model encodes an fMRI scan, where the spatial maps correspond to a
brain network, and the time series weights describe the contribution of that spatial map to the total functional activity
observed at a given time. This linear model can be computed using a variety of BSS methods including: ICA, K-Means
Singular Value Decomposition (K-SVD), L1 Regularized Learning, and Non-negative Matrix Factorization (NMF).
Each of these methods applies different constraints to recover and numerically unmix sources of activity, leading to
different representations of functional brain networks (spatial maps) and time series weights.
ICA finds components that are maximally statistically independent in the spatial or temporal domain. Since the
number of time points is typically less than the number of voxels, spatial ICA in particular has become the most
studied approach for extracting and summarizing brain activity networks in fMRI (McKeown et al. (1997)), where
many of the networks computed by ICA correspond to previously identified large scale brain networks (Smith et al.
(2009)). In spatial ICA, maximizing spatial independence suggests that the ability of a voxel to contribute to a given
brain network is not contingent on how it contributes to any other brain network, or to how many other brain networks
it contributes; there is no bound to how strongly a voxel can contribute to a network since arbitrarily large positive
and negative “activations” are permitted across networks (Calhoun et al. (2004)). This permits local activations to be
inexhaustible; no region is disqualified from participating in any brain network simply because it already participates
strongly in another network. The validity of the spatial and temporal independence assumptions in fMRI have been
the subject of lively debate for some time (Friston (1998);McKeown et al. (2003);Daubechies et al. (2009);Calhoun
et al. (2013)). The most frequently-used ICA algorithms maximize independence by maximizing the non-Gaussianity
(Fast ICA) (Hyva¨rinen and Oja (1997)) or minimizing the mutual information (InfoMax) (Bell and Sejnowski (1995)).
Recently ProDenICA has been shown to perform better on resting-state fMRI data (Risk et al. (2013)).
K-SVD (sparse dictionary learning) has been used to nominate networks both on the voxel (Lee and Ye (2010);Lee
et al. (2011);Abolghasemi et al. (2013)) and region of interest (ROI) scale (Eavani et al. (2012)), and restricts many
of the voxels in a network to have null (zero) values by limiting component membership of each voxel. This biologi-

4 Xie et al.
cally plausible constraint prohibits multitasking of a voxel, as no voxel can contribute to all processes simultaneously
(Spratling (2014)). More recently it was applied in simulated functional connectivity (FC) analyses to recover true,
underlying FC patterns (Leonardi et al. (2014)), where dynamic FC was found to be better described during periods
of task by alternating sparser FC states. Similarly, L1 Regularized Learning (LASSO) was applied in Parkinson’s
Disease to analyze fMRI functional connectivity during resting state (Liu et al. (2015)). Non-negative matrix factor-
ization has been applied to fMRI data (Wang et al. (2004);Potluru and Calhoun (2008);Ferdowsi et al. (2010);Ferdowsi
et al. (2011)), where the alternating least squares NMF algorithm has been found superior to detect task-related ac-
tivation compared to three other NMF algorithms (Ding et al. (2012)). Imposing non-negativity in NMF suppresses
all negative BOLD signal, while the parts-based representation which results from this non-negativity suggests that a
subset of local-circuits may be a better representation of functional activity than geographically-distributed networks.
Previously, we used NMF to identify multimodal MRI, fMRI, and phenotypic profiles of Attention Deficit Hyperac-
tivity Disorder (ADHD) (Anderson et al. (2013)). Although the biological interpretations of these algorithms are not
mutually exclusive to ICA, the success of a specific dictionary learning method may prioritize theories of encoding.
In this paper, we evaluate which of the individual subject representations computed by ICA, K-SVD, NMF, and
L1 Regularized Learning best encode task-related activations that are pertinent for classification, by embedding these
components as features within a decoding framework. These representations can be compared by using the time
series weights of the spatial maps for task classification, where each time point in an fMRI scan is encoded using the
functional brain networks proposed by each algorithm. Using the time series weights for the encodings, we predict
which task a subject was performing during a scan by employing support vector machines (SVM) (Burges (1998))
and random forests (Breiman (2001)). We have recently leveraged component feature weights for classification of
fMRI data in a number of studies (Douglas et al. (2009);Anderson et al. (2010);Douglas et al. (2011);Anderson et al.
(2012);Douglas et al. (2013)). We compare the predictive accuracies of the algorithms while varying the number of
components and the presence of artifactual components (effects of motion, non-neuronal physiology, scanner artifacts
and other noisy sources). Finally, we evaluate how physiological profiles of the proposed brain networks (tissue
activation densities and sparsity) are associated with the classification accuracy, to compare whether the algorithms are
substantially different after accounting for the physiological profiles of the spatial networks they extract. Collectively,
this paper evaluates the performance of different algorithms in encoding functional brain networks, possible correlates
for explaining their performance, and the assumptions they support.

5 Xie et al.
2 Materials and Methods
2.1 Overview
We will compare the representations of each algorithm by using the time series weights to predict, within a single scan,
which activity a subject was doing. We evaluate not only the general algorithms, but also their varied implementations,
including four variations of ICA (Entropy Bound Minimization [EBM ICA], Fast ICA, InfoMax ICA, Joint Approxi-
mate Diagonalization of Eigen-matrices [JADE ICA]), two variations of NMF (Alternating Least Squares [NMF-ALS],
Projected Gradient [NMF-PG]), and two sparse coding algorithms (L1 Regularized Learning, K-SVD). Finally, we as-
sess how the physiological profiles of the spatial maps may correlate with the ability to encode an fMRI scan, holding
constant the effect of the algorithm.
2.2 Data: Design, Experiment, Preprocessing and Cleaning
We describe briefly the experimental design and experiment here; it is discussed in detail in (Culbertson et al. (2011)).
A total of 51 subjects were scanned in a study on craving and addiction. The subjects were divided into three groups,
and scanned up to 3 times before and after treatment (with bupropion, placebo, or counseling) while watching a video
and receiving audio cues meant to induce nicotine cravings, in a blocked design task. This led to a total of 304 usable
scans, after removing 2 scans for which scan-time was abbreviated. There were a total of 18 nicotine related video
cues, and 9 neutral video cues. The audio cues were reportedly difficult to hear at times due to scanner noise. These
volunteers were scanned using a gradient-echo, echo planar imaging sequence with a TR of 2.5 algorithms, echo time,
45 milliseconds; flip angle, 80; image matrix, 128 64; field of view, 40 20 cm; and in-plane resolution, 3.125 mm.
The fMRI data processing was carried out using FEAT (FMRI Expert Analysis Tool) version 6.00, part of FSL
(FMRIB’s Software Library, www.fmrib.ox.ac.uk/fsl). The following preprocessing was applied; motion
correction using MCFLIRT (Jenkinson et al. (2002)); non-brain removal using BET (Smith (2002)); spatial smoothing
using a Gaussian kernel of FWHM 5mm; grand-mean intensity normalisation of the entire 4D dataset by a single mul-
tiplicative factor; highpass temporal filtering (Gaussian-weighted least-squares straight line fitting, with sigma=50.0s).
We evaluated the classification accuracy of these algorithms on scans containing two levels of noise: the first dataset
was traditionally-preprocessed using only the steps listed above, while the second dataset consisted of the same set of
scans which had been additionally cleaned using the FIX artifact removal tool (Griffanti et al. (2014);Salimi-Khorshidi
et al. (2014)), where approximately 50% of networks (defined by ICA) were flagged as possible noise (residual effects
of motion, non-neuronal physiology, scanner artifacts and other noisy sources) and removed. Following the removal

6 Xie et al.
of the possible artifacts, each scan was reconstructed, and the dictionary learning algorithms were rerun within each
“cleaned” scan.
2.3 BSS Algorithms
K-SVD, NMF, ICA, and L1 Regularized Learning all perform a matrix factorization into spatial maps (networks)
and time series weights. They differ primarily however in what constraints they impose when learning, and whether
the primary emphasis is on learning the spatial or temporal features. For example, NMF places equal emphasis on
learning the time series weights and the networks, while spatial ICA imposes statistical independence over space (but
no constraints over time). In addition, the sparse coding algorithms considered here emphasize learning the time series
weights instead of the spatial maps, and imposes spatial sparsity within voxel across networks by restricting the total
contribution of a given voxel over all networks. Because all the algorithms assessed here produce both spatial maps
and time courses, this distinction is not restrictive in comparing the ability of spatial maps to summarize functional
activation patterns at a given time point. We uniformly describe the algorithms in the context of Y = DX, where Y
is the original data matrix (a single fMRI scan) of size n×m containing m voxels and n time points, D is the mixing
matrix containing the time series weights for k components of dimension n×k where k ≤ n, and X is the matrix of
spatial maps (networks) of dimension k×m. We extract both k ∈ 20,50 networks within each scan for ICA, NMF,
K-SVD and L1 Regularized Learning.
2.3.1 Spatial Statistical Independence: Independent Component Analysis
Statistical independence is an important concept that constitutes the foundation of ICA, which is one of the most
widely used blind source separation techniques for exposing hidden factors underlying sets of signals (Aapo Hyva¨rinen
(2000);Aapo Hyva¨rinen (2001)). ICA can be written as a decomposition of a data matrix Y into a product of
n×m
(maximally) statistically independent spatial maps (networks) X with a mixing matrix (time series weights) D ,
k×m n×k
given by Y = D X . Formally, spatial independence implies that for a given voxel m, p(x ,x ,...,x ) =
n×m n×k k×m 1m 2m km
∏k p(x )p(x )...p(x ) Here, we examine ICA with a constraint of (maximal) spatial independence, using the
i=1 1m 2m km
Fast ICA, InfoMax ICA, EBM ICA, and JADE ICA algorithms.
Different measurements of independence govern different forms of the ICA algorithms, resulting in slightly differ-
ent unmixing matrices. Minimization of mutual information and maximization of non-Gaussianity are two broadest
measurements of statistical independence for ICA. Fast ICA (Hyva¨rinen (1999)) is a fixed point ICA algorithm that

7 Xie et al.
maximizes non-Gaussianity as a measure of statistical independence, motivated by the central limit theorem. Fast ICA
measures non-Gaussianity by negentropy, which itself is the difference in entropy between a given distribution and
the Gaussian distribution with the same mean and variance. InfoMax ICA (Bell and Sejnowski (1995)) belongs to the
minimization of mutual information family of ICA algorithms; these find independent signals by maximizing entropy.
Instead of directly estimating the entropy, the EBM ICA algorithm (Li and Adali (2010)) approximates the entropy by
bounding the entropy of estimates using numerical computation. Due to the flexibility of the entropy bound estimator,
EBM ICA can be applied to data that come from different types of distributions, e.g., sub- or super-Gaussian, unimodal
or multimodal, symmetric or skewed probability density functions, placing an even stronger emphasis on indepen-
dence. JADE (Cardoso (1999);Cardoso and Souloumiac (1993)) is an ICA algorithm exploiting the Jacobi technique
to perform joint approximate diagonalization on fourth-order cumulant matrices to separate the source signals from
mixed signals. Typical ICA algorithms use centering, whitening, and dimensionality reduction as preprocessing steps.
Whitening and dimension reduction can be achieved with Principal Component Analysis (PCA) or Singular Value De-
composition (SVD). They are simple and efficient operations that significantly reduce the computational complexity of
ICA, so are applied in the implementations of ICA here.
2.3.2 Positivity: Non-negative Matrix Factorization
Psychological and physiological evidence show that component parts play an important role in neural encoding of the
visual appearance of an object in the brain (Palmer (1977);Logothetis and Sheinberg (1996);Wachsmuth et al. (1994)).
When applied to fMRI data, this parts-based representation is conceptually similar to encouraging neighboring voxels
to co-activate, which would encourage spatial smoothness in the resulting component maps. The non-negativity in
NMF constraints would eliminate negative BOLD signal changes which have been controversially associated with
sources such as cerebral blood volume changes and inhibition (Bianciardi et al. (2011);Harel et al. (2002);Moraschi
et al. (2012);Smith et al. (2004)).
Non-negativity is a useful constraint for matrix factorization which leads to parts-based representation, because it
allows only additive (positive) combinations of the learned bases (Lee and Seung (1999)). Given a n×m non-negative
data matrix Y and a pre-specified k < min(n,m), NMF finds two non-negative matrices D and X such that
n×k k×m
Y ≈ DX. The conventional approach to find D and X is by minimizing the squared error betweenY and DX:
2
min{(cid:107)Y −DX(cid:107) }subjecttoD ≥ 0,X ≥ 0,∀i,a,b, j (1)
2 ia bj
D,X

8 Xie et al.
which is a standard bound-constrained optimization problem. There are several algorithms in which the D and X
may be found. The most commonly known approach is the multiplicative update method (Lee and Seung (2001)).
NMF-ALS has previously shown stronger performance than multiplicative update-NMF in fMRI (Ding et al. (2012)).
NMF-ALS
A more flexible and general framework for obtaining NMF is to use alternating least squares (ALS), which was
first introduced by Paatero and Tapper (P. Paatero (1994)) in the middle of the 1990s under the name positive matrix
factorization (Anttila et al. (1995);P. Paatero (1994)). The ALS algorithm does not have the restriction of locking 0
elements in matrices D and X. The framework of ALS is summarized as follows:
(1) Initialize D0 > 0,X0 > 0,∀i,a,b, j.
ia bj
(2) For J = 0,1,2,···
D(J+1) argmin(cid:13) −DX(J)(cid:13) (cid:13)2
= (cid:13)Y (2)
2
D≥0
X(J+1) argmin(cid:13) −D(J+1) X(cid:13) (cid:13)2
= (cid:13)Y (3)
2
X≥0
The iterations can be performed with an initialization of D and X, and then alternating between solving (2) and (3)
until a stopping criterion is satisfied. ALS is also known as ”block coordinate descent” approach in bound-constrained
optimization (Bertsekas (1999)). We refer to (2) or (3) as a sub-problem in this. At each step of iterations, finding
an optimal solution of the nonnegative least squares sub-problem is important because otherwise, the convergence of
overall algorithm may not be guaranteed (Kim and Park (2007)).
Some successful NMF algorithms are based on ALS; their differences arise from using different ways to solve the
ALS sub-problems. As an elementary strategy, the alternating least squares algorithm (P. Paatero (1994);M.W. Berry
and Plemmons (2007)) solves the sub-problems by an unconstrained least squares solution (without the nonnegativity
constraint), i.e., D←((XXT)−1XYT)T andX ←(DTD)−1DTY, andeverynegativeelementresultingfromleastsquares
computation is set to zero to ensure nonnegativity after each update step. The implementation for ALS described above
is very fast, and requires less work than other NMF algorithms; however, setting negative elements to 0 in order to
enforce nonnegativity is quite ad hoc.
NMF-PG
Alternating nonnegative least squares using projected gradients (NMF-PG) has been used for NMF (Lin (2007)).
The sub-problems in ALS above are solved here using projected gradient methods. To calculate X, the algorithm
updates it by the rule X ← P[X −α∇f(X)], where P[·] is a bounding function or projection operator that maps a point
back to the bounded feasible region, ∇f(X) is the gradient function computed as DT(DX −Y), and α is the step size.

9 Xie et al.
Selecting the step size α for each sub-iteration in NMF-PG is a main computational task. The same approach is utilized
to calculate D.
2.3.3 Sparse coding: K-SVD and L1 Regularized Learning
All dimension reduction methods necessarily provide compression, and some variations of independence also encour-
age sparsity (e.g. the InfoMax variant of ICA). Similarly, the non-negativity constraint in NMF shrinks the intensity of
many spatial maps’ voxels to zero which also encourages sparsity. However, the sparsity obtained in these methods is
a secondary benefit to the primary intention (independence and non-negativity), and not the primary objective of the
algorithms. We thus describe the “sparse coding” algorithms not on whether they may encourage sparsity, but rather
on whether they enforce it. Sparse coding in fMRI restricts a single voxel to have a limited number of (approximately)
non-null values across networks. This sparsity on the voxel scale across spatial maps necessarily provides sparsity
within each spatial map as well.
K-SVD
K-SVD is a generalization of the k-means algorithm; in the k-means algorithm, an observation can be represented
by its centroid (the central point of the cluster to which that element belongs). In K-SVD, an observation is instead
modeled as a weighted combination of multiple (but not all) dictionary elements- effectively imposing the L0-norm on
how many networks a specific voxel can participate in. K-SVD is a sparse data-representation algorithm to learn an
over-complete dictionary, such that any single observation is constructed from a subset of the total number of dictionary
elements.
Sparsity is enforced over space by limiting the number of elements which can be used to construct that observation,
and the dictionary elements D learned are the corresponding time series weights; when applied to fMRI, this constraint
more generally suggests a local specialization; a single voxel can only contribute to a subset of all ongoing processes.
The weights of the dictionary (time series weights) are the spatial maps themselves. This bypasses the need for the PCA
which typically precedes ICA. The sparse coding constraint over space suggests that the networks are best represented
by a subset of all voxels; this is in direct contrast to algorithms such as ICA, where every voxel is allowed to contribute,
in varying degrees, to the representative time series weights.
K-SVD operates by iteratively alternating between (1) sparse coding of the data based on the current dictionary
(estimating the spatial maps, when applied to fMRI), and (2) dictionary updating (revising the time series weights)
to better fit the observed data (M. Aharon and Bruckstein (2006);Rubinstein et al. (2010)). A full description of the
K-SVD algorithm is given as follows:

10 Xie et al.
Task: Find the best dictionary to represent the data samples {y } as sparse compositions, by solving
i
2
min{(cid:107)Y −DX(cid:107) }subjectto∀i,(cid:107)x (cid:107) ≤ T (4)
2 i 0 o
D,X
Initialization: Set the dictionary matrix D(0) ∈Rn×K with l2 normalized columns. Set J =0, the counting index. Let
n = the number time points, m= the number of voxels, and let K = the number of dictionary elements being estimated.
Main Iteration: Increment J by 1, and apply:
Sparse Coding Stage: Use any pursuit algorithm to compute the representation vectors x for each example y , by
i i
approximating the solution of
i = 1,2,...,m,min{(cid:13) (cid:13)y −D(J−1) x (cid:13) (cid:13)2 }subjectto(cid:107)x (cid:107) ≤ T (5)
x i i 2 i 0 0
i
Dictionary Update Stage: for each column k = 1,2,··· ,K in D(J−1), update it as follows:
(1) Define the group of observations that use this atom, ω = {i | 1 ≤ i ≤ m,xk (i) (cid:54)= 0}.
k T
j
(2) Compute the overall representation error matrix, E , by E =Y −∑ d x .
k k j(cid:54)=k j T
(3) Restrict E by choosing only the columns corresponding to ω , and obtain ER.
k k k
(4) Apply SVD decomposition ER =U∆VT. Choose the updated dictionary column d to be the first column ofU.
k k
Update the coefficient vector xk to be the first column ofV multiplied by ∆(1,1).
R
(cid:13) −D(J)X(J)(cid:13) (cid:13)2
Stopping rule: If the change in (cid:13)Y is small enough, stop. Otherwise, iterate further.
2
Output: The desired results are dictionary DJ and encoding XJ.
Due to the L0-norm constraint, seeking an appropriate dictionary for the data is a non-convex problem, so K-SVD
does not guarantee to find the global optimum( Rubinstein et al. (2010)).
L1 Regularized Learning
We can relax the L0-norm constraint over the coefficients x by instead using a L1-norm regularization (Olshausen et al.
i
(1996)), which enforce x (i = 1,...m) to have a small number of nonzero elements. Then, the optimization problem
i
can be written as:
(cid:13) (cid:13)
min{(cid:107)Y −DX(cid:107)2 }+β ∑(cid:107)x (cid:107) subjectto(cid:13)d (cid:13) ≤ 1,∀j = 1,2,··· ,k (6)
2 i 1 j 2
D,X
i
where a unit L2-norm constraint on d typically is applied to avoid trivial solutions.
j
Due to the use of L1 penalty as the sparsity function, the optimization problem is convex in D (while fixing X) and
convex in X (while fixing D), but not convex in both simultaneously. Lee et al. (2007) optimizes the above objective

11 Xie et al.
iteratively by alternatingly optimizing with respect to D (dictionary) and X (coefficients) while fixing the other. For
learning the coefficients X, the optimization problem can be solved by fixing D and optimizing over each coefficient x
i
individually:
2
min{(cid:107)y −Dx (cid:107) }+β (cid:107)x (cid:107) (7)
i i 2 i 1
x
i
which is equivalent to L1-regularized least squares problem, also known as the Lasso in statistical literature. For
learning the dictionary D, the problem reduces to a least square problem with quadratic constraints:
(cid:13) (cid:13)
2
min(cid:107)Y −DX(cid:107) subjectto(cid:13)d (cid:13) ≤ 1,∀j = 1,2,··· ,k (8)
2 j 2
D
2.4 Implementation Details: BSS Algorithms
Here, we have tried to explore common variations for each learning algorithm as thoroughly as is computationally
feasible. Full implementation code is provided in the appendix, with a summary of implementation provided here.
This section describes the implementation and the crucial parameters used in each learning algorithm. Given an input
matrix Y, all the algorithms were initialized by randomly generating matrix D and X, and run a sufficiently large
number of iterations to obtain the converged results. For most of the algorithms, the number of iterations we used is
400, upon which we verified convergence using appropriate fit indices.
NMF: We used Matlab’s embedded function nnmf for NMF-ALS and (Lin (2007)) for NMF-PG in our experiment.
Maximum number of 400 iterations is allowed.
InfoMax ICA: We used the EEGLAB toolbox (Delorme and Makeig (2004)) for InfoMax ICA, which implements
logistic InfoMax ICA algorithm of Bell and Sejnowski (Bell and Sejnowski (1995)) with the natural gradient feature
(Amari et al. (1996)), and with PCA dimension reduction. Annealing based on weight changes is used to automate the
separation process. The algorithm stops training if weights change below 10−6 or after 500 iterations.
Fast ICA: We used the Fast ICA package (the ICA and BSS group (2014)), which implements the fast fixed-point
algorithm for ICA and projection pursuit. PCA dimension reduction and hyperbolic tangent for nonlinearity are used.
JADE ICA: We used the Matlab implementation of JADE (Cardoso and Souloumiac (1993)) for the ICA of real-
valued data. PCA is used for dimension reduction before the JADE algorithm is performed.
EBM ICA: We used the Matlab implementation of EBM ICA (Li and Adali (2010)) for real-valued data. Four
nonlinearities (measuring functions) x4, |x|/(1+|x|), x|x|/(10+|x|), and x/(1+x2) are used for entropy bound calcu-
lation. This implementation adopts a two-stage procedure, where the orthogonal version of EBM ICA, with measuring
function x4 and maximum number of iterations of 100, is firstly used to provide an initial guess, and then the general

12 Xie et al.
nonorthogonal EBM ICA with all measuring functions uses the linear search algorithm to estimate the demixing ma-
trix. The technique for detection and removal of saddle convergence proposed in (Koldovsky et al. (2006)) is used in
orthogonal EBM ICA if the algorithm converges to a saddle point. Similar to other ICA methods, PCA for dimension
reduction was used before the algorithm is performed.
K-SVD: While the total number of components was allowed to vary (either 20 or 50), each voxel was allowed
to participate in only K-8 networks. This corresponds to 40% of all components for the 20-network extractions, and
16% of components for the 50-network extraction. The K-SVD-Box package (Rubinstein and Elad (2008)) was used
to perform K-SVD, which reduces both the computing complexity and the memory requirements by using a modified
dictionary update step that replaces the explicit SVD computation with a much quicker approximation. It employs the
Batch-OMP (orthogonal matching pursuit) to accelerate the sparse-coding step. Implementation details can be found
in (Rubinstein and Elad (2008)).
L1 Regularized Learning: We used the implementation of efficient sparse coding proposed by Lee et al. (2007).
It solves the L1-regularized least squares problem iteratively by using the feature-sign search algorithm and L2-
constrained least squares problem by its Lagrange dual. The parameter for sparsity regularization is 0.15 and for
smoothing regularization is 10−5.
2.5 Implementation Details: Machine Learning Algorithms and Parameters
Using the time series weights for each algorithm extracted within each scan, we predicted whether a subject was
viewing a video, resting, or listening to an audio stimulus at each time point. This was done separately for both
20 and 50 network extractions, and for both the traditionally-preprocessed and artifact-suppressed data, to assess the
impact of both network number and the effect of residual noise. The most stringent data cleaning involved cleaning
the scans twice, using traditional pre-processing and FIX where artifactual components were identified and discarded
from the scan (residual effects of motion, non-neuronal physiology, scanner artifacts and other noisy sources). We
predicted which activity a subject was performing using both an SVM classifier (using a 10-fold cross-validation)
as well as a random forests classifier (which provides the out-of-bag testing error). Using the time series weights for
prediction is similar to projecting the entire fMRI scan onto the spatial networks defined by the algorithms. The average
classification accuracy over 304 scans measures the predictive performance of each algorithm, for the specified number
of components and artifact suppression level.
SVM with a radial basis kernel was implemented within R (Meyer et al. (2012)), using default parameter settings
(cost parameter: 1, gamma: 0.05). For multiclass-classification with 3 levels as was implemented here (video, audio,

13 Xie et al.
rest), libsvm (called from R) uses the “one-against-one” approach, in which 3 binary classifiers are trained; the ap-
propriate class is found by a voting scheme. Random Forests was implemented within R with 500 trees using default
parameter settings (Liaw and Wiener (2002)). For the 20 networks, 4 variables were tried at each split. For the 50
networks, 7 variables were tried.
2.6 Measuring Noise and Measuring Sparsity within Extracted Networks
After performing two iterations of data cleaning (traditional preprocessing and FIX artifact removal), we subsequently
measured whether residual noise or sparsity may impact the classification accuracy. We hypothesized that “activation”,
or high-intensity voxel values, within CSF regions may be an indicator of the overall level of noise within a spatial map.
For the spatial maps created by running each BSS algorithm on the artifact-cleaned scans, we measured the average
intensity of voxels within CSF, grey, and white matter regions. The T1 MNI tissue partial volume effect (PVEs)
were aligned into the subject’s functional space via the subject’s T2 structural scan in a two-step process. First, the
segmented MNI images were aligned into the subject’s structural space using the whole-brain MNI-152 to the subject’s
T2 mapping learned using FLIRT. Then, we registered these PVE images into the subject’s functional MRI space using
the subject’s T2 to fMRI mapping.
Using these tissue masks we computed the average intensity of the extracted spatial maps within regions prob-
abilistically defined as grey matter, white matter, and CSF. This was computed using the cross-correlation of each
tissue-type partial volume effect (PVE) with each functional map; for a given algorithm, the 20 networks extracted for
a scan would yield 60 correlation measures with the grey, white, and CSF maps. The average and the variation of the
tissue types in the 20 networks were used to summarize the overall distribution of “active” voxels in the spatial maps.
These tissue-region correlates were computed for the 2,432 basis sets extracted for all algorithms.
To measure sparsity for each BSS algorithm within each scan, we computed the L0-norm of each spatial map,
and used the average across all networks within a scan to measure the spatial sparsity of the extracted networks.
Specifically, for each spatial map we measured sparsity using the L0-norm, where sparsity(X) = −1 ∗∑k (cid:107)X (cid:107)
k j=1 j 0
where k is the total number of components. The negative sign ensures that more zero-valued voxels will lead to a lower
sparsity measure. This L0 based measure was chosen because it is not sensitive to the scaling of the images, which are
necessarily different across algorithms.

14 Xie et al.
2.7 Comparison of BSS Algorithms by Classification Accuracy
The BSS algorithms’ SVM performance were first compared for the 20 network, artifact-cleaned scans, predicting
accuracy using Algorithm as a main effect in a general linear mixed-effects regression model (baseline model); Scan-
ID and Subject-ID were included as random effects to adjust for multiple comparisons. Across the 304 scans and 8
algorithms, this resulted in the classification accuracy from 2,432 SVM models being compared. We then assessed
whether sparser spatial maps led to better classification accuracy after adjusting for the effect of the algorithm, predict-
ing classification accuracy using both the BSS algorithm type and network sparsity as fixed effects and Scan-ID and
Subject-ID as random effects for multiple comparison adjustments.
Finally, we included tissue-type profiles to measure the association of the physiological profiles of the spatial
maps with their ability to decode functional activity. This assesses, among other things, whether network extractions
containinglarger amountsof whitematter havepoorer classificationaccuracy thannetworkextractions containingmore
grey matter. In a general linear mixed effects regression model (full model), we predicted the classification accuracy
within each scan using the algorithm type, a session effect, the sparsity of the networks, the average and standard
deviation of the intensity within regions of grey matter, white matter, CSF (averaged across networks). Scan ID and
Subject ID were both included as random effects to adjust for multiple comparisons. This was done for the 20 network
extraction, on data which had been cleaned of artifacts (including white matter and CSF artifacts).
We compared the baseline model containing just the BSS algorithm main effect to the full model containing the
BSS algorithm effect and the physiological profiles of the spatial maps using a chi-square hierarchical regression, to
evaluate whether the physiological profiles of the spatial maps were related to classification accuracy above and beyond
the effect of the BSS algorithm alone.
3 Results
All algorithms performed better than chance on average, with general trends present across the constraint families. The
best performing independence algorithm (Fast ICA) was still inferior to the worst performing sparse coding algorithm
(K-SVD) for classifying cognitive activity (p<0.005) in Table I and Figure 1, using 20 dictionary elements on the
traditionally-preprocessed fMRI data and an SVM classifier. The strong predictive performance of the sparse coding
algorithms persisted when using 50 networks instead of 20 (Table II) and when using data from which additional
artifacts had been removed, shown in Table III.
We compared how similarly these algorithms classified within each scan in Figure 2, using a multi-dimensional

15 Xie et al.
scaling of the accuracies within scan (for the 20-network, traditionally preprocessed scans). Methods predicted simi-
larly to other methods within their class: K-SVD, a sparse coding method, was most correlated with L1 Regularized
Learning (Lasso), another sparse coding method. This suggests that algorithms within certain families tend to have
similar performance.
Within each scan, the algorithms in order from best to worst classification accuracy were: L1 Regularization, K-
SVD, Fast ICA, EBM ICA, JADE ICA, InfoMax ICA, NMF-PG, and NMF-ALS, as shown in Table IV using 20
spatial maps on artifact-cleaned data. Spatial sparsity was highly significant; scans which extracted sparser spatial
maps had higher classification accuracy (p < 0.001) after accounting for the effect of the algorithms as shown in Table
V. The CSF functional map density was negatively associated with classification accuracy (p < 0.001), while high
variability in white matter functional density was associated with better classification accuracy (p < 0.001). Including
the physiological profiles of the spatial maps significantly helped predict the within-scan classification accuracy, above
andbeyondtheeffectofthealgorithmalone(p<0.001, chi-squaretestofnestedmodels). Thephysiologicalprofilesof
the spatial maps were likely correlated with sparsity of the spatial maps, as the sparsity measurement lost significance
once accounting for the physiological profiles.
SVM Random Forests
NMF-ALS 0.63 (0.08) 0.63 (0.09)
NMF-PG 0.63 (0.08) 0.63 (0.09)
InfoMax ICA 0.64 (0.08) 0.67 (0.09)
JADE ICA 0.66 (0.08) 0.69 (0.09)
EBM ICA 0.66 (0.10) 0.71 (0.10)
Fast ICA 0.67 (0.08) 0.72 (0.08)
K-SVD 0.70 (0.08) 0.73 (0.08)
L1 Regularized Learning 0.74 (0.07) 0.71 (0.07)
Table I: Classification accuracy averaged across 304 traditionally preprocessed data scans in predicting whether a
subject was viewing a video, listening to an audio stimuli, or resting, using 20 networks. Chance accuracy is 50%.
SVM Random Forests
InfoMax 0.59 (0.07) 0.59 (0.07)
NMF-ALS 0.60 (0.08) 0.62 (0.10)
NMF-PG 0.66 (0.09) 0.64 (0.08)
JADE ICA 0.70 (0.08) 0.72 (0.08)
EBM ICA 0.72 (0.09) 0.74 (0.09)
Fast ICA 0.73 (0.07) 0.75 (0.07)
K-SVD 0.75 (0.07) 0.77 (0.07)
L1 Regularized Learning 0.75 (0.07) 0.69 (0.07)
Table II: Classification accuracy averaged across 304 traditionally preprocessed scans in predicting whether a subject
was viewing a video, listening to an audio stimuli, or resting, using 50 networks. Chance accuracy is 50%.

16 Xie et al.
SVM Random Forests
NMF-ALS 0.58 (0.09) 0.60 (0.11)
NMF-PG 0.58 (0.09) 0.59 (0.11)
InfoMax ICA 0.67 (0.07) 0.67 (0.07)
JADE ICA 0.68 (0.08) 0.71(0.08)
EBM ICA 0.69 (0.09) 0.72 (0.09)
Fast ICA 0.70 (0.08) 0.72 (0.08)
K-SVD 0.70 (0.08) 0.71 (0.08)
L1 Regularized Learning 0.74 (0.07) 0.71 (0.07)
Table III: Classification accuracy averaged across 304 artifact-cleaned scans in predicting whether a subject was view-
ing a video, listening to an audio stimuli, or resting, using 20 networks. Chance accuracy is 50%.
Estimate Std. Error t value
(Intercept) 0.70 0.01 110.55 ***
NMF-ALS -0.11 0.001 -37.84 ***
NMF-PG -0.05 0.001 -15.59 ***
InfoMax ICA -0.03 0.001 -10.11 ***
JADE ICA -0.01 0.001 -4.02 ***
EBM ICA -0.001 0.001 -0.91
K-SVD 0.001 0.001 0.36
L1 Regularized Learning 0.04 0.001 14.70 ***
Table IV: Classification accuracy of BSS algorithm compared to Fast ICA, using 20 networks extracted from artifact-
cleaned scans, in order of performance from worst to best. Time series weights from InfoMax ICA, JADE ICA,
NMF-PG, NMF-ALS predicted activity significantly worse than Fast ICA, while L1-Regularization did significantly
better (p < 0.001). Baseline is set to Fast ICA classification accuracy. Scan-ID and Subject-ID were included as
random effects within a general linear mixed-effects regression model to adjust for multiple comparisons. *** = p <
.001
4 Discussion
The BSS algorithms can be formulated as theories of functional organization and encoding. Comparing the classifica-
tion accuracy can neither validate nor invalidate any specific hypothesis, but the success of a specific BSS algorithm
provides evidence for a unique biological interpretation of generative activity. Interpreting features in any decoding
scheme is complex (Guyon and Elisseeff (2003)). As recently highlighted by Haufe et al. (2014), feature weights
should not be interpreted directly. When features have a shared covariance structure, irrelevant features can be as-
signed a strong weight to compensate for shared noise in feature space. However, as these authors also point out, when
the features are independent, the shared covariance is minimized and the interpretation theoretically becomes more
tractable.
Our experiments showed that algorithms which enforced sparsity, instead of merely encouraging it, frequently had
the highest classification accuracy compared to the independence and sparse coding algorithms. When we implemented
K-SVD with an overcomplete basis of 300 networks, the classification accuracy remained similar. The non-negativity
algorithms had the least accurate classification accuracy. Among the ICA algorithms, Fast ICA had the highest clas-

17 Xie et al.
Estimate Std. Error t value
(Intercept) 0.83 0.01 57.91 ***
Sparsity 0.001 0.001 10.82 ***
NMF-ALS -0.14 0.001 -35.21 ***
K-SVD -0.08 0.01 -9.99 ***
NMF-PG -0.05 0.001 -17.48 ***
InfoMax ICA -0.03 0.001 -10.39 ***
JADE ICA -0.01 0.001 -4.13 ***
EBM ICA -0.001 0.001 -0.93
L1 Regularized Learning 0.03 0.001 10.70 **
Table V: Greater sparsity for an extracted spatial map was associated with a higher classification accuracy in predicting
a subject’s task during scan time when using those spatial maps for encoding (p < 0.001), holding constant the effect
of the algorithm. Using 20 networks extracted from artifact-cleaned scans, sparsity was measured using the negative
averaged number of zero-valued voxels of all spatial maps, which is insensitive to the scaling of the individual algo-
rithms. Baseline is set to Fast ICA classification accuracy. Scan-ID and Subject-ID were included as random effects
within a general linear mixed-effects regression model to adjust for multiple comparisons. *** = p < .001
sification accuracy. These trends were consistent for the extraction of 20 and 50 networks, and for different levels of
data cleaning (removing artifactual components). For all algorithms, extracted spatial maps containing more regions
of CSF led to worse classification accuracy (p < 0.001). CSF and white matter artifacts were purposefully removed
during the artifact cleaning, so this CSF measures the residual noise. Algorithms which showed large variability in their
extraction of white matter regions had significantly higher classification accuracy (p < 0.001). This may suggest that
purposefully selecting white matter regions to construct functional networks helps to improve classification accuracy.
In Figure 3, we show thresholded spatial maps derived from the visual task for a representative subject. These maps
were all rescaled to match across algorithms. Most of the algorithms clearly isolated the visual network. However,
the NMF algorithms resulted in weakly identifiable visual networks, and unsurprisingly this class of algorithms were
outperformed by the other algorithms. It is therefore reasonable to suggest that the signed values in the BOLD signal
carry either important descriptive or class specific information. In addition to identifying possible networks through
manual inspection of the spatial maps, we also identified them by the time course. The unthresholded spatial map
most correlated (absolute value) with performing any task is shown in Figure 4. This may be the most likely candidate
for the default mode network since the signs of the timecourses are arbitrarily positive or negative, and the“any task”
timecourse consisted of both auditory and visual stimuli which are functionally distinct- thus precluding this as a
specific task-related network. High-intensity values for that algorithm are in red, while low-intensity values are in
blue, but the numeric values do not map across algorithms because of the different scaling methods these algorithms
employ. The differences among algorithms is partially attributed to the physiological profiles of the spatial maps they
extracted. The 20 extracted networks for all algorithms for a single scan are provided in the Appendix as NIfTI files,
along with code to reproduce these results.

18 Xie et al.
Estimate Std. Error t value
(Intercept) 0.71 0.02 30.53 ***
Mean(CSF) -0.30 0.09 -3.34 ***
Mean(Grey Matter) -0.05 0.08 -0.65
Mean(White Matter) 0.01 0.06 0.08
SD(CSF) 0.001 0.11 0.01
SD(Grey Matter) -0.32 0.09 -3.62 ***
SD(White Matter) 0.44 0.07 6.07 ***
Sparsity 0.001 0.001 0.68
Session -0.01 0.01 -1.57
NMF-ALS -0.05 0.02 -2.23
InfoMax ICA -0.03 0.001 -9.69 ***
EBM ICA -0.01 0.01 -1.66
JADE ICA -0.01 0.001 -3.54 ***
K-SVD 0.01 0.01 0.54
NMF-PG 0.07 0.02 3.25 ***
L1 Regularized Learning 0.07 0.001 13.99 ***
Table VI: Encodings using spatial maps with high intensity in CSF regions had reduced classification accuracy, while
spatial maps with variable extractions in white-matter and grey-matter regions had higher classification accuracy. Base-
line is set to Fast ICA classification accuracy. Scan-ID and Subject-ID were included as random effects within a general
linear mixed-effects regression model to adjust for multiple comparisons. *** = p < .001
4.1 NMF and functional MRI
Despite the promising implications of NMF, its predictive performance was underwhelming. The non-negativity con-
straint suppresses all negative BOLD activations, which has controversial hypotheses behind its generation. The poor
performance of NMF may suggest that the disregarded negative activations did contain task-related signal. The non-
negativity constraint also encourages local circuits, and geographically distributed networks may have been parsed and
diluted by this. The NMF-PG algorithm actually performed better than Fast ICA after adjusting for the CSF functional
loadings and the white matter variability. This suggests that NMF algorithms may capture higher levels of noise in the
fMRI activation maps. The NMF spatial maps had a strong resemblance to structural images with the regional intensity
varying depending on the tissue type, even though the learning was done on functional data. This was not an artifact of
the initialization, as the maps were initialized to be random values. It was also not an artifact of improper convergence,
as running the algorithm far beyond convergence did not change the structural-map appearance of these maps. Rather,
we speculate that the likely default mode may have been suppressed in NMF, since the DMN is anticorrelated with
the task related networks which may have been stronger contenders spanning both auditory and visual domains. It is
possible that NMF performed poorly because it was not able to use activation of the DMN to identify the periods of
rest. Finally, the NMF-ALS algorithm had difficulty extracting a full set of 20 networks on the artifact-cleaned fMRI
data, although it was able to do so consistently on the fMRI data which had received only regular pre-processing.
Collectively, this suggests that NMF may find its purpose not in capturing task-related activation maps, because of its

19 Xie et al.
suppression of all negative signals.
4.2 Limitations
There are several limitations to this paper. We assessed how brain networks are encoded using a decoding approach-
however, this is an indirect and a secondary measurement of performance, complicated by an unknown ground truth.
It is unknown how many brain networks exist in a given subject, and whether these brain networks are consistent
across subjects. Our interrogation into these networks is based upon our perturbation of the system using a stimulus,
where we use task decoding to identify properties of networks which should exist based on the visual and audio stimuli
present. We compared the performance of the algorithms using their prediction power in a supervised learning model.
This suggests that, out of the algorithms considered here, the sparse coding assumptions may be more biologically
plausible in their accounting for task-related activity changes, but restricts our inference only to networks which are
task-associated. Moreover, this does not suggest that the frameworks imposed by these specific algorithms are the best
explanation for how functional networks are organized; rather, these analyses suggest that out of the linear algorithms
defined by specific constraints, the sparse coding constraint may best capture task-related activations. For the classi-
fication, given the computational considerations when optimizing many parameters, we used only a fixed ’C’ penalty
term. It is possible that further hyperparameter optimization may alter results. However, in all cases the total number
of features was already relatively small (20 or 50). Given that both algorithms internally penalize for overfitting, it is
unlikely that this optimization would have a large effect. Finally, although we used 304 scans for this study, these scans
originated from 51 subjects. Although we controlled for the effects of Subject, Scan, and Session, there may have been
other unknown factors which introduced covariance.
The secondary artifact-cleaning step used Fast ICA to propose possible noisy networks, which were flagged and
removed before reconstructing the scans. The ICA-based artifact cleaning may have introduced some disadvantages to
the other algorithms, since these algorithms were run on ICA-cleaned data. We cleaned the data (motion correction,
etc...) in two stages, through traditional pre-processing and secondarily through artifact-removal using FIX. Despite
this, someresidualnoisemaystillhaveremain, asdemonstratedbytheCFSintensityinthecleaneddatapredictingpoor
classification accuracy within a scan. Although we referred to the spatial maps as brain networks here, the variability of
these networks for the different algorithms gives pause as to whether these networks are really the linear combinations
as the BSS algorithms assume to produce functional activity. We did not evaluate every existing variation of ICA, NMF,
and other sparse coding algorithms, but relied instead on the most popular variations. Similarly, these analyses only
compared within-scan network extractions, and may not generalize to group analyses where networks are extracted

20 Xie et al.
across large numbers of subjects and scans. It is possible that the sparse coding algorithms may be hypertuned to
the unique activity within a single scan, and that the networks observed when applied to groups may not be flexible
enough to account for the variation seen across subjects. Investigating how these networks change in group analyses,
and whether sparsifying methods are still superior on a group scale, are both directions for future research.
5 Conclusion
The most common methods of interpreting functional brain networks may not be the most effective for describing the
networks active within a single scan. More generally, these results suggest that the functional organization of the brain
may be constructed better by sparse coding algorithms than by spatial independence or parts-based representations,
at the lowest levels. We argue these results are reasonable, where a sparse operational framework would support
an efficient use of biological resources. This does not preclude a network-based view of functional activity. The
SVM algorithm, at its heart, uses weighted combinations of sparse elements to predict which activity a subject was
performing. This suggests that the sparse interpretation allows a more flexible construction of the comprehensive
networks than networks which by their mathematical assumptions nurture more fully-defined functional maps.
We suggest that sparsity is a reasonable developmental constraint, insomuch as redundant (non-sparse) network
components are costly in energy consumption and complexity. Sparse coding schemes reduce energy consumption by
minimizing the number of action potentials necessary to represent information within neural codes (Spratling (2014);
Sengupta et al. (2010)). Moreover, the specialization and discouragement of local multitasking associated with spatial
sparsity may be more reasonable than the “boundless energy” framework of statistical independence, where a single
voxel is not constrained by its overall (total) network membership. The non-negativity NMF algorithms performed
poorly, suggesting that the negative BOLD signals are indeed important measures of task-related functional activity. In
ICA, a single voxel’s intensity in a given network is not influenced by the separate cognitive processes (networks) to
which that voxel contributes, permitting unlimited multitasking. The success of the sparse coding algorithms suggests
that, during periods of activity, local activity is specialized.
The power of sparse algorithms may be in their disbursement of functional activity across multiple networks; the
components they then nominate hold power when combined with other sparse components, suggesting they form a
metabasis for cognitive activity rather than complete networks. This may indicate that these sparse elements will
prove more useful for hierarchical algorithms such as deep learning methods. This is a direction for future research.
The experiments presented here suggest the importance of sparsity, but indeed sparsity may not be the key factor in
decoding fMRI activity. When including the anatomical profiles of the spatial networks, the extraction of CSF regions

21 Xie et al.
(a proxy measure of overall noise) overtook sparsity in explanatory power to predict classification accuracy. This
may suggest then that sparsity is a proxy measure for reduced noise, but not necessarily the driving source behind the
predictive power. The sparser maps may be more successful across all algorithms because they correspond well to the
actual biological processes, because they omit regions containing noise, or even because the sparser basis sets span the
partitioning space better. Although sparsity presents an optimal encoding framework for applying decoding models,
the mechanism underlying its success remains unknown.

22 Xie et al.
6 Acknowledgments
Our sincere appreciation to M.S. Cohen and M.A.O. Vasilescu for constructive feedback and insight on this manuscript.
Ariana E. Anderson, Ph.D., holds a Career Award at the Scientific Interface from BWF and is supported by R03
MH106922. Pamela K. Douglas is supported by Klingenstein Third Generation Fellowship, Keck Foundation, and
NIH/National Center for Advancing Translational Science (NCATS) UCLA CTSI Grant Number UL1TR000124. Ying
Nian Wu is supported by NSF DMS 1310391, ONR MURI N00014-10-1-0933, DARPA MSEE FA8650-11-1-7149.
Arthur L. Brody is supported by the National Institute on Drug Abuse (R01 DA20872), the Department of Veterans
Affairs, Office of Research and Development (CSRD Merit Review Award I01 CX000412), and the Tobacco-Related
Disease Research Program (23XT-0002).

23 Xie et al.
References
Aapo Hyva¨rinen, E.O. (2000) Independent component analysis: Algorithms and application. Neural Networks, 13 (4-
5), 411–430.
Aapo Hyva¨rinen, Juha Karhunen, E.O. (2001) Independent Component Analysis, Wiley, New York.
Abolghasemi, V., Ferdowsi, S., andSanei, S.(2013)Fastandincoherentdictionarylearningalgorithmswithapplication
to fMRI. Signal, Image and Video Processing, pp. 1–12.
Amari, S.i., Cichocki, A., Yang, H.H. et al. (1996) A new learning algorithm for blind signal separation. Advances in
neural information processing systems, pp. 757–763.
Anderson, A., Dinov, I.D., Sherin, J.E., Quintana, J., Yuille, A.L., and Cohen, M.S. (2010) Classification of spatially
unaligned fMRI scans. NeuroImage, 49 (3), 2509–2519.
Anderson, A., Douglas, P.K., Kerr, W.T., Haynes, V.S., Yuille, A.L., Xie, J., Wu, Y.N., Brown, J.A., and Cohen, M.S.
(2013) Non-negative matrix factorization of multimodal MRI, fMRI and phenotypic data reveals differential changes
in default mode subnetworks in ADHD. NeuroImage.
Anderson, A., Han, D., Douglas, P.K., Bramen, J., and Cohen, M.S. (2012) Real-time functional MRI classification
of brain states using Markov-SVM hybrid models: peering inside the rt-fMRI black box, in Machine learning and
interpretation in neuroimaging, Springer, pp. 242–255.
Anttila, P., Paatero, P., Tapper, U., and Ja¨rvinen, O. (1995) Source identification of bulk wet deposition in Finland by
positive matrix factorization. Atmospheric Environment, 29 (14), 1705–1718.
Bell, A.J. and Sejnowski, T.J. (1995) An information-maximization approach to blind separation and blind deconvolu-
tion. Neural computation, 7 (6), 1129–1159.
Bertsekas, D.P. (1999) Nonlinear Programming, Athena Scientific, Belmont, MA, 2nd edn..
Bianciardi, M., Fukunaga, M., van Gelderen, P., de Zwart, J.A., and Duyn, J.H. (2011) Negative BOLD-fMRI signals
in large cerebral veins. Journal of Cerebral Blood Flow & Metabolism, 31 (2), 401–412.
Breiman, L. (2001) Random forests. Machine learning, 45 (1), 5–32.
Burges, C.J. (1998) A tutorial on support vector machines for pattern recognition. Data mining and knowledge discov-
ery, 2 (2), 121–167.

24 Xie et al.
Calhoun, V., Pearlson, G., and Adali, T. (2004) Independent component analysis applied to fMRI data: a generative
model for validating results. Journal of VLSI signal processing systems for signal, image and video technology,
37 (2-3), 281–291.
Calhoun, V.D., Potluru, V.K., Phlypo, R., Silva, R.F., Pearlmutter, B.A., Caprihan, A., Plis, S.M., and Adalı, T. (2013)
Independent component analysis for brain fMRI does indeed select for maximal independence. PloS one, 8 (8),
e73309.
Cardoso, J.F. (1999) High-order contrasts for independent component analysis. Neural computation, 11 (1), 157–192.
Cardoso, J.F. and Souloumiac, A. (1993) Blind beamforming for non-gaussian signals, in IEEE Proceedings F (Radar
and Signal Processing), vol. 140, IET, vol. 140, pp. 362–370.
Culbertson, C.S., Bramen, J., Cohen, M.S., London, E.D., Olmstead, R.E., Gan, J.J., Costello, M.R., Shulenberger, S.,
Mandelkern, M.A., and Brody, A.L. (2011) Effect of bupropion treatment on brain activation induced by cigarette-
related cues in smokers. Archives of general psychiatry, 68 (5), 505–515.
Daubechies, I., Roussos, E., Takerkart, S., Benharrosh, M., Golden, C., D’ardenne, K., Richter, W., Cohen, J., and
Haxby, J. (2009) Independent component analysis for brain fMRI does not select for independence. Proceedings of
the National Academy of Sciences, 106 (26), 10415–10422.
Delorme, A. and Makeig, S. (2004) EEGLAB: an open source toolbox for analysis of single-trial EEG dynamics.
Journal of Neuroscience Methods, 134, 9–21.
Ding, X., Lee, J.H., and Lee, S.W. (2012) Performance evaluation of nonnegative matrix factorization algorithms to
estimate task-related neuronal activities from fMRI data. Magnetic resonance imaging.
Douglas, P., Harris, S., and Cohen, M. (2009) Na¨ıve bayes classification of belief verses disbelief using event related
neuroimaging data. NeuroImage, 47, S80.
Douglas, P.K., Harris, S., Yuille, A., and Cohen, M.S. (2011) Performance comparison of machine learning algorithms
and number of independent components used in fMRI decoding of belief vs. disbelief. NeuroImage, 56 (2), 544–553.
Douglas, P.K., Lau, E., Anderson, A., Head, A., Kerr, W., Wollner, M., Moyer, D., Li, W., Durnhofer, M., Bramen, J.
etal.(2013)Singletrial decodingofbeliefdecisionmaking fromEEGandfMRIdatausing independentcomponents
features. Frontiers in human neuroscience, 7.

25 Xie et al.
Eavani, H., Filipovych, R., Davatzikos, C., Satterthwaite, T.D., Gur, R.E., andGur, R.C. (2012) Sparse dictionarylearn-
ing of resting state fMRI networks, in Pattern Recognition in NeuroImaging (PRNI), 2012 International Workshop
on, IEEE, pp. 73–76.
Ferdowsi, S., Abolghasemi, V., Makkiabadi, B., andSanei, S.(2011)AnewspatiallyconstrainedNMFwithapplication
to fMRI, in Engineering in Medicine and Biology Society, EMBC, 2011 Annual International Conference of the
IEEE, IEEE, pp. 5052–5055.
Ferdowsi, S., Abolghasemi, V., and Sanei, S. (2010) A constrained NMF algorithm for BOLD detection in fMRI, in
Machine Learning for Signal Processing (MLSP), 2010 IEEE International Workshop on, IEEE, pp. 77–82.
Friston, K.J. (1998) Modes or models: a critique on independent component analysis for fMRI. Trends in cognitive
sciences, 2 (10), 373–375.
Griffanti, L., Salimi-Khorshidi, G., Beckmann, C.F., Auerbach, E.J., Douaud, G., Sexton, C.E., Zsoldos, E., Ebmeier,
K.P., Filippini, N., Mackay, C.E. et al. (2014) Ica-based artefact removal and accelerated fMRI acquisition for
improved resting state network imaging. NeuroImage, 95, 232–247.
Guyon, I. and Elisseeff, A. (2003) An introduction to variable and feature selection. The Journal of Machine Learning
Research, 3, 1157–1182.
Harel, N., Lee, S.P., Nagaoka, T., Kim, D.S., and Kim, S.G. (2002) Origin of negative blood oxygenation level–
dependent fMRI signals. Journal of cerebral blood flow & metabolism, 22 (8), 908–917.
Haufe, S., Meinecke, F., Go¨rgen, K., Da¨hne, S., Haynes, J.D., Blankertz, B., and Bießmann, F. (2014) On the interpre-
tation of weight vectors of linear models in multivariate neuroimaging. Neuroimage, 87, 96–110.
Hyva¨rinen, A. and Oja, E. (1997) A fast fixed-point algorithm for independent component analysis. Neural computa-
tion, 9 (7), 1483–1492.
Hyva¨rinen, A. (1999) Fast and robust fixed-point algorithms for independent component analysis. IEEE Transactions
on Neural Networks, 10 (3), 626–634.
Jenkinson, M., Bannister, P., Brady, M., and Smith, S. (2002) Improved optimization for the robust and accurate linear
registration and motion correction of brain images. NeuroImage, 17 (2), 825–841.
Kim, H. and Park, H. (2007) Non-negative matrix factorization based on alternating non-negativity constrained least
squares and active set method. Technical report, Technical Report GT-CSE-07-01, College of Computing, Georgia
Institute of Technology.

26 Xie et al.
Koldovsky, Z., Tichavsky, P., and Oja, E. (2006) Efficient variant of algorithm fastica for independent component
analysis attaining the cram&# 201; r-rao lower bound. Neural Networks, IEEE Transactions on, 17 (5), 1265–1277.
Lee, D.D. and Seung, H.S. (1999) Learning the parts of objects by non-negative matrix factorization. Nature, 401,
788–791.
Lee, D.D. and Seung, H.S. (2001) Algorithms for non-negative matrix factorization, in Advances in Neural Information
Processing Systems 13, pp. 556–562.
Lee, H., Battle, A., Raina, R., and Ng, A.Y. (2007) Efficient sparse coding algorithms, in Advances in Neural Informa-
tion Processing Systems 19, pp. 801–808.
Lee, K., Tak, S., and Ye, J.C. (2011) A data-driven sparse GLM for fMRI analysis using sparse dictionary learning
with MDL criterion. Medical Imaging, IEEE Transactions on, 30 (5), 1076–1089.
Lee, K. and Ye, J.C. (2010) Statistical parametric mapping of fMRI data using sparse dictionary learning, in Biomedical
Imaging: From Nano to Macro, 2010 IEEE International Symposium on, IEEE, pp. 660–663.
Leonardi, N., Shirer, W.R., Greicius, M.D., and Van De Ville, D. (2014) Disentangling dynamic networks: separated
and joint expressions of functional connectivity patterns in time. Human brain mapping, 35 (12), 5984–5995.
Li, X.L. and Adali, T. (2010) Independent component analysis by entropy bound minimization. Signal Processing,
IEEE Transactions on, 58 (10), 5151–5164.
Liaw, A. and Wiener, M. (2002) Classification and regression by randomforest. R news, 2 (3), 18–22.
Lin, C.J. (2007) Projected gradient methods for non-negative matrix factorization. Neural Computation, 19, 2756–
2779.
Liu, A., Chen, X., McKeown, M.J., and Wang, Z.J. (2015) A sticky weighted regression model for time-varying
resting-state brain connectivity estimation. IEEE Transactions on Biomedical Engineering, 62 (2), 501–510.
Logothetis, N.K. and Sheinberg, D.L. (1996) Visual object recognition. Annual review of neuroscience, 19 (1), 577–
621.
M. Aharon, M.E. and Bruckstein, A. (2006) The K-SVD: An algorithm for designing of overcomplete dictionaries for
sparse representation. IEEE Transaction On Signal Processing, 54 (11), 4311–4322.
McKeown, M.J., Hansen, L.K., and Sejnowsk, T.J. (2003) Independent component analysis of functional MRI: what
is signal and what is noise? Current opinion in neurobiology, 13 (5), 620–629.

27 Xie et al.
McKeown, M.J., Makeig, S., Brown, G.G., Jung, T.P., Kindermann, S.S., Bell, A.J., and Sejnowski, T.J. (1997) Anal-
ysis of fMRI data by blind separation into independent spatial components, Tech. Rep., DTIC Document.
Meyer, D., Dimitriadou, E., Hornik, K., Weingessel, A., and Leisch, F. (2012) e1071: Misc Functions of the De-
partment of Statistics (e1071), TU Wien. URL http://CRAN.R-project.org/package=e1071, r package
version 1.6-1.
Moraschi, M., DiNuzzo, M., and Giove, F. (2012) On the origin of sustained negative BOLD response. Journal of
neurophysiology, 108 (9), 2339–2342.
M.W. Berry, M Browne, A.N.L.V.P. and Plemmons, R. (2007) Algorithms and applications for approximate nonnega-
tive matrix factorization. Computational Statistics and Data Analysis, 52 (1), 155–173.
Olshausen, B.A. et al. (1996) Emergence of simple-cell receptive field properties by learning a sparse code for natural
images. Nature, 381 (6583), 607–609.
P. Paatero, U.T. (1994) Positive matrix factorization: A non-negative factor model with optimal utilization of error
estimates of data values. Environmetrics, 5 (2), 111–126.
Palmer, S.E. (1977) Hierarchical structure in perceptual representation. Cognitive psychology, 9 (4), 441–474.
Potluru, V.K. and Calhoun, V.D. (2008) Group learning using contrast NMF: Application to functional and structural
MRI of schizophrenia, in Circuits and Systems, 2008. ISCAS 2008. IEEE International Symposium on, IEEE, pp.
1336–1339.
Risk, B.B., Matteson, D.S., Ruppert, D., Eloyan, A., and Caffo, B.S. (2013) An evaluation of independent component
analyses with an application to resting-state fMRI. Biometrics.
Rubinstein, R., Bruckstein, A.M., and Elad, M. (2010) Dictionaries for sparse representation modeling. Proceedings
of the IEEE, 98 (6), 1045–1057.
Rubinstein, R., Z.M. and Elad, M. (2008) Efficient implementation of the K-SVD algorithm using batch orthogonal
matching pursuit. Technical Report - CS Technion.
Salimi-Khorshidi, G., Douaud, G., Beckmann, C.F., Glasser, M.F., Griffanti, L., and Smith, S.M. (2014) Automatic
denoising of functional MRI data: combining independent component analysis and hierarchical fusion of classifiers.
NeuroImage, 90, 449–468.

28 Xie et al.
Sengupta, B., Stemmler, M., Laughlin, S.B., and Niven, J.E. (2010) Action potential energy efficiency varies among
neuron types in vertebrates and invertebrates. PLoS Comput Biol, 6 (7), e1000840.
Smith, A.T., Williams, A.L., and Singh, K.D. (2004) Negative BOLD in the visual cortex: evidence against blood
stealing. Human brain mapping, 21 (4), 213–220.
Smith, S.M. (2002) Fast robust automated brain extraction. Human brain mapping, 17 (3), 143–155.
Smith, S.M., Fox, P.T., Miller, K.L., Glahn, D.C., Fox, P.M., Mackay, C.E., Filippini, N., Watkins, K.E., Toro, R., Laird,
A.R. et al. (2009) Correspondence of the brain’s functional architecture during activation and rest. Proceedings of
the National Academy of Sciences, 106 (31), 13040–13045.
Spratling, M.W. (2014) Classification using sparse representations: a biologically plausible approach. Biological cy-
bernetics, 108 (1), 61–73.
the ICA and BSS group, U.o.H. (2014) The fastica package for matlab. [http://research.ics.aalto.fi/ica/fastica/].
Wachsmuth, E., Oram, M., and Perrett, D. (1994) Recognition of objects and their component parts: responses of
single units in the temporal cortex of the macaque. Cerebral Cortex, 4 (5), 509–522.
Wang, X., Tian, J., Li, X., Dai, J., and Ai, L. (2004) Detecting brain activations by constrained non-negative matrix fac-
torization from task-related BOLD fMRI, in Medical Imaging 2004, International Society for Optics and Photonics,
pp. 675–682.

29 Xie et al.
7 Figures and Legends
Figure 1: Although ICA is the most commonly used method to extract and define fMRI spatial networks, encoding
scans using sparse coding algorithms like K-SVD and L1 Regularized Learning led to higher classification accuracy in
determining whether a subject was resting, watching a video, or hearing an audio cue. The best performing indepen-
dence algorithm (Fast ICA) was still inferior to the worst performing sparse coding algorithm (K-SVD) for classifying
cognitive activity (p<0.005) using an SVM classifier on 20 networks on traditionally-preprocessed data. Chance accu-
racy is 50%.

30 Xie et al.
Figure 2: Within a scan, algorithms sharing particular constraints tended to classify with similar accuracy. This multi-
dimensional scaling visualizes the similarities of how the BSS algorithms classified within each scan using the 20-basis
networks extracted on the traditionally preprocessed data.

31 Xie et al.
Figure 3: Visual network spatial maps for each of the compared algorithms, shown for a representative subject. Visual
networks were identified via manual inspection out of 20 possible networks extracted. Values for the NMF algorithms
vary from ICA and K-SVD maps, and were therefore adjusted to meet this range prior to thresholding.

32 Xie et al.
Figure 4: We identified the network most associated with performing (or not) any task, using the maximal absolute
correlation between the timecourse of the network and the any task/rest paradigm. This empirically-identified network
may correspond to the default mode network, since it is not task-specific (associated with only video or an audio
stimuli). The maximally correlated network for each algorithm is shown unthresholded, but consistently colored within
each algorithm. High intensity regions are red, and low intensity regions are blue. The units of the color scale depend
on the algorithms; for example, NMF values would be bounded below by 0, while the intensity of the ICA spatial maps
were largely centered between (-3, 3). Results shown are for the 20 dictionary elements on traditionally preprocessed
data, extracted from the same scan.