Xen Orchestra Installer / Updater
Scripttoinstall/updateXenOrchestraandallofit’sdependenciesonmultipledifferentLinuxdistribu‑
tions. Separate script to be used on XenServer/XCP‑ng host that installs a readymade VM image that
has Xen Orchestra installed utilizing the same installer script.
How about docker? No worries, check Docker hub
What is Xen Orchestra?
XenOrchestraisawebinterfaceusedtomanageXenServer/XCP‑nghostsandpools. Itrunsseparately
and one can manage multiple different virtualization environments from one single management in‑
terface.
XenOrchestraisdevelopedbycompanycalledVates. TheyofferXenOrchestraasaturnkeyappliance
withdifferentpricingmodelsfordifferentneedsandevenafreeversionwithlimitedcapabilities. This
is the preferred and only supported method of using Xen Orchestra product as the appliance goes
throughQAandeachoftheplanscomewithsupport. Ihighlyrecommendusingtheofficialappliance
if you plan on using Xen Orchestra in production environment, to support a great product and it’s
development now, and in the future.
Why to use this script?
If you’re a home user/enthusiast with simple environment you want to manage but can’t justify the
cost of Xen Orchestra appliance and don’t need the support for it.
SinceXenOrchestraisopensourceandmajorityofthepaidfeaturesincludedintheofficialappliance
arepartofthesources,onecanbuilditthemself. Thisprocedureisevendocumented. Notethateven
though this method is documented, it’s not supported way of using Xen Orchestra and is intended to
be used only for testing purposes and not in production.
This script offers an easy way to install all dependencies, fetch source code, compile it and do all the
little details for you which you’d have to do manually otherwise. Other than that, it follows the steps
described in the official documentation. All source code for Xen Orchestra is by default pulled from
the official repository.
1

This script is not supported or endorsed by Xen Orchestra. Any issue you may have, please re‑
port it first to this repository.
The very first version of this script i did purely for myself. Now i’m mainly trying to keep it up to date
forotherswhomightalreadyrelyonitfrequently. Myintentionsaretoofferaneasywayforpeopleto
get into Xen Orchestra without restricted features which could potentially help this piece of software
to evolve and grow.
Preparations
FirstthingyouneedisaVM(orevenaphysicalmachineifyouwish)wheretoinstallthesoftware. This
shouldhaveatleast4GBofRAMand~1GBoffreediskspace. HavingmoreCPUdoesspeedathebuild
procedure a bit but isn’t really a requirement. 2vCPU’s on most systems are more than fine.
Supported Linux distributions and versions:
• CentOS 9 Stream
• CentOS 8 Stream
• AlmaLinux 9
• AlmaLinux 8
• Rocky Linux 9
• Rocky Linux 8
• Debian 12
• Debian 11
• Debian 10
• Ubuntu 22.04
• Ubuntu 20.04
Only x86_64 architecture is supported. For all those raspberry pi users out there, check container
instead.
All OS/Architecture checks can be disabled in xo-install.cfg for experimental purposes. Not
recommended obviously.
I suggest using a fresh OS installation, let script install all necessary dependencies and dedicate the
VM for running Xen Orchestra.
If you plan on using the prebuilt VM image for XenServer/XCP‑ng, see the image section below.
Installation
Start by cloning this repository to the machine you wish to install to.
2

See Wiki for common configuration options
There is a file called sample.xo-install.cfg which you should copy as xo-install.cfg.
This file holds some editable configuration settings you might want to change depending on your
needs.
When done editing configuration, just run the script with root privileges:
1 sudo ./xo-install.sh
There are few options you can choose from:
• Install
install all dependencies, necessary configuration and xen orchestra itself * Update
update existing installation to the newest version available * Rollback
should be self explanatory. if you wish to rollback to another installation after doing update or what‑
ever
• Install proxy
install all dependencies, necessary configuration and xen orchestra backup proxy
• Update proxy
update existing proxy installation to newest version available
Each of these options can be run non interactively like so:
1 sudo ./xo-install.sh --install [--proxy]
2 sudo ./xo-install.sh --update [--proxy] [--force]
3 sudo ./xo-install.sh --rollback
Asmentionedbefore,XenOrchestrahassomeexternaldependenciesfromdifferentoperatingsystem
packages. All listed below will be installed if missing:
1 rpm:
2 - curl
3 - epel-release
4 - nodejs (v14)
5 - npm (v3)
6 - yarn
7 - gcc
8 - gcc+
9 - make
10 - openssl-devel
11 - redis
12 - libpng-devel
3

| 1 sudo ./xo-install.sh --install [--proxy]          |
|:----------------------------------------------------|
| 2 sudo ./xo-install.sh --update [--proxy] [--force] |
| 3 sudo ./xo-install.sh --rollback                   |

| 1 rpm:             |
|:-------------------|
| 2 - curl           |
| 3 - epel-release   |
| 4 - nodejs (v14)   |
| 5 - npm (v3)       |
| 6 - yarn           |
| 7 - gcc            |
| 8 - gcc+           |
| 9 - make           |
| 10 - openssl-devel |
| 11 - redis         |
| 12 - libpng-devel  |

13 - python3
14 - git
15 - nfs-utils
16 - libvhdi-tools
17 - cifs-utils
18 - lvm2
19 - ntfs-3g
20 - dmidecode
21 - sudo (if set in xo-install.cfg)
22
23 deb:
24 - apt-transport-https
25 - ca-certificates
26 - libcap2-bin
27 - curl
28 - yarn
29 - nodejs (v14)
30 - npm (v3)
31 - build-essential
32 - redis-server
33 - libpng-dev
34 - git
35 - python3-minimal
36 - libvhdi-utils
37 - lvm2
38 - nfs-common
39 - cifs-utils
40 - gnupg (debian 10/11)
41 - software-properties-common (ubuntu)
42 - ntfs-3g
43 - dmidecode
44 - sudo (if set in xo-install.cfg)
Following repositories will be installed if needed and repository install is enabled in xo‑install.cfg
1 rpm:
2 - forensics repository
3 - epel repository
4 - nodesource repository
5 - yarn repository
6
7 deb:
8 - universe repository (ubuntu)
9 - nodesource repository
10 - yarn repository
Backupproxy Proxyinstallationmethodisexperimental,useatyourownrisk. Proxyinstalla‑
tion from sources is not documented by Xen Orchestra team. Method used here is the outcome
of trial and error.
4

| 13 - python3                             |
|:-----------------------------------------|
| 14 - git                                 |
| 15 - nfs-utils                           |
| 16 - libvhdi-tools                       |
| 17 - cifs-utils                          |
| 18 - lvm2                                |
| 19 - ntfs-3g                             |
| 20 - dmidecode                           |
| 21 - sudo (if set in xo-install.cfg)     |
| 22                                       |
| 23 deb:                                  |
| 24 - apt-transport-https                 |
| 25 - ca-certificates                     |
| 26 - libcap2-bin                         |
| 27 - curl                                |
| 28 - yarn                                |
| 29 - nodejs (v14)                        |
| 30 - npm (v3)                            |
| 31 - build-essential                     |
| 32 - redis-server                        |
| 33 - libpng-dev                          |
| 34 - git                                 |
| 35 - python3-minimal                     |
| 36 - libvhdi-utils                       |
| 37 - lvm2                                |
| 38 - nfs-common                          |
| 39 - cifs-utils                          |
| 40 - gnupg (debian 10/11)                |
| 41 - software-properties-common (ubuntu) |
| 42 - ntfs-3g                             |
| 43 - dmidecode                           |
| 44 - sudo (if set in xo-install.cfg)     |

| 1 rpm:                           |
|:---------------------------------|
| 2 - forensics repository         |
| 3 - epel repository              |
| 4 - nodesource repository        |
| 5 - yarn repository              |
| 6                                |
| 7 deb:                           |
| 8 - universe repository (ubuntu) |
| 9 - nodesource repository        |
| 10 - yarn repository             |

Proxy source code will be edited slightly to disable license check which only works with official
XOA and there is no documented or working procedure to bypass it properly (there used to be
but not anymore)
Backup proxy can be used to offload backup tasks from the main Xen Orchestra instance to a proxy
which has a direct connection to remote where backups are stored.
Requirements for proxy VM are otherwise the same as mentioned above, in addition the VM needs to
live inside XCP‑ng/XenServer pool managed by Xen Orchestra instance and have xen tools installed.
VM needs to have access to pool master host and Xen Orchestra needs to be able to access this VM via
TCP/443.
Majority of xo‑install.cfg variables have no effect to proxy installation. Proxy process will always run
as root user and in port 443.
Since there is no way in Xen Orchestra from sources to register a proxy via UI, the installation will
output a piece of json after the proxy is installed. You need to copy this json string and save to a file.
Then use the config import option in Xen Orchestra settings to import this piece of json to add proxy.
This works as a partial config import and won’t overwrite any existing config. Although it’s good to
take a config export backup just in case.
Xen Orchestra figures out the correct connection address from the VM UUID which is part of this json.
This is why the VM needs to be part of pool managed by Xen Orchestra. Connection details cannot be
changed manually.
NotethatforobviousreasonssomeoftheproxyfeaturesseeninXenOrchestraUIaren’tworking,like
upgrade button, upgrade check, redeploy, update appliance settings.
Plugins Plugins are installed according to what is specified in PLUGINS variable inside xo-
install.cfg configuration file. By default all available plugins that are part of xen orchestra
repository are installed. This list can be narrowed down if needed and 3rd party plugins included.
Image
If you don’t want to first install a VM and then use xo-install.sh script on it, you have the possi‑
bility to import VM image which has everything already setup. Use xo-vm-import.sh to do this,
it’lldownloadaprebuiltDebian11imagewhichhasXenOrchestraandXenOrchestraInstallerUpdater
installed.
Details of image build process here
Run on your Xenserver/XCP‑ng host with root privileges:
5

1 sudo bash -c "$(curl -s https://raw.githubusercontent.com/ronivay/
XenOrchestraInstallerUpdater/master/xo-vm-import.sh)"
Default username for UI is admin@admin.net with password admin
SSH is accessible with username xo with password xopass
Remember to change both passwords before putting the VM to actual use.
XenOrchestraisinstalledto/opt/xo,itusesself‑signedcertificatesfrom/opt/sslwhichyoucanreplace
if you wish. Installation script is at /opt/XenOrchestraInstallerUpdater which you can use to update
existing installation in the future.
xo‑server runs as a systemd service.
xo user has full sudo access. Xen Orchestra updates etc should be ran with sudo.
This image is updated weekly. Latest build date and MD5/SHA256 checksum can be checked from
here
Built and tested on XCP‑ng 8.x
Tests and VM image
I run my own little implementation of automation consisting of ansible and virtual machines to test
the installation on a regular basis with different operating systems. Test results are visible in badges
on top of this readme.
VM image is also built totally by me and distributed from webservers i maintain.
Contributing
Pullrequestsandissues(eitherrealissuesorjustsuggestions)aremorethanwelcome. Notethatido
not wish to make any modifications to Xen Orchestra source code as part of this script.
Support
If you find this project useful and want to support the development by covering some of the hosting
coststhatcomefrommaintaininganXCP‑ngserverinadatacenter,usepaypaldonationlinkbelow.
6

| 1 sudo bash -c "$(curl -s https://raw.githubusercontent.com/ronivay/   |
|:-----------------------------------------------------------------------|
| XenOrchestraInstallerUpdater/master/xo-vm-import.sh)"                  |