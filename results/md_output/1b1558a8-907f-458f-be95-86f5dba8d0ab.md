EXISTENCE IN MULTIDIMENSIONAL SCREENING WITH GENERAL
NONLINEAR PREFERENCES
KELVIN SHUANGJIAN ZHANG†
Abstract.
We generalize the approach of Carlier (2001) and provide an existence proof for the mul-
tidimensional screening problem with general nonlinear preferences. We first formulate the principal’s
problem as a maximization problem with G-convexity constraints and then use G-convex analysis to
prove existence.
8102 ceD 8  ]ME.noce[  2v94580.0171:viXra
Keywords: Principal-agent problem; Adverseselection; Bi-level optimization; Incentive-compatibility;
Non-quasilinearity
Introduction
1.
This paper provides a general existence for a multidimensional nonlinear pricing model, which is a
natural extension of the models studied by Mussa-Rosen [20], Spence [28, 29], Myerson [21], Baron-
Myerson [3], Maskin-Riley [15], Wilson [31], Rochet-Chon´e [24], Monteiro-Page [19] and Carlier [5]. A
significant distinction lies in whether the agents’ private type is one-dimensional (such as [20, 15]), or
multidimensional (such as [24, 19, 5]). Another distinction is whether preferences are quasilinear on
price (such as [1, 5]) or fully nonlinear (such as [22, 17]), especially for multidimensional models.
This paper proves the existence of a (price menu) solution to a multidimensional multiproduct
monopolist problem, by extending Carlier [5] to fully nonlinear preferences. G-convex analysis, which
is strongly tied to Trudinger’s theory on the regularity of nonlinear PDEs [30] developed for vastly
different purposes, is employed to deal with the difficulty of non-quasilinear preferences. This method
is potentially applicable to other problems under the same principal-agent framework, such as the
study of tax policy ([18]) and other regulatory policies ([3]).
Consider the problem for a multiproduct monopolist (the principal) who sells indivisible products to
a population of consumers (agents), who each buy at most one unit. Assume the monopolist is able to
produce enough of each product such that there are neither product supply shortages nor economies
of scale. Taking into account participation constraints and incentive compatibility, the monopolist
would like to find the optimal menu of prices to maximize her total profit.
In this paper, we first identify incentive compatibility with a G-convexity constraint, before rewrit-
ing the maximization problem by converting the optimization variables from a product-price pair of
mappings to a product-value pair. It can then be shown that the product-value pair converges under
the G-convexity constraint. The existence result follows.
∗ This paper is based on Chapter 3 of the author’s thesis [32]. The author would like to express his deepest gratitude
to his Ph.D. advisor Robert J. McCann for leading him to this project, and for his guidance and inspiration throughout.
The author is grateful to Xianwen Shi, Alfred Galichon, Guillaume Carlier and Ivar Ekeland for stimulating conversations
and encouragement, as well as to Georg N¨oldeke and Larry Samuelson for sharing their work in preprint form and vital
remarks. This project was initiated during the Fall of 2013 when the author was in residence at the Mathematical Sciences
Research Institute in Berkeley CA, under a program supported by National Science Foundation Grant No. 0932078 000,
and progressed during the Fall 2014 program of the Fields Institute for the Mathematical Sciences. (cid:13)c December 11,
2018.
†Department of Mathematics, University of Toronto, Toronto, Ontario, Canada, M5S 2E4 szhang@math.toronto.edu.
1

Starting from Mirrlees [18] and Spence [28], there are two main types of generalizations. One gener-
alization is regarding dimension, from one-dimensional to multi-dimensional. The other generalization
is in the form of utility functions, to beyond quasilinear.
For the quasilinear case, where the utility function depends linearly on price, theories of existence
[4, 25, 5, 19], uniqueness [6, 11, 20, 24] and robustness [4, 11] have been well studied, among which
the equivalence of function space convexity to the non-negative cross-curvature condition revealed by
Figalli-Kim-McCann [11] serves as a major milestone orienting our work.
When parameterization of preferences is linear in agent types and price, Rochet and Chon´e (1998,
[24]) not only obtain existence results but also partially characterize optimal solutions and expound
their economic interpretations, given that the monopolist profit can be characterized by the aggregate
difference between selling prices and quadratic manufacturing costs.
More generally, Carlier [5] has proved existence results for general quasilinear utilities, where agent
type and product type are not necessarily of the same dimension and the monopolist profit equals
selling price minus some linear manufacturing cost.
This paper generalizes the quasilinear case to the non-quasilinear case, which has many potential
applications. For example, some fully nonlinear utilities include scenarios where agents are more
sensitive to higher prices and where different agents might have different sensitivities to the same
price. See Wilson [31, Chapter 7] for the importance of taking income effects into account. The
generalized existence problem also appears as a conjecture by Basov [4, Chapter 8]. However, only a
few results are known for the multidimensional non-quasilinear case, and the impact of price on utility
could be much more complicated.
Recently, N¨oldeke-Samuelson [22] provided a general existence result assuming that the agent
and product space are compact, by implementing a duality argument based on Galois connections.
McCann-Zhang [17] not only showed a general existence result assuming the single-crossing type con-
dition and boundedness of the agent-type and product-type spaces, but generalized uniqueness and
convexity results of Figalli-Kim-McCann [11] to the non-quasilinear case, by using G-convexity argu-
ments. In this paper, we also explore existence using G-convex analysis, which will be introduced in
Subsection 2.1, but with less restriction on boundedness of the product domain and without assuming
the generalized single-crossing condition [16]. As a result of the lack of natural compactness, the proof
of the existence result in this paper is entirely different from that in either of the earlier papers. It
should be mentioned here that the existence results from this paper and the earlier two require no
restrictions on the monopolist profit to take on a particular form, which is a generalization from much
of the literature.
The remainder of this paper is organized as follows. Section 2 states the mathematical model and
assumptions. It also introduces preliminaries, including G-convexity and G-subdifferentiability, and
reformulates the monopolist’s problem. In Section 3, we state the existence theorem (Theorem 3.1)
as well as the convergence results for sequences of G-convex functions (Proposition 3.3). Section 4
proposes some directions for future work. We leave all the proofs of lemmas, propositions and the
existence theorem in Section 5.
Model
2.
Our model of the principal-agent problem is a bilevel optimization. After a monopolist publishes her
price menu, each agent maximizes his utility through the purchase of at most one product. Knowing
only the distribution of agent types, the monopolist maximizes aggregate profit based on agents’
choices, which are based on the price menus.
Suppose the agents’ preferences are given by some parametrized utility function G(x,y,z), where
x is an M-dimensional vector of agent characteristics, y is an N-dimensional vector of attributes of
2

each product, and z represents the price of each product. Denote by X the space of agent types, by
Y the space of products, by cl(Y ) the closure of Y , by Z the space of prices, and by cl(Z) the closure
of Z. In this paper, we only consider the case where both agent types and product attributes are
continuous.
The monopolist sells indivisible products to agents, i.e., she will sell neither a part/percentage of
one product nor a product with some probability. Each agent buys at most one unit of product. For
any given price menu p : cl(Y ) cl(Z), an agent x X knows his utility G(x,y,p(y)) for purchasing
→ ∈
each product y at price p(y). It follows that each agent solves the following maximization problem
(2.1) u(x) := max G(x,y,p(y)),
y cl(Y)
∈
where u(x) represents the maximal utility agent x can obtain, and u : X R is also called the value
→
function or indirect utility function. At this point, it is assumed that the maximum in (2.1) is attained
for each agent x.
If agent x purchases product y at price p(y), the monopolist would earn from this transaction a
profit of π(x,y,p(y)). For example, the monopolist profit can take the form π(x,y,p(y)) = p(y) c(y),
−
where c(y) is a variable manufacturing cost function. Summing over all agents in the distribution
dµ(x), the monopolist’s total profit is characterized by
(2.2) Π(p,y) := π(x,y(x),p(y(x)))dµ(x),
X
Z
which depends on her price menu p : cl(Y ) cl(Z) and agents’ choices y : X cl(Y ).1
→ →
Remark 2.1. One can replace the constraint
(2.3) y(x) argmaxG(x.y,p(y)),
∈
y cl(Y)
∈
which is derived from equation (2.1), by the incentive compatibility defined below, which are equivalent
in the following sense: (1) all product-price pair satisfying (2.3) is incentive compatible; (2) for any
incentive compatible product-price pair, there exists an (equivalent) incentive compatible product-price
pair which has the same value under the functional Π and satisfies (2.3).
Definition 2.2 (Incentive compatibility). A (product, price) pair of measurable mappings (y,z) : X
→
cl(Y ) cl(Z) on agent space X is incentive compatible if and only if G(x,y(x),z(x)) G(x,y(x ),z(x ))
′ ′
× ≥
for all (x,x ) X2.
′
∈
An incentive-compatible product-price pair (y,p(y)) ensures that no agent has the incentive to
pretend to be another agent type.
1 Y˜
It is worth mentioning that in some literature, the monopolist’s objective is to design a product line (i.e., a subset of
cl(Y )) and a price menu p˜: Y˜ → R that jointly maximize the overall monopolist profit. Then, given Y˜ and p˜, an agent
of type x chooses the product y(x) that solves
maxG(x,y,p˜(y)) := u(x).
˜
y∈Y
Allowing the price to take value z¯ (which may be +∞), and assuming Assumption 1 below, the effect of designing a
product line Y˜ and price menu p˜: Y˜ → R is equivalent to that of designing a price menu p : cl(Y ) → (−∞,+∞], which
equals p˜ on Y˜ and maps cl(Y )\Y˜ to z¯, such that no agents choose to purchase any product from cl(Y)\Y˜ , which is less
attractive than the outside option y according to Assumption 1. In this paper, we use the latter as the monopolist’s
∅
objective.
For any given price menu p : cl(Y ) → (−∞,+∞], one can construct a mapping y : X → cl(Y ) such that each y(x)
solves the maximization problem in (2.1). But such mapping is not necessarily unique, without the single-crossing type
assumptions. Therefore, we adopt in (2.2) the total profit as a functional of both price menu p and its corresponding
mapping y.
3

In addition, we adopt a participation constraint in order to rule out the possibility of the monopolist
charging exorbitant prices and the agents still having to make transactions despite this: each agent
x X will refuse to participate to the market if the maximum utility he can obtain is less than his
∈
reservation value u (x), where the function u : X R is given in the form u (x) := G(x,y ,z ) for
→
∅ ∅ ∅ ∅ ∅
some (y ,z ) cl(Y Z), where y represents the outside option, whose price equals to some fixed
∈ ×
∅ ∅ ∅
value z R beyond the monopolist’s control.
∈
∅
For the monopolist profit, some literature assumes π(x,y ,z ) 0 for all x X to ensure that the
≥ ∈
∅ ∅
outside option is harmless to the monopolist. Here, it is not necessary to adopt such an assumption
for the sake of generality.
The monopolist’s problem can be described as follows:
supΠ(p,y) = π(x,y(x),p(y(x))) dµ(x)
X
s.t.

R

(2.4) (P )(y,p(y)) is incentive compatible ;
0 


 G(x,y(x),p(y(x))) u (x) for all x X;
≥ ∈
∅
p is lower semicontinuous.




We assume that p is lower semicontinuous, without which the maximum in (2.1) may not be attained.


We also rewrite the monopolist’s problem in Proposition 2.11, which is an equivalent form of (2.4).
The purpose of the following subsections is to fix terminology and prepare the preliminaries for the
main results in the next section. The proofs can be found in Section 5.
2.1. G-Convex and G-Subdifferentiability. In this subsection, we introduce some tools from con-
vex analysis and the notion of G-convexity (c.f. [30, 2, 27]), which is a generalization of ordinary
convexity. Several results in this subsection echo those from Section 3 of McCann-Zhang [17] but
extend to unbounded domains.
The following assumptions are made to the agents’ direct utility G. We use C0(X) to denote the
space of all continuous functions on X and use C1(X) to denote the space of all differentiable functions
on X whose derivatives are continuous.
Assumption 1. Agents’ utility G C1(cl(X Y Z)), where the space of agents X is a bounded
∈ × ×
open convex subset in RM with C1 boundary, the space of products Y RN , and range of prices
⊂
Z = (z,z¯) with < z < z¯ + . Assume G(x,y,z¯) := lim G(x,y,z) G(x,y ,z ) for all
z z¯
−∞ ≤ ∞ → ≤ ∅ ∅
(x,y) X cl(Y ); and assume this inequality is strict when z¯ = + .
∈ × ∞
Here we do not necessarily assume X, Y , and Z are compact spaces; in particular, Y and Z are
potentially unbounded (i.e., we do not set a priori bounds for product attributes or an a priori upper
bound for prices). However, we do specify a lower bound for the price range, since the monopolist has
no incentive to set price close to negative infinity. The last inequality shows the highest price z¯ is less
preferred than the outside option.
Assumption 2. G(x,y,z) is strictly decreasing with respect to z for each (x,y) cl(X Y ).
∈ ×
This is to say that, for any given product, the higher the price paid to the monopolist, the lower
the utility that will be left for the agent. For each (x,y) X cl(Y ) and u G(x,y,cl(Z)), define
∈ × ∈
H(x,y,u) := z whenever G(x,y,z) = u, i.e., H(x,y, ) = G 1(x,y, ). Therefore, H(x,y,u) represents
−
· ·
the price paid by agent x for product y when receiving value u.
Proposition 2.3 shows that the inverse function of G is also continuous because G is continuous and
monotonic on the price variable.
4

Proposition 2.3. Given Assumption 1 and Assumption 2, the function H is continuous.
Recall that the subdifferential of a function u at x is defined as the set:
0
∂u(x ) = y cl(Y ) u(x) u(x ) x x ,y for all x X .
0 0 0
{ ∈ | − ≥ h − i ∈ }
Here we use , to denote the Euclidean inner product. This set is nonempty for every x if and
0
h i
only if u is convex. Then for any convex function u on X and any fixed point x X, there exists
0
∈
y ∂u(x ), satisfying
0 0
∈
(2.5) u(x) x,y ( x ,y u(x )) for all x X,
0 0 0 0
≥ h i − h i − ∈
where equality holds at x = x . On the other hand, if for any x X, there exists y such that (2.5)
0 0 0
∈
holds for all x X, then u is convex. The following definition is analogous to this property, which is
∈
a special case of G-convexity, when G(x,y,z) = x,y z.
h i −
Definition 2.4 (G-convexity). A function u C0(X) is called G-convex if for each x X, there
0
∈ ∈
exist y cl(Y ) and z cl(Z) such that u(x ) = G(x ,y ,z ) and u(x) G(x,y ,z ) for all x X.
0 0 0 0 0 0 0 0
∈ ∈ ≥ ∈
Similarly, one can also generalize the definition of subdifferential from (2.5).
Definition 2.5 (G-subdifferentiability). The G-subdifferential of a function u : X R is a point-to-
→
set mapping defined by
G
∂ u(x) := y cl(Y ) H(x,y,u(x)) is defined and u(x ) G(x ,y,H(x,y,u(x))) for all x X .
′ ′ ′
∈ | ≥ ∈
A function u(cid:8)is said to be G-subdifferentiable at x if and only if ∂Gu(x) = .2 (cid:9)
6 ∅
In particular, if G(x,y,z) = x,y z, then the G-subdifferential coincides with the subdifferential.
h i−
There are other generalizations of convexity and subdifferentiability. For instance, h-convexity in
Carlier [5], or equivalently, b-convexity in Figalli-Kim-McCann [11], or c-convexity in Gangbo-McCann
[12], is a special form of G-convexity, where G(x,y,z) = h(x,y) z, which plays an important role in
−
the quasilinear case. For more references of convexity generalizations, see Kutateladze-Rubinov [13],
Elster-Nehse [9], Balder [2], Dolecki-Kurcyusz [7], Singer [27], Rubinov [26], and Mart´ınez-Legaz [14].
As mentioned above, a well-known result in convex analysis is that a function is convex if and only
if it is subdifferentiable everywhere. The following lemma adapts this to G-convexity.
Lemma 2.6. Given Assumption 2, a function u : X R is G-convex if and only if it is G-
→
subdifferentiable everywhere.
Using Lemma 2.6, one can show the following result, which connects incentive compatibility in the
economic context with G-convexity and G-subdifferentiability in mathematical analysis, generalizing
the results of Rochet [23] and Carlier [5].
Lemma 2.7 (G-convex utilities characterize incentive compatibility). Let (y,z) be a pair of mappings
from X to cl(Y ) cl(Z). Given Assumption 2, this (product, price) pair is incentive compatible if and
×
only if u( ) := G( ,y( ),z( )) is G-convex and y(x) ∂Gu(x) for each x X.
· · · · ∈ ∈
2.2. Implementability. We introduce implementability here, which is closely related to incentive-
compatibility and can also be exhibited by G-convexity and G-subdifferential.
Definition 2.8 (Implementability). A function y : X cl(Y ) is called implementable if and only if
→
there exists a function z : X R such that the pair (y,z) is incentive compatible.
→
Remark 2.9. Allowing Assumption 2, a function y is implementable if and only if there exists a price
menu p : cl(Y ) R such that the pair (y,p(y)) is incentive compatible.
→
2 In Trudinger [30], this point-to-set mapping ∂Gu is also called G-normal mapping; see this paper for more properties
related to G-convexity.
5

As a corollary of Lemma 2.7, implementable functions can be characterized as G-subdifferential of
G-convex functions.
Corollary 2.10 (G-convex utilities characterize implementability). Given Assumption 2, a function
y : X cl(Y ) is implementable if and only if there exists a G-convex function u( ) such that y(x)
→ · ∈
∂Gu(x) for each x X.
∈
When parameterization of preferences is linear in agent types and price, Corollary 2.10 says that a
function is implementable if and only if it is monotone increasing. In general quasilinear cases, this
coincides with Proposition 1 of Carlier [5].
2.3. Reformulation of the Monopolist’s Problem. From the original monopolist’s problem (2.4),
we replace product-price pair (p,y) by the value-product pair (u,y), using u( ) = G( ,y( ),p(y( ))).
· · · ·
Combining this with Lemma 2.7, the incentive-compatibility constraint (y,p(y)) is equivalent to G-
convexity of u( ) and y(x) ∂Gu(x) for all x X. Therefore, one can rewrite the monopolist’s
· ∈ ∈
problem as follows.
Proposition 2.11 (Reformulation of the monopolist’s problem). Given Assumptions 1 and 2, the
monopolist’s problem (P ) is equivalent to
0
˜
supΠ(u,y) := π(x,y(x),H(x,y(x),u(x)))dµ(x)
X
s.t.
(P) R
(2.6)
u is G-convex ;



y(x) ∂Gu(x) and u(x) u (x) for all x X.
∈ ≥ ∈
∅




2.4. Other Assumptions. In the next section, we will show the existence result of the rewritten
monopolist’s problem (P) given in (2.6). For the preparation of the main result, we introduce the
following assumptions. Note that, even in the one-dimensional case, we assume no single-crossing type
condition. We also include two propositions here, which will be employed in the proofs of Proposition
3.3 and the existence theorem.
Assumption 3. G is coordinate-monotone in x. That is, for each (y,z) cl(Y Z) and all (α,β)
∈ × ∈
X2, if α β for all i = 1,2,...,M, then G(α,y,z) G(β,y,z).
i i
≥ ≥
In Assumption 3, we assume that agent utility increases along each agent attribute coordinate.
Given coordinate monotonicity of G in the first variable, one can show that all the G-convex func-
tions are nondecreasing. Therefore, the value functions are also monotonic with respect to the agent
attributes.
Proposition 2.12. Given Assumption 3, G-convex functions are nondecreasing in coordinates.
∂G ∂G ∂G
In the following, we use D G(x,y,z) := , ,... , (x,y,z) to denote derivative with re-
x
∂x1 ∂x2 ∂x
M
spect to x. For any vector in RM or RN (cid:16), we use and(cid:17) to denote its Euclidean 2-norm
α
k·k k·k
and α-norm (α 1), respectively. For example, for x RM , we have x = M x2 and
i=1 i
≥ ∈ k k
1
q
x = M x α α . We say a function f : X Y Z R is asymptoticallPy decreasing
α i=1 i
k k | | × × →
super-line(cid:16) aPrly (respec(cid:17) tively, linearly) with respect to the variable y Y if and only if f(x,y,z)
∈ y →
k k
(respectively, C(x,z)) as y + , where C(x,z) is a negative variable depending only on x
−∞ k k → ∞
f(y)
and z. We say a function f : Y R is asymptotically super-linear if and only if + as
→ y → ∞
k k
y + .
k k → ∞
6

In Rochet-Chon´e’s model, H(x,y,u) = x y u and π(x,y,z) = z c(y) with a quadratic cost
· − −
function c. In this case, π(x,y,H(x,y,u)) = x y u c(y). Since c is asymptotically super-linear
· − −
and the space X is bounded, it is reasonable to assume the following:
Assumption 4. π(x,y,H(x,y,u)) is asymptotically decreasing (super-)linearly with respect to y
and asymptotically decreasing at least linearly with respect to u. More precisely, there exist α
≥
α
1, a ,a > 0, and b R such that π(x,y,H(x,y,u)) a y a u + b for all (x,y,u)
1 2 1 α 2
∈ ≤ − k k − ∈
α
(x,y,G(x,y,z)) x X,y cl(Y ),z R ; or equivalently, π(x,y,z) + a G(x,y,z) a y + b
2 1 α
{ | ∈ ∈ ∈ } ≤ − k k
for all (x,y,z) X cl(Y ) R.
∈ × ×
As shown in the alternative formulation, Assumption 4 requires the existence of some weighted
surplus which is asymptotically decreasing super-linearly with respect to the product (when α > 1).
In the case where Y is bounded, Assumption 4 is equivalent to the existence of some weighted surplus
bounded from above.
Assumptions 5 - 7 are some technical assumptions on D G, which are automatically satisfied for
x
X, Y , and Z being bounded.
Assumption 5. D G(x,y,z) is Lipschitz with respect to x, uniformly in (y,z), meaning there exists
x
k R such that D G(x,y,z) D G(x ,y,z) k x x for all (x,x ,y,z) X2 cl(Y ) cl(Z).
x x ′ ′ ′
∈ k − k ≤ k − k ∈ × ×
β
Assumption 6. There exist β (0,α], c > 0, and d R such that D G(x,y,z) c y + d for
x 1 β
∈ ∈ k k ≤ k k
all (x,y,z) X cl(Y ) cl(Z).
∈ × ×
Assumption 7. Coercivity of 1-norm of (D G). For all s > 0, there exists r > 0 such that
x
M
D G(x,y,z) s for all (x,y,z) X cl(Y ) cl(Z), whenever y r.
i=1 | x i | ≥ ∈ × × k k ≥
PAllowing Assumption 3, the derivatives D G are always nonnegative; therefore, we no longer
x
i
need to take absolute values of D G in the inequality of Assumption 7. Then Assumption 7 says
x
i
that the marginal utility of agents who select the same product y will increase to infinity as y
k k
approaches infinity, uniformly for all agents and prices. For instance, when M = N, utility G(x,y,z) =
M x y2 f(y,z), with f C1(Y Z) strictly increasing with respect to z, satisfies Assumption 7,
i=1 i i
− ∈ ×
because
P
M M M
D G(x,y,z) = D G(x,y,z) = y2 +
| x i | x i i → ∞
i=1 i=1 i=1
X X X
as y + . In addition, with appropriate π, this G could satisfy all the other assumptions. For
k k → ∞
instance, if we take z¯ = + , then profit π(x,y,z) = z M y4 and agents’ utility G(x,y,z) =
i=1 i
∞ −
M x y2 z2 together satisfy Assumption 1 - 8.
i=1 i i − P
PIn general, if Y is bounded, any G in the form of G(x,y,z) = b(x,y) f(y,z), with b C1(cl(X Y ))
− ∈ ×
and f C0(cl(Y Z)), satisfies Assumption 5 - 7. This class of separable utility functions for the
∈ ×
agent are also considered in N¨oldeke-Samuelson [22], where they serve as the prime example for utility
functions that are not necessarily quasilinear but yield strong implementability.
Proposition 2.13 presents that uniform boundedness of the agents’ value functions on some compact
subset implies uniform boundedness of the corresponding agents’ choices of their favorite products.
Proposition 2.13 (Uniform boundedness of G-convex functions on a compact set implies that of
G-subdifferentials). Given Assumptions 1, 2, 3, 7, and let u( ) be a G-convex function on X, ω be a
·
compact subset of X, δ > 0,R > 0, satisfying ω+δB(0,1) X and u(x) R for all x ω+δB(0,1)
⊂ | | ≤ ∈
(here, B(0,1) denotes the closed unit ball of RM ). Then, there exists T = T(ω,δ,R) > 0 such that
y T for any x ω and any y ∂Gu(x).
k k ≤ ∈ ∈
7

Assumptions 8 states constraints on continuity of the principal’s profit function π, integrability of
participation constraint u . From now on, we assume µ to be equivalent to the Lebesgue measure.
∅
One might seek to extend the corresponding results to more general settings, e.g., assuming µ to be
absolutely continuous with respect to the Lebesgue measure.
Assumption 8. The profit function π is continuous on cl(X Y Z). The participation constraint
× ×
u is integrable with respect to dµ, where the measure µ is equivalent to the Lebesgue measure restricted
∅
on X.
For α 1, denote Lα (X) as the space of measurable functions for which the α-th power of the
≥
absolute value is Lebesgue integrable on X. That is, a function f : X R is in Lα (X) if and only if
→
1
α
α
f := f(x) dx < + ,
Lα(X)
k k | | ∞
X
(cid:18)Z (cid:19)
where f is the associated Lα norm of f on X. For instance, Assumption 8 implies u L1(X).
Lα(X)
k k ∈
∅
For any function f on X, its essential supremum is defined as:
(2.7) f := inf C 0 : f(x) C for Lebesgue almost every x X .
L∞(X)
k k { ≥ | | ≤ ∈ }
Denote by L (X) the space of measurable functions on X whose essential supremum is finite. Also,
∞
denote by L (X) the space of measurable functions on X which belong to L (K) for all compact
∞loc ∞
subsets K of X.
Main result
3.
In this section, we state the existence theorem, the proof of which is provided in Section 5.
Theorem 3.1 (Existence). Under Assumptions 1 - 8, the monopolist’s problem (P) admits at least
one solution.
Technically, in order to demonstrate existence, we start from a sequence of value-product pairs,
whose total profits have a limit that is equal to the supremum of (P). Then we need to show that
this sequence converges, up to a subsequence, to a pair of limit mappings. Then we show this limit
value-product pair satisfies the constraints of (P), and its corresponding total payoff is no worse than
those of any other admissible pairs.
Suppose the space of products Y is bounded, then Assumption 4 - 7 could be simplified, and
Proposition 2.13 holds automatically. Besides, some steps in the proof of the main theorem would be
simplified. If, in addition, both spaces Y and Z are bounded, Assumption 4 - 7 are automatically
satisfied and the proofs will be much simpler.
In the following, we denote by W1,1(X) the Sobolev space of L1 functions whose first derivatives
exist in the weak sense and belong to L1(X). For any function f : X R, define its W1,1(X) norm
→
as
M
f = f + D f .
k kW1,1 (X) k kL1 (X) k x i kL1 (X)
i=1
X
For more properties of Sobolev spaces and weak derivatives, see Evans [10, Chapter 5]. If ω is some
open subset of X, the notation ω X means that the closure of ω is also included in X.
⊂⊂
Lemma 3.2 provides convergence results for sequences of convex functions, which are uniformly
bounded in Sobolev spaces on open convex subsets. We state this classical result without proof, which
can be found in Carlier [5].
8

Lemma 3.2. Let u n n N be a sequence of convex functions on X such that for every open convex
{ } ∈
set ω X, the following holds:
⊂⊂
sup u < + .
n W1,1 (ω)
k k ∞
n
Then there exists a function u which is convex in X, a measurable subset A of X and a subsequence
∗
again labeled u n n N such that
{ } ∈
1. u n n N converges to u ∗ uniformly on compact subsets of X;
{ } ∈
2. Du n n N converges to Du ∗ pointwise in A and dim H(X A) M 1, where dim H(X A) is the
{ } ∈ \ ≤ − \
Hausdorff dimension of X A.
\
We extend the above convergence result to G-convex functions in the following proposition, which
is required in the proof of the existence theorem, as it extracts a limit function from a converging
sequence of value functions.
Proposition 3.3. Assume Assumptions 1, 2, 3, 5, 7, and let u n n N be a sequence of G-convex
{ } ∈
functions on X such that for every open convex set ω X, the following holds:
⊂⊂
sup u < + .
n W1,1 (ω)
k k ∞
n
Then there exists a function u which is G-convex in X, a measurable subset A of X, and a subsequence
∗
again labeled u n n N such that
{ } ∈
1. u n n N converges to u ∗ uniformly on compact subsets of X;
{ } ∈
2. Du n n N converges to Du ∗ pointwise in A and dim H(X A) M 1.
{ } ∈ \ ≤ −
In the proof of Proposition 3.3, we show that the sequence of G-convex functions is convergent by
applying results from Lemma 3.2, then prove that the limit function is also G-convex.
Future Work
4.
We have strong interest in giving an explicit solution for the non-quasilinear example on the real
line and in high dimension. We also would like to investigate, among other things, the conditions
under which the matching map y : X cl(Y ) is continuous and/or differentiable. Given the technical
→
arguments employed in this paper, it may be very fruitful to study possible generalizations of other
known results for convex functions to G-convex functions.
Proofs
5.
Proof of Proposition 2.3. (Proof by contradiction). Suppose H is not continuous, then there exists a
sequence (x n,y n,z n) n N cl(X Y Z) converging to (x,y,z) and ε > 0 such that
{ } ∈ ⊂ × ×
H(x ,y ,z ) H(x,y,z) > ε for all n N.
n n n
| − | ∈
Without loss of generality, we assume H(x ,y ,z ) H(x,y,z) > ε for all n N. Therefore, we have
n n n
− ∈
H(x ,y ,z ) > H(x,y,z) + ε. By Assumption 2, this implies
n n n
z < G(x ,y ,H(x,y,z) + ε) for all n N.
n n n
∈
Taking limit n at both sides, since G is continuous from Assumption 1, we have
→ ∞
z G(x,y,H(x,y,z) + ε).
≤
(cid:3)
This implies H(x,y,z) H(x,y,z) + ε, a contradiction.
≥
9

Proof of Lemma 2.6. Assume u is G-convex, we want to show that u is G-subdifferentiable everywhere,
i.e., we need to prove ∂Gu(x ) = for all x X.
0 0
6 ∅ ∈
Since u is G-convex, by definition, for each x , there exists y ,z such that u(x ) = G(x ,y ,z )
0 0 0 0 0 0 0
and
u(x) G(x,y ,z ) = G(x,y ,H(x ,y ,u(x ))) for all x X.
0 0 0 0 0 0
≥ ∈
By the definition of G-subdifferentiability, y ∂Gu(x ), i.e., ∂Gu(x ) = .
0 0 0
∈ 6 ∅
On the other hand, assume u is G-subdifferentiable everywhere, then for each x X, there exists
0
∈
y ∂Gu(x ). Set z := H(x ,y ,u(x )) so that u(x ) = G(x ,y ,z ).
0 0 0 0 0 0 0 0 0 0
∈
Since y ∂Gu(x ), we have
0 0
∈
u(x) G(x,y ,H(x ,y ,u(x ))) = G(x,y ,z ) for all x X .
0 0 0 0 0 0
≥ ∈
(cid:3)
By definition, u is G-convex.
Proof of Lemma 2.7. “ ”. Suppose (y,z) is incentive compatible. For any fixed x X, let
0
⇒ ∈
y = y(x ) and z = z(x ). Then
0 0 0 0
u(x ) = G(x ,y(x ),z(x )) = G(x ,y ,z ).
0 0 0 0 0 0 0
By incentive compatibility of the contract (y,z), one has
G(x,y(x),z(x)) G(x,y(x ),z(x )) for any x X.
0 0
≥ ∈
This implies u(x) G(x,y ,z ) for any x X, because u(x) = G(x,y(x),z(x)), y = y(x ), and
0 0 0 0
≥ ∈
z = z(x ). By definition, u is G-convex.
0 0
Since u(x ) = G(x ,y ,z ), by definition of function H one has z = H(x ,y ,u(x )). Combining
0 0 0 0 0 0 0 0
with u(x) G(x,y ,z ) for any x X, which is concluded from above, we have
0 0
≥ ∈
u(x) G(x,y ,H(x ,y ,u(x ))) for any x X.
0 0 0 0
≥ ∈
By definition of G-subdifferentiability, one has y ∂Gu(x ). Therefore, y(x ) = y ∂Gu(x ).
0 0 0 0 0
∈ ∈
“ ”. Assume that u = G(x,y(x),z(x)) is G-convex and y(x) ∂Gu(x) for any x X. For any
⇐ ∈ ∈
fixed x X, since y(x) ∂Gu(x), one has
∈ ∈
(5.1) u(x ) G(x ,y(x),H(x,y(x),u(x))) for any x X.
′ ′ ′
≥ ∈
Since u(x) = G(x,y(x),z(x)), by definition of function H, one has z(x) = H(x,y(x),u(x)). Com-
bined with the inequality (5.1), we have
u(x ) G(x ,y(x),z(x)) for any x X.
′ ′ ′
≥ ∈
Notice u(x ) = G(x ,y(x ), z(x )). Thus,
′ ′ ′ ′
G(x ,y(x ),z(x )) = u(x ) G(x ,y(x),z(x)) for any x,x X.
′ ′ ′ ′ ′ ′
≥ ∈
(cid:3)
By definition, (y,z) is incentive compatible.
Proof of Remark 2.9. One direction is easier: given p and y, define z( ) := p(y( )). Then the conclusion
· ·
follows directly.
Given an incentive-compatible pair (y,z) : X cl(Y ) R, we need to construct a price menu
→ ×
p : cl(Y ) R. If y = y(x) for some x X, define p(y) := z(x); for any other y cl(Y ), define
→ ∈ ∈
p(y) := z¯.
We first show p is well-defined. Suppose y(x) = y(x ) with x = x , from incentive compatibility of
′ ′
6
(p,y), we have
G(x,y(x),z(x)) G(x,y(x ),z(x )) = G(x,y(x),z(x )).
′ ′ ′
≥
Since G is strictly decreasing with respect to its third variable, the above inequality implies z(x)
≤
z(x ). Similarly, one has z(x) z(x ). Therefore, z(x) = z(x ) and thus p is well-defined.
′ ′ ′
≥
10

(cid:3)
The incentive compatibility of (y,p(y)) follows from that of (y,z) and definition of p.
Proof of Corollary 2.10. One direction is immediately derived from the definition of implementability
and Lemma 2.7.
Suppose there exists some convex function u such that y(x) ∂Gu(x) for each x X. Define
∈ ∈
z( ) := H( ,y( ),u( )), then u(x) = G(x,y(x),z(x)). Lemma 2.7 implies (y,z) is incentive compatible,
· · · ·
(cid:3)
and thus y is implementable.
Proof of Proposition 2.11. We need to prove both directions for equivalence of (P ) and (P).
0
1. For any incentive-compatible pair (y,p(y)), define u( ) := G( ,y( ),p(y( ))). Then by Lemma
· · · ·
2.7, we have u( ) is G-convex and y(x) ∂Gu(x) for all x X. From the participation constraint,
· ∈ ∈
G(x,y(x),p(y(x))) u (x) for all x X.
≥ ∈
∅
This implies u(x) u (x) for all x X. Besides, two integrands are equal: π(x,y(x),p(y(x))) =
≥ ∈
∅
π(x,y(x),H(x,y(x),u(x))). Therefore, (P ) (P).
0
≤
2. On the other hand, assume u( ) is G-convex, y(x) ∂Gu(x) and u(x) u (x) for all x X.
· ∈ ≥ ∈
∅
From Corollary 2.10 and Remark 2.9, we know y is implementable and there exists a price menu
p : cl(Y ) R such that the pair (y,p(y)) is incentive compatible, where
→
H(x,y(x),u(x)) if y = y(x) y(X) := y(x) cl(Y ) x X ;
p(y) = ∈ { ∈ | ∈ }
z¯ otherwise.
(
Firstly, the mapping p is well-defined, using the same argument as that in Remark 2.9.
Secondly, the participation constraint holds since
G(x,y(x),p(y(x))) = u(x) u (x) for all x X.
≥ ∈
∅
Thirdly, let us show this price menu p is lower semicontinuous. Let p˜ be the restriction of p to y(X).
Suppose that y n n N y(X) converges y 0 y(X) with y n = y(x n) and y 0 = y(x 0), satisfying
{ } ∈ ⊂ ∈
lim p˜(y ) = liminf p˜(y).
n
n y y0
→∞ →
Let z := p˜(y ) and z := lim z . To prove lower semicontinuity of p˜, we need to show p˜(y ) z .
n n n 0
∞ n ≤ ∞
Since y ∂Gu(x ), we have→∞
n n
∈
u(x) G(x,y ,H(x ,y ,u(x ))) = G(x,y ,z ).
n n n n n n
≥
Taking n , this implies u(x) G(x,y ,z ). Therefore,
0
→ ∞ ≥ ∞
G(x ,y ,p˜(y )) = u(x ) G(x ,y ,z ).
0 0 0 0 0 0
≥ ∞
By Assumption 2, we know p˜(y ) z . Thus p˜ is lower semicontinuous. Since p is an extension of p˜
0
≤ ∞
from y(X) to cl(Y ) as its lower semicontinuous hull, satisfying v(y) = z¯ for all y cl(Y ) y(X), we
∈ \
know p is also lower semicontinuous.
Lastly, two integrands are equal: π(x,y(x),p(y(x))) = π(x,y(x),H(x,y(x),u(x))). Therefore,
(cid:3)
(P ) (P).
0
≥
Proof of Proposition 2.12. Let u be any G-convex function, and let α, β be any two agent types in X
with α β. By G-convexity of u, for this β, there exist y cl(Y ) and z cl(Z) such that
≥ ∈ ∈
u(β) = G(β,y,z) and u(x) G(x,y,z) for any x X.
≥ ∈
Since α β, by Assumption 3, we have G(α,y,z) G(β,y,z). Combining with u(α) G(α,y,z)
≥ ≥ ≥
(cid:3)
and u(β) = G(β,y,z), one has u(α) u(β). Thus, u is nondecreasing.
≥
11

Proof of Proposition 2.13. (Proof by contradiction).
4R√M
By Assumption 3 and Assumption 7, for s = , there exists r > 0 such that for any (x,y,z)
δ
∈
X cl(Y ) cl(Z), whenever y r, we have
× × k k ≥
M
4R√M
D G(x,y,z) .
x
i ≥ δ
i=1
X
Assume the boundedness conclusion of this proposition is not true. Then for this r, there exist
x ω and y ∂Gu(x ) such that y r. Thus,
0 0 0 0
∈ ∈ k k ≥
M
4R√M
(5.2) D G(x,y ,z) for all x X and z R.
x 0
i ≥ δ ∈ ∈
i=1
X
Since y ∂Gu(x ), by definition of the G-subdifferential, we have
0 0
∈
u(x) G(x,y ,H(x ,y ,u(x ))) for any x X.
0 0 0 0
≥ ∈
Take x = x +δx , where x := ( 1 , 1 , , 1 ) is a unit vector in RM with each coordinate
0 1 1
− − √M √M ··· √M
equal to 1 . Then
√M
(5.3) u(x + δx ) G(x + δx ,y ,H(x ,y ,u(x ))).
0 1 0 1 0 0 0 0
− ≥ −
For any x ω + δB(0,1), from conditions in the proposition, we have u(x) R. Therefore,
∈ | | ≤
2R u(x + δx ) + u(x )
0 1 0
≥ | − | | |
u(x + δx ) u(x ) (By the triangle inequality)
0 1 0
≥ | − − |
u(x + δx ) u(x )
0 1 0
≥ − −
G(x + δx ,y ,H(x ,y ,u(x ))) (By inequality (5.3)) and (by definition
0 1 0 0 0 0
≥ −
G(x ,y ,H(x ,y ,u(x ))) of H, u(x ) = G(x ,y ,H(x ,y ,u(x )))
0 0 0 0 0 0 0 0 0 0 0
−
1
= δ x ,D G(x + tδx ,y ,H(x ,y ,u(x ))) dt (By the fundamental theorem of Calculus)
1 x 0 1 0 0 0 0
h − − i
0
Z
M
δ 1
= D G(x + tδx ,y ,H(x ,y ,u(x )))dt
x 0 1 0 0 0 0
√M i
−
0
Z i=1
X
δ 1 4R√M
dt (By inequality (5.2))
≥ √M δ
0
Z
δ 4R√M
=
√M · δ
= 4R,
a contradiction. Therefore, there exists T > 0 such that for any x ω and y ∂Gu(x), one has
∈ ∈
y T. In addition, here T = T(ω,δ,R) is independent of u. In fact, from the above argument we
k k ≤
(cid:3)
can see that T r, which does not depend on u.
≤
Proof of Proposition 3.3. In this proof, we will show that, under Assumptions 1, 2, 3, 5, and 7, the
sequence of G-convex functions converges, by applying results from Lemma 3.2; then we will prove
that the limit function is also G-convex. Assume u n n N is a sequence of G-convex functions in X
{ } ∈
such that for every open convex set ω X, the following holds:
⊂⊂
sup u < + .
n W1,1 (ω)
k k ∞
n
12

Step 1: By Assumption 5, there exists k > 0 such that for any (x,x ) X2, y cl(Y ), and
′
∈ ∈
z cl(Z), one has
∈
D G(x,y,z) D G(x ,y,z) k x x .
x x ′ ′
− ≤ −
Denote G (x,y,z) := G(x,y,z) + λ x 2 , where λ 1 Lip(D G) with
λ (cid:13) (cid:13) x (cid:13) (cid:13)
(cid:13) k k ≥ 2 (cid:13) (cid:13) (cid:13)
D G(x,y,z) D G(x ,y,z)
x x ′
Lip(D G) := sup k − k.
x
x x
(x,x′,y,z) X X cl(Y) cl(Z): x=x′ ′
k − k
{ ∈ × × × 6 }
Then, for any (x,x ) X2, by Cauchy–Schwarz inequality, one has
′
∈
D G (x,y,z) D G (x ,y,z),x x
x λ x λ ′ ′
− −
2
=(cid:10) D G(x,y,z) D G(x ,y,z),x x (cid:11)+ 2λ x x (By definition of G (x,y,z))
x x ′ ′ ′ λ
− − −
2
(cid:10) D G(x,y,z) D G(x ,y,z) x(cid:11) x +(cid:13) 2λ x(cid:13) x (By Cauchy–Schwarz inequality)
x x ′ ′ ′
≥ − − − (cid:13) (cid:13)−
2
[2λ(cid:13) Lip(D G)] x x (cid:13)(cid:13) (cid:13) (cid:13) (cid:13) (By definition of Lip(D G))
x ′ x
≥ (cid:13)− − (cid:13)(cid:13) (cid:13) (cid:13) (cid:13)
0.
(cid:13) (cid:13)
≥
(cid:13) (cid:13)
Thus, G ( ,y,z) is a convex function on X for any fixed (y,z) cl(Y ) cl(Z).
λ
· ∈ ×
Step 2: Since u is G-convex, by Lemma 2.6, we know
n
u (x) = max G(x,y,H(x ,y,u (x ))).
n ′ n ′
x′ X,y ∂Gu (x′)
n
∈ ∈
2
Define v (x) := u (x) + λ x . Then
n n
k k
2
v (x) = max G(x,y,H(x ,y,u (x ))) + λ x
n ′ n ′
x′ X,y ∂Gu (x′) k k
n
∈ ∈
2
= max G(x,y,H(x ,y,u (x ))) + λ x
′ n ′
x′ X,y ∂Gu (x′) k k
n
∈ ∈ h i
= max G (x,y,H(x ,y,u (x ))).
λ ′ n ′
x′ X,y ∂Gu (x′)
n
∈ ∈
Since G ( ,y,H(x ,y,u (x ))) is convex for each (x ,y), we have v (x), as supremum of convex
λ ′ n ′ ′ n
·
functions, is also convex for each n N.
∈
2
Step 3: Since v := u + λ x and sup u < + , one has
n n n W1,1 (ω)
k k k k ∞
n
sup v < + for any ω X.
n W1,1 (ω)
k k ∞ ⊂⊂
n
Hence v n n N satisfies all the assumptions of Lemma 3.2. So, by conclusion of Lemma 3.2, there
{ } ∈
exists a convex function v in X and a measurable set A X such that dim (X A) M 1
∗ H
⊂ \ ≤ −
and up to a subsequence, v n n N converges to v ∗ uniformly on compact subset of X and Dv n n N
{ } ∈ { } ∈
converges to Dv pointwise in A.
∗
2
Let u ∗(x) := v ∗(x) λ x , then u n n N converges to u ∗ uniformly on compact subset of X and
− k k { } ∈
Du n n N converges to Du ∗ pointwise in A.
{ } ∈
Step 4: Finally, let us prove that u is G-convex.
∗
Define Γ(x) := ∂Gu (x) for all x X.
i 1 n i n
∩ ≥ ∪ ≥ ∈
Claim. For any x X, we have Γ(x ) = .
′ ′
∈ 6 ∅
Proof. Step 4.1: Let us first show for any ω X, one has
⊂⊂
sup u < + .
n L∞(ω¯)
k k ∞
n
Suppose not, then there exits a sequence x n n N ω¯ such that limsup u n(x n) = + .
{ } ∈ ⊂ n | | ∞
13

Since ω¯ is compact, there exists x¯ ω¯ such that, up to a subsequence, x x¯ as n . Again
n
∈ → → ∞
up to a subsequence, we may assume that u (x ) + as n .
n n
→ ∞ → ∞
Since x¯ ω¯ X, there exists δ > 0 such that x¯ + δx X, where x := ( 1 , 1 , , 1 )
1 1
∈ ⊂⊂ − ∈ − √M √M ··· √M
is a unit vector in RM with each coordinate equal to 1 . For any x > x¯ + δx , there exists n N
1 0
√M − ∈
such that for any n > n , we have x > x . By Proposition 2.12, u are nondecreasing, and thus
0 n n
(5.4) u (x)dx m( x X x > x¯ + δx )u (x ) + .
n 1 n n
≥ { ∈ | − } → ∞
Z x X x>x¯+δx −1
{ ∈ | }
Here m( x X x > x¯ + δx ) denotes Lebesgue measure of the set x X x > x¯ + δx , which
1 1
{ ∈ | − } { ∈ | − }
is positive.
Denote ω := x X x > x¯ + δx . Therefore, we have
′ 1
{ ∈ | − }
u u u (x)dx + .
n W1,1 (ω′) n L1 (ω′) n
k k ≥ k k ≥ → ∞
ω′
Z
This implies
sup u = + .
n W1,1 (ω′)
k k ∞
n
On the other hand, since both X and the set x RM x > x¯ + δx are open and convex, we
1
∈ | −
have ω = X x RM x > x¯ + δx is also open and convex. Therefore, by assumption, we have
′ 1
∩ { ∈ | − } (cid:8) (cid:9)
sup u < + .
n W1,1 (ω′)
k k ∞
n
This is a contradiction. Thus for any ω X, we have sup u < + .
n L∞(ω¯)
⊂⊂ k k ∞
n
Step 4.2: For any fixed x X, there exists an open set ω X and δ > 0 such that x ω and
′ ′
∈ ⊂⊂ ∈
ω + δB(0,1) X.
⊂⊂
From Step 4.1, we know sup u < + . There exists R > 0 such that for all n N,
n kL∞(ω+δB(0,1))
k ∞ ∈
n
we have
u (x) R for all x ω + δB(0,1).
n
| | ≤ ∈
Since u are G-convex functions, by Proposition 2.13, there exists T = T(ω,δ,R) > 0, independent
n
of n, such that y T for any y ∂Gu n(x ′) and any n N. Thus, there exists a sequence y n n N
∂k Gk u≤ ∈ ∈ { } ∈
such that y (x ) and y T for all n N.
n n ′ n
∈ k k ≤ ∈
By compactness theorem for sequence y N, there exists y such that, up to a subsequence,
n n ′
{ } ∈
y y as n . Thus, we have
n ′
→ → ∞
y ∂Gu (x ) for all i N.
′ n i n ′
∈ ∪ ≥ ∈
It implies
y ∂Gu (x ) = Γ(x ).
′ i 1 n i n ′ ′
∈ ∩ ≥ ∪ ≥
(cid:3)
Therefore Γ(x ) = for all x X.
′ ′
6 ∅ ∈
Now for any fixed x X and any y Γ(x), by Cantor’s diagonal argument, there exists y
n l N
∈ ∈ { l} ∈
such that
G
y ∂ u (x) and lim y = y.
n n n
l ∈ l l l
→∞
For any l N, by definition of G-subdifferentiability, one has
∈
u (x ) G(x ,y ,H(x,y ,u (x))) for any x X.
n ′ ′ n n n ′
l ≥ l l l ∈
Take limit l at both sides, we get
→ ∞
u (x ) G(x ,y,H(x,y,u (x))) for any x X.
∗ ′ ′ ∗ ′
≥ ∈
Here we use the fact that both functions G and H are continuous by Assumption 1 and Proposition
2.3. Then by definition of G-subdifferentiability, the above inequality implies y ∂Gu (x).
∗
∈
14

So ∂Gu (x) = for all x X, which means u is G-subdifferentiable everywhere. By Lemma 2.6,
∗ ∗
6 ∅ ∈
(cid:3)
u is G-convex.
∗
Proof of the existence theorem. Step 1: For any G-convex u, define a point-to-set mapping on X as
Φ : x argmin π(x, ,H(x, ,u(x))) .
u ∂Gu(x)
7−→ {− · · }
For each x X, since u is G-convex, ∂Gu(x) = . By definition, ∂Gu(x) is a closed set. Moreover,
∈ 6 ∅
by Proposition 2.13 it is compact. Since both π and H are continuous, π(x, ,H(x, ,u(x))) is also
− − · ·
continuous and has minimum on ∂Gu(x). That is, Φ (x) = . Again, since π(x, ,H(x, ,u(x))) is
u
6 ∅ − · ·
continuous and ∂Gu(x) is compact, Φ (x) is also a compact set.
u
By Proposition 2.13, for any compact set ω X, ∂Gu(x) is bounded. Besides, it is compact.
x ω
⊂ ∪ ∈
Φ (x) is nonempty and compact for all x ω, and (x,y) y Φ (x) is a Borel set. By the
u x ω u
∈ ∪ ∈ { | ∈ }
measurable selection theorem (cf. [8, Theorem 1.2, Chapter VIII]), there exists a measurable mapping
y : ω Y such that for almost all x, y(x) Φ u(x). Let ω n n N denote a sequence of compact sets
→ ∈ { } ∈
such that ω ω ... ω ... X with ω = X. On each ω , there exists a measurable
1 2 n n n n
⊂ ⊂ ⊂ ⊂ ⊂ ∪
selection map yn : ω Y . Define y¯ : X Y such that y¯ = y1 on ω and y¯ = yn on ω ω for
n 1 n n 1
→ → \ −
n 2. Then y¯ is a measurable selection of Φ , i.e., y¯ is measurable and y¯(x) Φ (x) for almost every
u u
≥ ∈
x.
Let (u n,y n) n N be a maximizing sequence of (P), where maps u n : X R and y n : X cl(Y )
{ } ∈ → →
for all n N. Without loss of generality, we may assume that for all n N, y ( ) is measurable
n
∈ ∈ ·
and y n(x) Φ (x) for each x X. Starting from (u n,y n) N, we would find a value-product pair
u n
∈ n ∈ { } ∈
(u ,y ) satisfying all the constraints in (2.6), and show that it is actually a maximizer.
∗ ∗
Step 2: From Assumption 4, there exist α 1, a ,a > 0, and b R such that for each x X
1 2
≥ ∈ ∈
and n N,
∈
α
a y (x) π(x,y (x),H(x,y (x),u (x))) a u (x) + b
1 n α n n n 2 n
k k ≤ − −
π(x,y (x),H(x,y (x),u (x))) a u (x) + b.
n n n 2
≤ − −
∅
Here the second inequality comes from u n u . Together with Assumption 8, this implies y n n N
is bounded in Lα (X). ≥ ∅ { } ∈
By the participation constraint and Assumption 4, we know
1
u (x) u (x) = G(x,y (x),H(x,y (x),u (x))) (b π(x,y (x),H(x,y (x),u (x)))).
n n n n n n n
≤ ≤ a −
∅ 2
Together with Assumption 8, we know u n n N is bounded in L1(X).
{ } ∈
By G-subdifferentiability, Du (x) = D G(x,y (x),H(x,y (x),u (x))). By Assumption 6, we have
n x n n n
β α
Du c y + d c(N + y ) + d.
n 1 n β n α
k k ≤ k k ≤ k k
The last inequality holds because β (0,α]. Because X is bounded and y n n N is bounded in Lα (X),
we know Du n n N is bounded in L∈ 1(X). { } ∈
{ } ∈
Since both u n n N and Du n n N are bounded in L1(X), one has u n n N is bounded in W1,1(X).
{ } ∈ { } ∈ { } ∈
By Proposition 3.3, there exists a G-convex function u ∗ on X such that, up to a subsequence, u n n N
converges to u ∗ in L1 and uniformly on compact subset of X, and Du n n N converges to Du{ ∗ al} mo∈ st
{ } ∈
everywhere.
Step 3: Denote y (x) as a measurable selection of Φ . Let us show (u ,y ) is a maximizer of the
∗ u∗ ∗ ∗
principal’s program (P).
Step 3.1: By Assumption 4, for all x, y (x) and u (x), one has
n n
π(x,y (x),H(x,y (x),u (x)))
n n n
−
15

a G(x,y (x),H(x,y (x),u (x))) b
2 n n n
≥ −
= a u (x) b
2 n
−
a u (x) b.
2
≥ −
∅
By Assumption 8, u is measurable, thus one can apply Fatou’s lemma and get
∅
˜ ˜
supΠ(u,y) = limsupΠ(u ,y )
n n
n
= liminf π(x,y (x),H(x,y (x),u (x))) dx
(5.5) n n n
− n −
X
Z
liminf π(x,y (x),H(x,y (x),u (x))) dx.
n n n
≤ − n −
X
Z
Define
γ(x) := liminf π(x,y (x),H(x,y (x),u (x))).
n n n
n −
For each x X, by extracting a subsequence of y N, which is denoted as y N, we assume
n n nx l
∈ { } ∈ { l } ∈
γ(x) = lim π(x,y (x),H(x,y (x),u (x))).
nx nx nx
l − l l l
→∞
Step 3.2: For any fixed x X, since u are G-convex functions and u is bounded
nx nx l N
∈ l { l } ∈
in L1(X), by similar arguments as in the Step 4.1 of the proof of Proposition 3.3, u is also
nx l N
{ l } ∈
bounded in L (X). Then by Proposition 2.13, y is also bounded in L (X). Thus there exists
∞loc nx l N ∞loc
{ l } ∈
a subsequence of y (x) , again denoted as y (x) , that converges. Denote y˜ a mapping on
nx l N nx l N
{ l } ∈ { l } ∈
X such that y (x) y˜(x) as l for all x X.
nx
l → → ∞ ∈
Since π and H are continuous, we have
γ(x) = π(x,y˜(x),H(x,y˜(x),u (x))).
∗
−
For each fixed x X and any l N, since u are G-convex and y (x) ∂Gu (x), we have
nx nx nx
∈ ∈ l l ∈ l
u (x ) G(x ,y (x),H(x,y (x),u (x))) for any x X.
nx ′ ′ nx nx nx ′
l ≥ l l l ∈
Take limit l at both sides, we get
→ ∞
u (x ) G(x ,y˜(x),H(x,y˜(x),u (x))) for any x X.
∗ ′ ′ ∗ ′
≥ ∈
By definition of G-subdifferentiability, we have y˜(x) ∂Gu (x).
∗
∈
Step 3.3: By definition of y , one has
∗
π(x,y (x),H(x,y (x),u (x))) π(x,y˜(x),H(x,y˜(x),u (x))) = γ(x).
∗ ∗ ∗ ∗
− ≤ −
So, together with (5.5), we know
˜ ˜
(5.6) supΠ(u,y) γ(x) dx π(x,y (x),H(x,y (x),u (x))) dx = Π(u ,y ).
∗ ∗ ∗ ∗ ∗
≤ − ≤ − −
X X
Z Z
Since u n n N converges to u ∗, and u n(x) u (x) for all n N and x X, we have u ∗(x) u (x)
for all x{ X} .∈ In addition, because u is G-≥ conv∅ ex and y (x)∈ ∂Gu (x∈ ), we know (u ,y ) ≥ satis∅ fies
∗ ∗ ∗ ∗ ∗
∈ ∈
all the constraints in (2.6). Together with (5.6), we proved (u ,y ) is a solution of the principal’s
∗ ∗
(cid:3)
program.
16

References
[1] M. Armstrong, Multiproduct nonlinear pricing, Econometrica, 64 (1996) 51–75.
[2] E.J. Balder, An extension of duality-stability relations to non-convex optimization problems,
SIAM J. Control Optim., 15 (1977) 329-343.
[3] D.P. Baron, R.B. Myerson, Regulating a monopolist with unknown costs, Econometrica 50
(1982) 911–930.
[4] S. Basov, Multidimensional screening, Springer-Verlag, Berlin, 2005.
[5] G. Carlier, A general existence result for the principal–agent problem with adverse selection,
J. Math. Econom. 35 (2001) 129–150.
[6] G. Carlier, T. Lachand-Robert, Regularity of solutions for some variational problems subject
to convexity constraint, Comm. Pure Appl. Math. 54 (2001) 583–594.
[7] S. Dolecki, S. Kurcyusz, On Φ-convexity in extremal problems, SIAM J. Control Optim. 16
(1978) 277-300.
[8] I. Ekeland, R. Temam, Analyse convexe et probl´emes variationnels, Dunod (Libraire), Paris,
1976.
[9] K.-H. Elster, R. Nehse, Zur theorie der polarfunktionale, Math. Operationsforsch. Stat. 5
(1974) 3-21.
[10] L. C. Evans, Partial differential equations, American Mathematical Society, Providence,
Rhode Island, 1998.
[11] A. Figalli, Y.-H. Kim, R.J. McCann, When is multidimensional screening a convex program?
J. Econom. Theory 146 (2011) 454-478.
[12] W. Gangbo, R.J. McCann, The geometry of optimal transportation, Acta Math. 177 (1996)
113–161.
[13] S.S. Kutateladze, A.M. Rubinov, Minkowski duality and its applications, Russian Math.
Surveys 27 (1972) 137-192.
[14] J.E. Mart´ınez-Legaz, Generalized convex duality and its economic applications, in: Handbook
of generalized convexity and generalized monotonicity, Springer, New York, 2005, pp. 237–292.
[15] E. Maskin, J. Riley, Monopoly with incomplete information, The RAND Journal of Econom-
ics 15 (1984) 171-196.
[16] R.P. McAfee, J. McMillan, Multidimensional incentive compatibility and mechanism design,
J. Econom. Theory 46 (1988) 335–354.
[17] R.J. McCann, K.S. Zhang, On concavity of the monopolist’s problem facing consumers with
nonlinear price preferences, To appear in Comm. Pure and Applied Math.
[18] J.A. Mirrlees, An exploration in the theory of optimum income taxation, Rev. Econom. Stud.
38 (1971) 175–208.
[19] P.K. Monteiro, F.H. Page Jr., Optimal selling mechanisms for multiproduct monopolists:
incentive compatibility in the presence of budget constraints, J. Math. Econom. 30 (1998)
473–502.
[20] M. Mussa, S. Rosen, Monopoly product and quality, J. Econom. Theory 18 (1978) 301–317.
[21] R.B. Myerson, Optimal auction design, Mathematics of Operations Research 6 (1981) 58-73.
[22] G. N¨oldeke, L. Samuelson, The implementation duality, Econometrica 86(4) (2018)
1283–1324.
[23] J.-C. Rochet, A necessary and sufficient condition for rationalizability in a quasi-linear con-
text, J. Math. Econom. 16 (1987) 191–200.
[24] J.-C. Rochet, P. Chon´e, Ironing sweeping and multidimensional screening, Econometrica 66
(1998) 783–826.
[25] J.-C. Rochet, L.A. Stole, The economics of multidimensional screening, in: M. Dewatripont,
L.P. Hansen, S.J. Turnovsky (Eds.), Advances in Economics and Econometrics, Cambridge
University Press, Cambridge, 2003, pp. 150-197.
[26] A.M. Rubinov, Abstract convexity: Examples and applications, Optimization 47 (2000) 1–33.
17

[27] I. Singer, Abstract convex analysis, Wiley-Interscience, New York, 1997.
[28] M. Spence, Competitive and optimal responses to signals: An analysis of efficiency and
distribution, J. Econom. Theory 7 (1974) 296–332.
[29] M. Spence, Multi-product quantity-dependent prices and profitability constraints, Rev.
Econom. Stud. 47 (1980) 821–841.
[30] N. S. Trudinger, On the local theory of prescribed Jacobian equations, Discrete Contin. Dyn.
Syst. 34 (2014) 1663-1681.
[31] R. Wilson, Nonlinear pricing, Oxford University Press, Oxford, 1993.
[32] K.S. Zhang, Existence, uniqueness, concavity and geometry of the monopolist’s problem facing
consumers with nonlinear price preferences, Ph.D. Thesis, University of Toronto, 2018.
18